<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=vi><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer - Kaizen - tốt hơn mỗi ngày</title><meta name=author content="Kaizen Teams"><meta name=description content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta name=keywords content='ai generated post'><meta itemprop=name content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta itemprop=description content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta itemprop=datePublished content="2025-12-10T14:17:23+07:00"><meta itemprop=dateModified content="2025-12-11T16:05:24+07:00"><meta itemprop=wordCount content="5362"><meta itemprop=keywords content="Ai Generated Post"><meta property="og:url" content="https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/"><meta property="og:site_name" content="Kaizen - tốt hơn mỗi ngày"><meta property="og:title" content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta property="og:description" content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta property="og:locale" content="vi"><meta property="og:type" content="article"><meta property="article:section" content="bai-viet"><meta property="article:published_time" content="2025-12-10T14:17:23+07:00"><meta property="article:modified_time" content="2025-12-11T16:05:24+07:00"><meta property="article:tag" content="Ai Generated Post"><meta name=twitter:card content="summary"><meta name=twitter:title content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta name=twitter:description content="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><meta name=application-name content="Kaizen - tốt hơn mỗi ngày"><meta name=apple-mobile-web-app-title content="Kaizen - tốt hơn mỗi ngày"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#2d89ef"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#FF7359><link rel=manifest href=/site.webmanifest><link rel=canonical type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer - Kaizen - tốt hơn mỗi ngày"><link rel=prev type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><link rel=next type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Awk, Sed \u0026 Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer","inLanguage":"vi","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/regex-awk-sed\/"},"image":[{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}],"genre":"posts","keywords":"ai generated post","wordcount":5362,"url":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/regex-awk-sed\/","datePublished":"2025-12-10T14:17:23+07:00","dateModified":"2025-12-11T16:05:24+07:00","publisher":{"@type":"Organization","name":"Kaizen","logo":{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}},"author":{"@type":"Person","name":"Kaizen Teams"},"description":"Awk, Sed \u0026 Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"}</script><script src=/js/head/color-scheme.min.js></script></head><body data-instant-intensity=viewport data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=32 width=32><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class="menu-item has-children"><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=26 width=26><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Huỷ</a></li><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Bộ sưu tập"><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title="Bộ sưu tập">Linux Cli</span>
<span class=collection-count>11</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><span class=active title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</span></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu">Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu">Linux Package Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/selinux/ title="Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc">Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/file-and-folder/ title="Find, Ln, Lsof, Tar, Chmod - Hướng Dẫn Chuyên Sâu">Find, Ln, Lsof, Tar, Chmod - Hướng Dẫn Chuyên Sâu</a></li></ul><div class=collection-nav-simple><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ class=collection-nav-item rel=prev title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>5/11</span><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ class=collection-nav-item rel=next title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li></ul></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://vanvuvuong.github.io title="Tác giả" target=_blank rel="external nofollow noopener noreferrer author" class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Kaizen Teams</a></span><span class=post-included-in>&nbsp;trong <a href=/collections/linux-cli/ class=post-collection title="Bộ sưu tập - Linux Cli"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Linux Cli</a></span></div><div class=post-meta-line><span title="đăng ngày 2025-12-10 14:17:23"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-10>2025-12-10</time></span>&nbsp;<span title="Cập nhật ngày 2025-12-11 16:05:24"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-11>2025-12-11</time></span>&nbsp;<span title="5362 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>Khoảng 5400 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>26 phút</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Nội dung</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#phần-1-regex-trong-linux---lịch-sử-và-các-biến-thể>PHẦN 1: REGEX TRONG LINUX - LỊCH SỬ VÀ CÁC BIẾN THỂ</a><ul><li><a href=#11-tại-sao-regex-linux-lạ-so-với-regex-hiện-đại>1.1 Tại sao regex Linux &ldquo;lạ&rdquo; so với regex hiện đại?</a></li><li><a href=#12-bảng-so-sánh-regex-bre-vs-ere-vs-pcre>1.2 BẢNG SO SÁNH REGEX: BRE vs ERE vs PCRE</a></li><li><a href=#13-ví-dụ-thực-tế-cùng-một-việc-khác-cú-pháp>1.3 Ví dụ thực tế: Cùng một việc, khác cú pháp</a></li><li><a href=#14-lớp-ký-tự-posix-hoạt-động-trong-cả-bre-và-ere>1.4 Lớp Ký Tự POSIX (hoạt động trong cả BRE và ERE)</a></li></ul></li><li><a href=#phần-2-awk-chuyên-sâu>PHẦN 2: AWK CHUYÊN SÂU</a><ul><li><a href=#21-mô-hình-thực-thi---hiểu-để-tối-ưu>2.1 Mô Hình Thực Thi - Hiểu để tối ưu</a></li><li><a href=#22-biến-có-sẵn---cái-hay-của-awk>2.2 Biến Có Sẵn - Cái hay của awk</a></li><li><a href=#23-các-loại-mẫu---khi-nào-dùng-cái-nào>2.3 Các Loại Mẫu - Khi nào dùng cái nào</a></li><li><a href=#24-mảng-kết-hợp---sức-mạnh-thực-sự-của-awk>2.4 Mảng Kết Hợp - Sức mạnh thực sự của awk</a></li><li><a href=#25-hàm-có-sẵn>2.5 Hàm Có Sẵn</a></li><li><a href=#26-luồng-điều-khiển>2.6 Luồng Điều Khiển</a></li><li><a href=#27-hàm-tự-định-nghĩa>2.7 Hàm Tự Định Nghĩa</a></li><li><a href=#28-printf---xuất-có-định-dạng>2.8 Printf - Xuất Có Định Dạng</a></li></ul></li><li><a href=#phần-3-sed-chuyên-sâu>PHẦN 3: SED CHUYÊN SÂU</a><ul><li><a href=#31-mô-hình-thực-thi>3.1 Mô Hình Thực Thi</a></li><li><a href=#32-các-loại-địa-chỉ---chỉ-định-dòng-để-xử-lý>3.2 Các Loại Địa Chỉ - Chỉ định dòng để xử lý</a></li><li><a href=#33-tham-khảo-lệnh>3.3 Tham Khảo Lệnh</a></li><li><a href=#34-nhiều-lệnh>3.4 Nhiều Lệnh</a></li><li><a href=#35-không-gian-giữ---thao-tác-bộ-đệm-nâng-cao>3.5 Không Gian Giữ - Thao Tác Bộ Đệm Nâng Cao</a></li><li><a href=#36-nhánh-và-nhãn-nâng-cao>3.6 Nhánh và Nhãn (Nâng Cao)</a></li><li><a href=#37-chỉnh-sửa-tại-chỗ>3.7 Chỉnh Sửa Tại Chỗ</a></li></ul></li><li><a href=#phần-4-phân-tích-độ-phức-tạp>PHẦN 4: PHÂN TÍCH ĐỘ PHỨC TẠP</a><ul><li><a href=#41-big-o-của-các-thao-tác>4.1 Big-O của các thao tác</a></li><li><a href=#42-cơ-chế-regex-bên-trong---khi-nào-nó-chậm>4.2 Cơ Chế Regex Bên Trong - Khi nào nó chậm</a></li><li><a href=#43-sử-dụng-bộ-nhớ>4.3 Sử Dụng Bộ Nhớ</a></li></ul></li><li><a href=#phần-5-ví-dụ-thực-tế>PHẦN 5: VÍ DỤ THỰC TẾ</a><ul><li><a href=#51-phân-tích-log>5.1 Phân Tích Log</a></li><li><a href=#52-thao-tác-file-cấu-hình>5.2 Thao Tác File Cấu Hình</a></li><li><a href=#53-chuyển-đổi-dữ-liệu>5.3 Chuyển Đổi Dữ Liệu</a></li><li><a href=#54-quản-trị-hệ-thống>5.4 Quản Trị Hệ Thống</a></li><li><a href=#55-đường-ống-xử-lý-văn-bản>5.5 Đường Ống Xử Lý Văn Bản</a></li></ul></li><li><a href=#phần-6-sai-lầm-và-thực-hành-tốt>PHẦN 6: SAI LẦM VÀ THỰC HÀNH TỐT</a><ul><li><a href=#61-những-sai-lầm-cần-tránh>6.1 Những Sai Lầm Cần Tránh</a></li><li><a href=#62-mẹo-hiệu-năng>6.2 Mẹo Hiệu Năng</a></li><li><a href=#63-cân-nhắc-tương-thích>6.3 Cân Nhắc Tương Thích</a></li></ul></li><li><a href=#phần-7-thẻ-tham-khảo-nhanh>PHẦN 7: THẺ THAM KHẢO NHANH</a><ul><li><a href=#71-một-dòng-awk-hay-dùng>7.1 Một Dòng AWK Hay Dùng</a></li><li><a href=#72-một-dòng-sed-hay-dùng>7.2 Một Dòng SED Hay Dùng</a></li></ul></li><li><a href=#kết-luận>KẾT LUẬN</a></li></ul></li></ul></nav></div></div><div class=content id=content><p><strong>Mục tiêu</strong>: Hiểu bản chất, không phải chỉ cú pháp. Sau bài này mày sẽ biết khi nào dùng cái gì, tại sao nó nhanh/chậm, và những lỗi sai cần tránh.</p><h2 class=heading-element id=phần-1-regex-trong-linux---lịch-sử-và-các-biến-thể><span>PHẦN 1: REGEX TRONG LINUX - LỊCH SỬ VÀ CÁC BIẾN THỂ</span>
<a href=#ph%e1%ba%a7n-1-regex-trong-linux---l%e1%bb%8bch-s%e1%bb%ad-v%c3%a0-c%c3%a1c-bi%e1%ba%bfn-th%e1%bb%83 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=11-tại-sao-regex-linux-lạ-so-với-regex-hiện-đại><span>1.1 Tại sao regex Linux &ldquo;lạ&rdquo; so với regex hiện đại?</span>
<a href=#11-t%e1%ba%a1i-sao-regex-linux-l%e1%ba%a1-so-v%e1%bb%9bi-regex-hi%e1%bb%87n-%c4%91%e1%ba%a1i class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>Lịch sử ngắn gọn:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>1968: Ken Thompson cài đặt regex trong trình soạn thảo ed (Bell Labs)
</span></span><span class=line><span class=cl>1973: grep ra đời (g/re/p = global/regular expression/print)
</span></span><span class=line><span class=cl>1977: awk ra đời (Aho, Weinberger, Kernighan - tên 3 tác giả)
</span></span><span class=line><span class=cl>1979: egrep ra đời với Biểu Thức Chính Quy Mở Rộng (ERE)
</span></span><span class=line><span class=cl>1987: Perl ra đời, đưa regex lên tầm cao mới (PCRE)
</span></span><span class=line><span class=cl>1997: Thư viện PCRE ra đời, trở thành &#34;regex hiện đại&#34;</span></span></code></pre></div><p><strong>Hệ quả</strong>: Các công cụ Linux được viết trước khi &ldquo;regex hiện đại&rdquo; tồn tại. Chúng dùng 2 tiêu chuẩn cũ:</p><table><thead><tr><th>Loại</th><th>Công cụ</th><th>Đặc điểm</th></tr></thead><tbody><tr><td><strong>BRE</strong> (Cơ bản)</td><td>grep, sed</td><td>Ký tự đặc biệt cần thoát: <code>\+</code>, <code>\?</code>, <code>|</code>, <code>\(\)</code></td></tr><tr><td><strong>ERE</strong> (Mở rộng)</td><td>egrep, awk, grep -E</td><td>Ký tự đặc biệt KHÔNG cần thoát: <code>+</code>, <code>?</code>, <code>|</code>, <code>()</code></td></tr><tr><td><strong>PCRE</strong> (Hiện đại)</td><td>grep -P, perl</td><td>Có nhìn trước, nhìn sau, <code>\d</code>, <code>\w</code>, không tham lam <code>*?</code></td></tr></tbody></table><h3 class=heading-element id=12-bảng-so-sánh-regex-bre-vs-ere-vs-pcre><span>1.2 BẢNG SO SÁNH REGEX: BRE vs ERE vs PCRE</span>
<a href=#12-b%e1%ba%a3ng-so-s%c3%a1nh-regex-bre-vs-ere-vs-pcre class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────┬────────────┬────────────┬────────────┐
</span></span><span class=line><span class=cl>│ Tính năng               │ BRE        │ ERE        │ PCRE       │
</span></span><span class=line><span class=cl>│                         │ (sed/grep) │ (awk/egrep)│ (grep -P)  │
</span></span><span class=line><span class=cl>├─────────────────────────┼────────────┼────────────┼────────────┤
</span></span><span class=line><span class=cl>│ Khớp chính xác          │ abc        │ abc        │ abc        │
</span></span><span class=line><span class=cl>│ Ký tự bất kỳ            │ .          │ .          │ .          │
</span></span><span class=line><span class=cl>│ Đầu dòng                │ ^          │ ^          │ ^          │
</span></span><span class=line><span class=cl>│ Cuối dòng               │ $          │ $          │ $          │
</span></span><span class=line><span class=cl>│ Không hoặc nhiều lần    │ *          │ *          │ *          │
</span></span><span class=line><span class=cl>│ Một hoặc nhiều lần      │ \+         │ +          │ +          │
</span></span><span class=line><span class=cl>│ Không hoặc một lần      │ \?         │ ?          │ ?          │
</span></span><span class=line><span class=cl>│ Hoặc (OR)               │ \|         │ |          │ |          │
</span></span><span class=line><span class=cl>│ Nhóm                    │ \(\)       │ ()         │ ()         │
</span></span><span class=line><span class=cl>│ Tham chiếu ngược        │ \1 \2      │ \1 \2      │ \1 \2 $1   │
</span></span><span class=line><span class=cl>│ Lớp ký tự               │ [abc]      │ [abc]      │ [abc]      │
</span></span><span class=line><span class=cl>│ Lớp phủ định            │ [^abc]     │ [^abc]     │ [^abc]     │
</span></span><span class=line><span class=cl>│ Phạm vi                 │ [a-z]      │ [a-z]      │ [a-z]      │
</span></span><span class=line><span class=cl>│ Ranh giới từ            │ \b (GNU)   │ \b (GNU)   │ \b         │
</span></span><span class=line><span class=cl>│ Viết tắt số             │ [0-9]      │ [0-9]      │ \d         │
</span></span><span class=line><span class=cl>│ Viết tắt ký tự từ       │ [a-zA-Z_]  │ [a-zA-Z_]  │ \w         │
</span></span><span class=line><span class=cl>│ Viết tắt khoảng trắng   │ [ \t]      │ [ \t]      │ \s         │
</span></span><span class=line><span class=cl>│ Không tham lam          │ Không có   │ Không có   │ *? +? ??   │
</span></span><span class=line><span class=cl>│ Nhìn trước              │ Không có   │ Không có   │ (?=) (?!)  │
</span></span><span class=line><span class=cl>│ Nhìn sau                │ Không có   │ Không có   │ (?&lt;=)(?&lt;!) │
</span></span><span class=line><span class=cl>│ Nhóm đặt tên            │ Không có   │ Không có   │ (?P&lt;tên&gt;)  │
</span></span><span class=line><span class=cl>│ Lượng từ {n,m}          │ \{n,m\}    │ {n,m}      │ {n,m}      │
</span></span><span class=line><span class=cl>└─────────────────────────┴────────────┴────────────┴────────────┘</span></span></code></pre></div><h3 class=heading-element id=13-ví-dụ-thực-tế-cùng-một-việc-khác-cú-pháp><span>1.3 Ví dụ thực tế: Cùng một việc, khác cú pháp</span>
<a href=#13-v%c3%ad-d%e1%bb%a5-th%e1%bb%b1c-t%e1%ba%bf-c%c3%b9ng-m%e1%bb%99t-vi%e1%bb%87c-kh%c3%a1c-c%c3%ba-ph%c3%a1p class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>Bài toán</strong>: Tìm dòng có địa chỉ IP</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># BRE (grep, sed) - phải thoát ký tự đặc biệt</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}\.[0-9]\{1,3\}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ERE (egrep, awk) - không cần thoát</span>
</span></span><span class=line><span class=cl>egrep <span class=s1>&#39;[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}&#39;</span> file
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}/&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PCRE (grep -P) - có viết tắt</span>
</span></span><span class=line><span class=cl>grep -P <span class=s1>&#39;\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}&#39;</span> file</span></span></code></pre></div><p><strong>Bài toán</strong>: Tìm &ldquo;error&rdquo; hoặc &ldquo;warning&rdquo; (không phân biệt hoa thường)</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># BRE</span>
</span></span><span class=line><span class=cl>grep -i <span class=s1>&#39;error\|warning&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ERE</span>
</span></span><span class=line><span class=cl>egrep -i <span class=s1>&#39;error|warning&#39;</span> file
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;tolower($0) ~ /error|warning/&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># PCRE</span>
</span></span><span class=line><span class=cl>grep -Pi <span class=s1>&#39;error|warning&#39;</span> file</span></span></code></pre></div><h3 class=heading-element id=14-lớp-ký-tự-posix-hoạt-động-trong-cả-bre-và-ere><span>1.4 Lớp Ký Tự POSIX (hoạt động trong cả BRE và ERE)</span>
<a href=#14-l%e1%bb%9bp-k%c3%bd-t%e1%bb%b1-posix-ho%e1%ba%a1t-%c4%91%e1%bb%99ng-trong-c%e1%ba%a3-bre-v%c3%a0-ere class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=o>[</span>:alnum:<span class=o>]</span>   <span class=c1># Chữ và số [a-zA-Z0-9]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:alpha:<span class=o>]</span>   <span class=c1># Chữ cái [a-zA-Z]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:digit:<span class=o>]</span>   <span class=c1># Chữ số [0-9]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:lower:<span class=o>]</span>   <span class=c1># Chữ thường [a-z]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:upper:<span class=o>]</span>   <span class=c1># Chữ hoa [A-Z]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:space:<span class=o>]</span>   <span class=c1># Khoảng trắng [ \t\n\r\f\v]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:blank:<span class=o>]</span>   <span class=c1># Dấu cách và tab [ \t]</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:punct:<span class=o>]</span>   <span class=c1># Dấu câu</span>
</span></span><span class=line><span class=cl><span class=o>[</span>:xdigit:<span class=o>]</span>  <span class=c1># Số hex [0-9A-Fa-f]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cách dùng - phải có ngoặc vuông kép</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;[[:digit:]]&#39;</span> file        <span class=c1># Khớp số bất kỳ</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;[[:alpha:]_]&#39;</span> file       <span class=c1># Khớp chữ hoặc gạch dưới</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;[^[:space:]]&#39;</span> file       <span class=c1># Khớp ký tự không phải khoảng trắng</span></span></span></code></pre></div><p><strong>Tại sao dùng lớp POSIX?</strong></p><ul><li>Nhận biết ngôn ngữ: <code>[[:alpha:]]</code> khớp cả ký tự có dấu trong tiếng Việt</li><li><code>[a-z]</code> chỉ khớp chữ thường ASCII</li></ul><hr><h2 class=heading-element id=phần-2-awk-chuyên-sâu><span>PHẦN 2: AWK CHUYÊN SÂU</span>
<a href=#ph%e1%ba%a7n-2-awk-chuy%c3%aan-s%c3%a2u class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=21-mô-hình-thực-thi---hiểu-để-tối-ưu><span>2.1 Mô Hình Thực Thi - Hiểu để tối ưu</span>
<a href=#21-m%c3%b4-h%c3%acnh-th%e1%bb%b1c-thi---hi%e1%bb%83u-%c4%91%e1%bb%83-t%e1%bb%91i-%c6%b0u class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>                    ┌─────────────────────────────────────┐
</span></span><span class=line><span class=cl>                    │         QUY TRÌNH THỰC THI AWK      │
</span></span><span class=line><span class=cl>                    └─────────────────────────────────────┘
</span></span><span class=line><span class=cl>                                    │
</span></span><span class=line><span class=cl>        ┌───────────────────────────┼───────────────────────────┐
</span></span><span class=line><span class=cl>        │                           │                           │
</span></span><span class=line><span class=cl>        ▼                           ▼                           ▼
</span></span><span class=line><span class=cl>┌───────────────┐          ┌───────────────┐          ┌───────────────┐
</span></span><span class=line><span class=cl>│    BEGIN      │          │  VÒNG LẶP     │          │     END       │
</span></span><span class=line><span class=cl>│   (1 lần)     │          │   CHÍNH       │          │   (1 lần)     │
</span></span><span class=line><span class=cl>│               │          │ (mỗi bản ghi) │          │               │
</span></span><span class=line><span class=cl>└───────────────┘          └───────────────┘          └───────────────┘
</span></span><span class=line><span class=cl>        │                           │                           │
</span></span><span class=line><span class=cl>        │                  ┌────────┴────────┐                  │
</span></span><span class=line><span class=cl>        │                  │                 │                  │
</span></span><span class=line><span class=cl>        │                  ▼                 ▼                  │
</span></span><span class=line><span class=cl>        │         ┌─────────────┐   ┌─────────────┐             │
</span></span><span class=line><span class=cl>        │         │ Tách thành  │   │   Khớp      │             │
</span></span><span class=line><span class=cl>        │         │  các trường │   │   mẫu       │             │
</span></span><span class=line><span class=cl>        │         │ $1,$2..$NF  │   │             │             │
</span></span><span class=line><span class=cl>        │         └─────────────┘   └─────────────┘             │
</span></span><span class=line><span class=cl>        │                  │                 │                  │
</span></span><span class=line><span class=cl>        │                  └────────┬────────┘                  │
</span></span><span class=line><span class=cl>        │                           │                           │
</span></span><span class=line><span class=cl>        │                           ▼                           │
</span></span><span class=line><span class=cl>        │                  ┌─────────────┐                      │
</span></span><span class=line><span class=cl>        │                  │  Thực thi   │                      │
</span></span><span class=line><span class=cl>        │                  │  hành động  │                      │
</span></span><span class=line><span class=cl>        │                  └─────────────┘                      │
</span></span><span class=line><span class=cl>        │                           │                           │
</span></span><span class=line><span class=cl>        ▼                           ▼                           ▼
</span></span><span class=line><span class=cl>   Khởi tạo               Đọc bản ghi tiếp              Xuất kết quả
</span></span><span class=line><span class=cl>   biến                                                 &amp; dọn dẹp</span></span></code></pre></div><h3 class=heading-element id=22-biến-có-sẵn---cái-hay-của-awk><span>2.2 Biến Có Sẵn - Cái hay của awk</span>
<a href=#22-bi%e1%ba%bfn-c%c3%b3-s%e1%ba%b5n---c%c3%a1i-hay-c%e1%bb%a7a-awk class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>Biến Bản Ghi & Trường:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nv>$0</span>          <span class=c1># Toàn bộ bản ghi (dòng) hiện tại</span>
</span></span><span class=line><span class=cl><span class=nv>$1</span>, <span class=nv>$2</span>...   <span class=c1># Trường thứ 1, 2...</span>
</span></span><span class=line><span class=cl><span class=nv>$NF</span>         <span class=c1># Trường CUỐI CÙNG (không phải số trường!)</span>
</span></span><span class=line><span class=cl><span class=k>$(</span>NF-1<span class=k>)</span>     <span class=c1># Trường áp chót</span>
</span></span><span class=line><span class=cl>NF          <span class=c1># Số lượng trường trong bản ghi hiện tại</span>
</span></span><span class=line><span class=cl>NR          <span class=c1># Số thứ tự bản ghi (số dòng tổng cộng)</span>
</span></span><span class=line><span class=cl>FNR         <span class=c1># Số thứ tự bản ghi trong FILE hiện tại</span></span></span></code></pre></div><p><strong>Biến Phân Cách:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>FS          <span class=c1># Ký tự phân cách trường (đầu vào) - mặc định: khoảng trắng</span>
</span></span><span class=line><span class=cl>RS          <span class=c1># Ký tự phân cách bản ghi (đầu vào) - mặc định: xuống dòng</span>
</span></span><span class=line><span class=cl>OFS         <span class=c1># Ký tự phân cách trường đầu ra - mặc định: dấu cách</span>
</span></span><span class=line><span class=cl>ORS         <span class=c1># Ký tự phân cách bản ghi đầu ra - mặc định: xuống dòng</span></span></span></code></pre></div><p><strong>Ví dụ thực tế:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># File: access.log</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.1 - - [10/Dec/2024:10:15:32] &#34;GET /api/users&#34; 200 1234</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lấy IP và mã trạng thái</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $1, $9}&#39;</span> access.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi ký tự phân cách đầu ra thành tab</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;BEGIN{OFS=&#34;\t&#34;} {print $1, $9}&#39;</span> access.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xử lý file CSV (phân cách bằng dấu phẩy)</span>
</span></span><span class=line><span class=cl>awk -F<span class=s1>&#39;,&#39;</span> <span class=s1>&#39;{print $2}&#39;</span> data.csv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xử lý file có ký tự phân cách nhiều ký tự</span>
</span></span><span class=line><span class=cl>awk -F<span class=s1>&#39;::&#39;</span> <span class=s1>&#39;{print $1}&#39;</span> /etc/passwd    <span class=c1># KHÔNG hoạt động như mong đợi</span>
</span></span><span class=line><span class=cl>awk -F<span class=s1>&#39;:&#39;</span> <span class=s1>&#39;{print $1}&#39;</span> /etc/passwd     <span class=c1># Đúng</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># FS có thể là regex!</span>
</span></span><span class=line><span class=cl>awk -F<span class=s1>&#39;[,;:\t]+&#39;</span> <span class=s1>&#39;{print $1, $2}&#39;</span> file_hon_tap.txt</span></span></code></pre></div><h3 class=heading-element id=23-các-loại-mẫu---khi-nào-dùng-cái-nào><span>2.3 Các Loại Mẫu - Khi nào dùng cái nào</span>
<a href=#23-c%c3%a1c-lo%e1%ba%a1i-m%e1%ba%abu---khi-n%c3%a0o-d%c3%b9ng-c%c3%a1i-n%c3%a0o class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Mẫu regex - khớp bất kỳ đâu trong dòng</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/ERROR/&#39;</span> file                    <span class=c1># Dòng chứa ERROR</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/^ERROR/&#39;</span> file                   <span class=c1># Dòng BẮT ĐẦU bằng ERROR</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/ERROR$/&#39;</span> file                   <span class=c1># Dòng KẾT THÚC bằng ERROR</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Mẫu biểu thức - biểu thức boolean</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$3 &gt; 100&#39;</span> file                   <span class=c1># Trường 3 &gt; 100</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;NF &gt; 5&#39;</span> file                     <span class=c1># Dòng có &gt; 5 trường</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;NR &gt; 10 &amp;&amp; NR &lt; 20&#39;</span> file         <span class=c1># Dòng 11-19</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;length($0) &gt; 80&#39;</span> file            <span class=c1># Dòng dài hơn 80 ký tự</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Regex cho trường cụ thể</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$1 ~ /^192\.168/&#39;</span> file           <span class=c1># Trường 1 khớp mẫu</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$NF !~ /\.jpg$/&#39;</span> file            <span class=c1># Trường cuối KHÔNG khớp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Mẫu kết hợp</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/START/,/END/&#39;</span> file              <span class=c1># Phạm vi: từ START đến END</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/ERROR/ &amp;&amp; /timeout/&#39;</span> file       <span class=c1># Cả hai mẫu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. Mẫu đặc biệt</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;BEGIN {print &#34;Tiêu đề&#34;}&#39;</span>         <span class=c1># Trước khi đọc đầu vào</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;END {print &#34;Tổng:&#34;, NR}&#39;</span>         <span class=c1># Sau khi đọc hết đầu vào</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;FNR==1&#39;</span> file1 file2              <span class=c1># Dòng đầu của MỖI file</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;NR==FNR&#39;</span> file1 file2             <span class=c1># Chỉ file đầu tiên</span></span></span></code></pre></div><h3 class=heading-element id=24-mảng-kết-hợp---sức-mạnh-thực-sự-của-awk><span>2.4 Mảng Kết Hợp - Sức mạnh thực sự của awk</span>
<a href=#24-m%e1%ba%a3ng-k%e1%ba%bft-h%e1%bb%a3p---s%e1%bb%a9c-m%e1%ba%a1nh-th%e1%bb%b1c-s%e1%bb%b1-c%e1%bb%a7a-awk class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>Khái niệm</strong>: Mảng trong awk là bảng băm (hash table), khóa có thể là bất kỳ chuỗi nào.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Mẫu đếm - Thời gian O(n), Bộ nhớ O(k) với k khóa duy nhất</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{count[$1]++} END {for (k in count) print k, count[k]}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Phân tích:</span>
</span></span><span class=line><span class=cl><span class=c1># count[$1]++     : Dùng trường 1 làm khóa, tăng giá trị lên 1</span>
</span></span><span class=line><span class=cl><span class=c1># for (k in count): Duyệt qua tất cả khóa</span>
</span></span><span class=line><span class=cl><span class=c1># print k, count[k]: In khóa và giá trị</span></span></span></code></pre></div><p><strong>Ví dụ 1: Đếm mã trạng thái HTTP từ log nginx</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Đầu vào: access.log</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.1 - - [ngày] &#34;GET /đường_dẫn&#34; 200 1234</span>
</span></span><span class=line><span class=cl><span class=c1># 192.168.1.2 - - [ngày] &#34;POST /api&#34; 500 567</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{status[$9]++} END {for (s in status) print s, status[s]}&#39;</span> access.log <span class=p>|</span> sort -k2 -rn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kết quả:</span>
</span></span><span class=line><span class=cl><span class=c1># 200 15234</span>
</span></span><span class=line><span class=cl><span class=c1># 304 2341</span>
</span></span><span class=line><span class=cl><span class=c1># 404 156</span>
</span></span><span class=line><span class=cl><span class=c1># 500 23</span></span></span></code></pre></div><p><strong>Ví dụ 2: Tổng số byte theo địa chỉ IP</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    ip = $1
</span></span></span><span class=line><span class=cl><span class=s1>    bytes = $10
</span></span></span><span class=line><span class=cl><span class=s1>    tong[ip] += bytes
</span></span></span><span class=line><span class=cl><span class=s1>    dem[ip]++
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>END {
</span></span></span><span class=line><span class=cl><span class=s1>    for (ip in tong)
</span></span></span><span class=line><span class=cl><span class=s1>        printf &#34;%s: %d yêu cầu, %d bytes, trung bình %.2f\n&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>               ip, dem[ip], tong[ip], tong[ip]/dem[ip]
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> access.log</span></span></code></pre></div><p><strong>Ví dụ 3: Tìm file trùng lặp theo checksum</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Đầu vào từ md5sum</span>
</span></span><span class=line><span class=cl>md5sum *.jpg <span class=p>|</span> awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    checksum = $1
</span></span></span><span class=line><span class=cl><span class=s1>    ten_file = $2
</span></span></span><span class=line><span class=cl><span class=s1>    dem[checksum]++
</span></span></span><span class=line><span class=cl><span class=s1>    files[checksum] = files[checksum] &#34; &#34; ten_file
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>END {
</span></span></span><span class=line><span class=cl><span class=s1>    for (c in dem) {
</span></span></span><span class=line><span class=cl><span class=s1>        if (dem[c] &gt; 1)
</span></span></span><span class=line><span class=cl><span class=s1>            print dem[c], c &#34;:&#34; files[c]
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> <span class=p>|</span> sort -rn</span></span></code></pre></div><p><strong>Ví dụ 4: Xử lý hai file - Thao tác JOIN</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># file1.txt: mã_người_dùng,tên</span>
</span></span><span class=line><span class=cl><span class=c1># 1,Alice</span>
</span></span><span class=line><span class=cl><span class=c1># 2,Bob</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># file2.txt: mã_người_dùng,số_tiền_đặt_hàng</span>
</span></span><span class=line><span class=cl><span class=c1># 1,100</span>
</span></span><span class=line><span class=cl><span class=c1># 1,200</span>
</span></span><span class=line><span class=cl><span class=c1># 2,150</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>awk -F<span class=s1>&#39;,&#39;</span> <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>    NR==FNR {                    # Chỉ đúng khi đọc file đầu
</span></span></span><span class=line><span class=cl><span class=s1>        ten[$1] = $2             # Nạp file1 vào mảng
</span></span></span><span class=line><span class=cl><span class=s1>        next                     # Chuyển sang bản ghi tiếp
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>    $1 in ten {                  # Khi đọc file2, kiểm tra khóa tồn tại
</span></span></span><span class=line><span class=cl><span class=s1>        print ten[$1], $2        # In dữ liệu đã nối
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> file1.txt file2.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kết quả:</span>
</span></span><span class=line><span class=cl><span class=c1># Alice 100</span>
</span></span><span class=line><span class=cl><span class=c1># Alice 200</span>
</span></span><span class=line><span class=cl><span class=c1># Bob 150</span></span></span></code></pre></div><p><strong>Giải thích mẫu <code>NR==FNR</code>:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>NR = Số thứ tự bản ghi tổng (qua tất cả file)
</span></span><span class=line><span class=cl>FNR = Số thứ tự bản ghi trong file hiện tại
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>File1: NR=1,FNR=1 → NR==FNR (đúng)
</span></span><span class=line><span class=cl>       NR=2,FNR=2 → NR==FNR (đúng)
</span></span><span class=line><span class=cl>File2: NR=3,FNR=1 → NR!=FNR (sai)
</span></span><span class=line><span class=cl>       NR=4,FNR=2 → NR!=FNR (sai)</span></span></code></pre></div><h3 class=heading-element id=25-hàm-có-sẵn><span>2.5 Hàm Có Sẵn</span>
<a href=#25-h%c3%a0m-c%c3%b3-s%e1%ba%b5n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>Hàm Chuỗi:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>length<span class=o>(</span>s<span class=o>)</span>              <span class=c1># Độ dài chuỗi</span>
</span></span><span class=line><span class=cl>substr<span class=o>(</span>s, bắt_đầu, độ_dài<span class=o>)</span>  <span class=c1># Chuỗi con (đánh số từ 1!)</span>
</span></span><span class=line><span class=cl>index<span class=o>(</span>s, mục_tiêu<span class=o>)</span>     <span class=c1># Vị trí của mục_tiêu trong s (0 nếu không tìm thấy)</span>
</span></span><span class=line><span class=cl>split<span class=o>(</span>s, mảng, phân_cách<span class=o>)</span>  <span class=c1># Tách chuỗi thành mảng</span>
</span></span><span class=line><span class=cl>gsub<span class=o>(</span>regex, thay_thế, s<span class=o>)</span>   <span class=c1># Thay thế toàn cục (sửa tại chỗ)</span>
</span></span><span class=line><span class=cl>sub<span class=o>(</span>regex, thay_thế, s<span class=o>)</span>    <span class=c1># Thay thế một lần</span>
</span></span><span class=line><span class=cl>tolower<span class=o>(</span>s<span class=o>)</span>             <span class=c1># Chuyển thành chữ thường</span>
</span></span><span class=line><span class=cl>toupper<span class=o>(</span>s<span class=o>)</span>             <span class=c1># Chuyển thành chữ hoa</span>
</span></span><span class=line><span class=cl>match<span class=o>(</span>s, regex<span class=o>)</span>        <span class=c1># Trả về vị trí khớp (0 nếu không khớp)</span>
</span></span><span class=line><span class=cl>sprintf<span class=o>(</span>định_dạng, ...<span class=o>)</span>   <span class=c1># Chuỗi có định dạng</span></span></span></code></pre></div><p><strong>Ví dụ thực tế:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Trích xuất tên miền từ email</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    email = $1
</span></span></span><span class=line><span class=cl><span class=s1>    vi_tri_at = index(email, &#34;@&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    ten_mien = substr(email, vi_tri_at + 1)
</span></span></span><span class=line><span class=cl><span class=s1>    print ten_mien
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> emails.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay thế nhiều mẫu</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    gsub(/http:/, &#34;https:&#34;, $0)
</span></span></span><span class=line><span class=cl><span class=s1>    gsub(/www\./, &#34;&#34;, $0)
</span></span></span><span class=line><span class=cl><span class=s1>    print
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> urls.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Phân tích timestamp trong log</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    # [10/Dec/2024:10:15:32 +0000]
</span></span></span><span class=line><span class=cl><span class=s1>    match($4, /\[([^:]+):([0-9:]+)/, mảng)
</span></span></span><span class=line><span class=cl><span class=s1>    ngày = mảng[1]
</span></span></span><span class=line><span class=cl><span class=s1>    giờ = mảng[2]
</span></span></span><span class=line><span class=cl><span class=s1>    print ngày, giờ
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> access.log</span></span></code></pre></div><p><strong>Hàm Toán Học:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>int<span class=o>(</span>x<span class=o>)</span>      <span class=c1># Cắt thành số nguyên</span>
</span></span><span class=line><span class=cl>sqrt<span class=o>(</span>x<span class=o>)</span>     <span class=c1># Căn bậc hai</span>
</span></span><span class=line><span class=cl>log<span class=o>(</span>x<span class=o>)</span>      <span class=c1># Logarit tự nhiên</span>
</span></span><span class=line><span class=cl>exp<span class=o>(</span>x<span class=o>)</span>      <span class=c1># e mũ x</span>
</span></span><span class=line><span class=cl>sin<span class=o>(</span>x<span class=o>)</span>, cos<span class=o>(</span>x<span class=o>)</span>, atan2<span class=o>(</span>y,x<span class=o>)</span>
</span></span><span class=line><span class=cl>rand<span class=o>()</span>      <span class=c1># Số ngẫu nhiên 0-1</span>
</span></span><span class=line><span class=cl>srand<span class=o>(</span>hạt<span class=o>)</span>  <span class=c1># Đặt hạt giống ngẫu nhiên</span></span></span></code></pre></div><h3 class=heading-element id=26-luồng-điều-khiển><span>2.6 Luồng Điều Khiển</span>
<a href=#26-lu%e1%bb%93ng-%c4%91i%e1%bb%81u-khi%e1%bb%83n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Nếu-không thì</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    if ($3 &gt; 100)
</span></span></span><span class=line><span class=cl><span class=s1>        print &#34;cao:&#34;, $0
</span></span></span><span class=line><span class=cl><span class=s1>    else if ($3 &gt; 50)
</span></span></span><span class=line><span class=cl><span class=s1>        print &#34;trung bình:&#34;, $0
</span></span></span><span class=line><span class=cl><span class=s1>    else
</span></span></span><span class=line><span class=cl><span class=s1>        print &#34;thấp:&#34;, $0
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Toán tử ba ngôi</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print ($3 &gt; 100) ? &#34;cao&#34; : &#34;thấp&#34;}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vòng lặp for</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    for (i = 1; i &lt;= NF; i++)
</span></span></span><span class=line><span class=cl><span class=s1>        print &#34;Trường&#34;, i, &#34;=&#34;, $i
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vòng lặp while</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    i = 1
</span></span></span><span class=line><span class=cl><span class=s1>    while (i &lt;= NF) {
</span></span></span><span class=line><span class=cl><span class=s1>        print $i
</span></span></span><span class=line><span class=cl><span class=s1>        i++
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># next - chuyển sang bản ghi tiếp</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/^#/ {next} {print}&#39;</span> file    <span class=c1># Bỏ qua dòng ghi chú</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># exit - dừng xử lý</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/ERROR/ {print; exit}&#39;</span> file  <span class=c1># In lỗi đầu tiên và dừng</span></span></span></code></pre></div><h3 class=heading-element id=27-hàm-tự-định-nghĩa><span>2.7 Hàm Tự Định Nghĩa</span>
<a href=#27-h%c3%a0m-t%e1%bb%b1-%c4%91%e1%bb%8bnh-ngh%c4%a9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>awk <span class=s1>&#39;
</span></span></span><span class=line><span class=cl><span class=s1>function max(a, b) {
</span></span></span><span class=line><span class=cl><span class=s1>    return (a &gt; b) ? a : b
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>function min(a, b) {
</span></span></span><span class=line><span class=cl><span class=s1>    return (a &lt; b) ? a : b
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>function trung_binh(mảng, n,    tổng, i) {    # tổng, i là biến cục bộ
</span></span></span><span class=line><span class=cl><span class=s1>    tổng = 0
</span></span></span><span class=line><span class=cl><span class=s1>    for (i = 1; i &lt;= n; i++)
</span></span></span><span class=line><span class=cl><span class=s1>        tổng += mảng[i]
</span></span></span><span class=line><span class=cl><span class=s1>    return tổng / n
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>{
</span></span></span><span class=line><span class=cl><span class=s1>    giá_trị[NR] = $1
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>
</span></span></span><span class=line><span class=cl><span class=s1>END {
</span></span></span><span class=line><span class=cl><span class=s1>    print &#34;Lớn nhất:&#34;, max(giá_trị[1], giá_trị[NR])
</span></span></span><span class=line><span class=cl><span class=s1>    print &#34;Trung bình:&#34;, trung_binh(giá_trị, NR)
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>&#39;</span> số.txt</span></span></code></pre></div><h3 class=heading-element id=28-printf---xuất-có-định-dạng><span>2.8 Printf - Xuất Có Định Dạng</span>
<a href=#28-printf---xu%e1%ba%a5t-c%c3%b3-%c4%91%e1%bb%8bnh-d%e1%ba%a1ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Ký hiệu định dạng</span>
</span></span><span class=line><span class=cl>%s      <span class=c1># Chuỗi</span>
</span></span><span class=line><span class=cl>%d, %i  <span class=c1># Số nguyên</span>
</span></span><span class=line><span class=cl>%f      <span class=c1># Số thực</span>
</span></span><span class=line><span class=cl>%e      <span class=c1># Ký hiệu khoa học</span>
</span></span><span class=line><span class=cl>%x, %X  <span class=c1># Số hex</span>
</span></span><span class=line><span class=cl>%%      <span class=c1># Ký tự % thật</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Độ rộng và độ chính xác</span>
</span></span><span class=line><span class=cl>%10s    <span class=c1># Canh phải, độ rộng 10</span>
</span></span><span class=line><span class=cl>%-10s   <span class=c1># Canh trái, độ rộng 10</span>
</span></span><span class=line><span class=cl>%010d   <span class=c1># Đệm số 0, độ rộng 10</span>
</span></span><span class=line><span class=cl>%.2f    <span class=c1># 2 chữ số thập phân</span>
</span></span><span class=line><span class=cl>%10.2f  <span class=c1># Độ rộng 10, 2 số thập phân</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: Định dạng báo cáo</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;BEGIN {
</span></span></span><span class=line><span class=cl><span class=s1>    printf &#34;%-20s %10s %10s\n&#34;, &#34;Tên&#34;, &#34;Kích thước&#34;, &#34;Số lượng&#34;
</span></span></span><span class=line><span class=cl><span class=s1>    printf &#34;%-20s %10s %10s\n&#34;, &#34;----&#34;, &#34;----------&#34;, &#34;--------&#34;
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>{
</span></span></span><span class=line><span class=cl><span class=s1>    printf &#34;%-20s %10d %10d\n&#34;, $1, $2, $3
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> dữ_liệu.txt</span></span></code></pre></div><hr><h2 class=heading-element id=phần-3-sed-chuyên-sâu><span>PHẦN 3: SED CHUYÊN SÂU</span>
<a href=#ph%e1%ba%a7n-3-sed-chuy%c3%aan-s%c3%a2u class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=31-mô-hình-thực-thi><span>3.1 Mô Hình Thực Thi</span>
<a href=#31-m%c3%b4-h%c3%acnh-th%e1%bb%b1c-thi class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                MÔ HÌNH THỰC THI SED                         │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Luồng Đầu Vào
</span></span><span class=line><span class=cl>     │
</span></span><span class=line><span class=cl>     ▼
</span></span><span class=line><span class=cl>┌─────────────┐
</span></span><span class=line><span class=cl>│ Đọc dòng    │◄────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ vào         │                                     │
</span></span><span class=line><span class=cl>│ KHÔNG GIAN  │                                     │
</span></span><span class=line><span class=cl>│ MẪU         │                                     │
</span></span><span class=line><span class=cl>└─────────────┘                                     │
</span></span><span class=line><span class=cl>     │                                              │
</span></span><span class=line><span class=cl>     ▼                                              │
</span></span><span class=line><span class=cl>┌─────────────┐     ┌─────────────┐                 │
</span></span><span class=line><span class=cl>│ Thực thi    │────►│  KHÔNG GIAN │                 │
</span></span><span class=line><span class=cl>│ lệnh        │◄────│  GIỮ        │                 │
</span></span><span class=line><span class=cl>└─────────────┘     │  (bộ đệm)   │                 │
</span></span><span class=line><span class=cl>     │              └─────────────┘                 │
</span></span><span class=line><span class=cl>     ▼                                              │
</span></span><span class=line><span class=cl>┌─────────────┐                                     │
</span></span><span class=line><span class=cl>│ In          │                                     │
</span></span><span class=line><span class=cl>│ không gian  │                                     │
</span></span><span class=line><span class=cl>│ mẫu         │                                     │
</span></span><span class=line><span class=cl>└─────────────┘                                     │
</span></span><span class=line><span class=cl>     │                                              │
</span></span><span class=line><span class=cl>     ▼                                              │
</span></span><span class=line><span class=cl>┌─────────────┐                                     │
</span></span><span class=line><span class=cl>│ Dòng tiếp   │─────────────────────────────────────┘
</span></span><span class=line><span class=cl>└─────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>KHÁI NIỆM QUAN TRỌNG:
</span></span><span class=line><span class=cl>- Không Gian Mẫu (Pattern Space): Bộ đệm làm việc, tự động in cuối chu kỳ
</span></span><span class=line><span class=cl>- Không Gian Giữ (Hold Space): Bộ đệm phụ, tồn tại qua các chu kỳ</span></span></code></pre></div><h3 class=heading-element id=32-các-loại-địa-chỉ---chỉ-định-dòng-để-xử-lý><span>3.2 Các Loại Địa Chỉ - Chỉ định dòng để xử lý</span>
<a href=#32-c%c3%a1c-lo%e1%ba%a1i-%c4%91%e1%bb%8ba-ch%e1%bb%89---ch%e1%bb%89-%c4%91%e1%bb%8bnh-d%c3%b2ng-%c4%91%e1%bb%83-x%e1%bb%ad-l%c3%bd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Số dòng</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;5d&#39;</span> file               <span class=c1># Xóa dòng 5</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;1,10d&#39;</span> file            <span class=c1># Xóa dòng 1-10</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;$d&#39;</span> file               <span class=c1># Xóa dòng cuối</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;1!d&#39;</span> file              <span class=c1># Xóa tất cả TRỪ dòng 1</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Địa chỉ regex</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/ERROR/d&#39;</span> file         <span class=c1># Xóa dòng chứa ERROR</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/^#/d&#39;</span> file            <span class=c1># Xóa dòng ghi chú</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/^$/d&#39;</span> file            <span class=c1># Xóa dòng trống</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Địa chỉ phạm vi</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;10,20d&#39;</span> file           <span class=c1># Dòng 10-20</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/BẮT_ĐẦU/,/KẾT_THÚC/d&#39;</span> file   <span class=c1># Từ BẮT_ĐẦU đến KẾT_THÚC (bao gồm)</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;1,/^$/d&#39;</span> file          <span class=c1># Dòng 1 đến dòng trống đầu tiên</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Địa chỉ bước (GNU sed)</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;1~2d&#39;</span> file             <span class=c1># Xóa dòng lẻ (1,3,5...)</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;0~3d&#39;</span> file             <span class=c1># Xóa mỗi dòng thứ 3</span></span></span></code></pre></div><h3 class=heading-element id=33-tham-khảo-lệnh><span>3.3 Tham Khảo Lệnh</span>
<a href=#33-tham-kh%e1%ba%a3o-l%e1%bb%87nh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>Lệnh Cơ Bản:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>d       <span class=c1># Xóa không gian mẫu, bắt đầu chu kỳ mới</span>
</span></span><span class=line><span class=cl>p       <span class=c1># In không gian mẫu</span>
</span></span><span class=line><span class=cl>q       <span class=c1># Thoát (in không gian mẫu và thoát)</span>
</span></span><span class=line><span class=cl>Q       <span class=c1># Thoát (không in) - GNU</span>
</span></span><span class=line><span class=cl>n       <span class=c1># In không gian mẫu, đọc dòng tiếp</span>
</span></span><span class=line><span class=cl>N       <span class=c1># Nối dòng tiếp vào không gian mẫu (với \n)</span></span></span></code></pre></div><p><strong>Thay Thế - Cái quan trọng nhất:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>s/regex/thay_thế/cờ
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Các cờ:</span>
</span></span><span class=line><span class=cl>g       <span class=c1># Toàn cục - thay thế tất cả lần xuất hiện</span>
</span></span><span class=line><span class=cl>i       <span class=c1># Không phân biệt hoa thường (GNU)</span>
</span></span><span class=line><span class=cl>p       <span class=c1># In nếu có thay thế</span>
</span></span><span class=line><span class=cl>w file  <span class=c1># Ghi vào file nếu có thay thế</span>
</span></span><span class=line><span class=cl>SỐ      <span class=c1># Chỉ thay thế lần xuất hiện thứ N</span></span></span></code></pre></div><p><strong>Ví dụ thay thế:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Thay thế cơ bản</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/cũ/mới/&#39;</span> file           <span class=c1># Lần xuất hiện đầu tiên mỗi dòng</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/cũ/mới/g&#39;</span> file          <span class=c1># Tất cả lần xuất hiện</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/cũ/mới/2&#39;</span> file          <span class=c1># Chỉ lần xuất hiện thứ 2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Không phân biệt hoa thường</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/error/LỖI/gi&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dùng ký tự phân cách khác (khi mẫu chứa /)</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s|/usr/local|/opt|g&#39;</span> file
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s#http://#https://#g&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tham chiếu ngược</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/\(.*\):\(.*\)/\2:\1/&#39;</span> file    <span class=c1># Đổi chỗ quanh dấu :</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/\([0-9]*\)/[\1]/g&#39;</span> file       <span class=c1># Bọc số trong []</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký tự thay thế đặc biệt</span>
</span></span><span class=line><span class=cl><span class=p>&amp;</span>       <span class=c1># Toàn bộ chuỗi khớp</span>
</span></span><span class=line><span class=cl><span class=se>\1</span>-<span class=se>\9</span>   <span class=c1># Tham chiếu ngược</span>
</span></span><span class=line><span class=cl><span class=se>\L</span>      <span class=c1># Chuyển thành chữ thường phần tiếp theo (GNU)</span>
</span></span><span class=line><span class=cl><span class=se>\U</span>      <span class=c1># Chuyển thành chữ hoa phần tiếp theo (GNU)</span>
</span></span><span class=line><span class=cl><span class=se>\E</span>      <span class=c1># Kết thúc chuyển đổi chữ hoa/thường (GNU)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/.*/[&amp;]/&#39;</span> file                <span class=c1># Bọc mỗi dòng trong []</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/[a-z]*/\U&amp;/&#39;</span> file            <span class=c1># Chuyển từ đầu tiên thành chữ hoa</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/\(.*\)/\L\1/&#39;</span> file           <span class=c1># Chuyển toàn bộ dòng thành chữ thường</span></span></span></code></pre></div><h3 class=heading-element id=34-nhiều-lệnh><span>3.4 Nhiều Lệnh</span>
<a href=#34-nhi%e1%bb%81u-l%e1%bb%87nh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Phân cách bằng dấu chấm phẩy</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/a/A/g; s/b/B/g&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cờ -e</span>
</span></span><span class=line><span class=cl>sed -e <span class=s1>&#39;s/a/A/g&#39;</span> -e <span class=s1>&#39;s/b/B/g&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># File script</span>
</span></span><span class=line><span class=cl>cat &gt; script.sed <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s>s/a/A/g
</span></span></span><span class=line><span class=cl><span class=s>s/b/B/g
</span></span></span><span class=line><span class=cl><span class=s>/^$/d
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>sed -f script.sed file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ngoặc nhọn cho địa chỉ</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/ERROR/{
</span></span></span><span class=line><span class=cl><span class=s1>    s/error/LỖI/gi
</span></span></span><span class=line><span class=cl><span class=s1>    s/$/!!!/
</span></span></span><span class=line><span class=cl><span class=s1>    p
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> file</span></span></code></pre></div><h3 class=heading-element id=35-không-gian-giữ---thao-tác-bộ-đệm-nâng-cao><span>3.5 Không Gian Giữ - Thao Tác Bộ Đệm Nâng Cao</span>
<a href=#35-kh%c3%b4ng-gian-gi%e1%bb%af---thao-t%c3%a1c-b%e1%bb%99-%c4%91%e1%bb%87m-n%c3%a2ng-cao class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Các lệnh:</span>
</span></span><span class=line><span class=cl>h       <span class=c1># Sao chép không gian mẫu sang không gian giữ</span>
</span></span><span class=line><span class=cl>H       <span class=c1># Nối không gian mẫu vào không gian giữ</span>
</span></span><span class=line><span class=cl>g       <span class=c1># Sao chép không gian giữ sang không gian mẫu</span>
</span></span><span class=line><span class=cl>G       <span class=c1># Nối không gian giữ vào không gian mẫu</span>
</span></span><span class=line><span class=cl>x       <span class=c1># Hoán đổi không gian mẫu và không gian giữ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: Đảo ngược file (như lệnh tac)</span>
</span></span><span class=line><span class=cl>sed -n <span class=s1>&#39;1!G; h; $p&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Phân tích:</span>
</span></span><span class=line><span class=cl><span class=c1># 1!G   - Trừ dòng 1, nối không gian giữ vào không gian mẫu</span>
</span></span><span class=line><span class=cl><span class=c1># h     - Sao chép không gian mẫu vào không gian giữ</span>
</span></span><span class=line><span class=cl><span class=c1># $p    - Ở dòng cuối, in không gian mẫu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: Nối cặp dòng</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;N; s/\n/ /&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: In dòng trước dòng khớp</span>
</span></span><span class=line><span class=cl>sed -n <span class=s1>&#39;/ERROR/{x;p;x;p}&#39;</span> file  <span class=c1># In dòng trước và dòng hiện tại</span></span></span></code></pre></div><h3 class=heading-element id=36-nhánh-và-nhãn-nâng-cao><span>3.6 Nhánh và Nhãn (Nâng Cao)</span>
<a href=#36-nh%c3%a1nh-v%c3%a0-nh%c3%a3n-n%c3%a2ng-cao class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Nhãn và nhánh cho logic phức tạp</span>
</span></span><span class=line><span class=cl>:nhãn       <span class=c1># Định nghĩa nhãn</span>
</span></span><span class=line><span class=cl>b nhãn      <span class=c1># Nhảy đến nhãn (không điều kiện)</span>
</span></span><span class=line><span class=cl>t nhãn      <span class=c1># Nhảy nếu s/// vừa thành công</span>
</span></span><span class=line><span class=cl>T nhãn      <span class=c1># Nhảy nếu s/// vừa thất bại (GNU)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: Xóa nhiều dấu cách</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;:vòng; s/  / /g; t vòng&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ: Nối dòng tiếp nối (kết thúc bằng \)</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;:a; /\\$/{N; s/\\\n//; ta}&#39;</span> file</span></span></code></pre></div><h3 class=heading-element id=37-chỉnh-sửa-tại-chỗ><span>3.7 Chỉnh Sửa Tại Chỗ</span>
<a href=#37-ch%e1%bb%89nh-s%e1%bb%ada-t%e1%ba%a1i-ch%e1%bb%97 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Cờ -i (GNU sed)</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/cũ/mới/g&#39;</span> file           <span class=c1># Sửa tại chỗ</span>
</span></span><span class=line><span class=cl>sed -i.bak <span class=s1>&#39;s/cũ/mới/g&#39;</span> file       <span class=c1># Tạo bản sao lưu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># macOS sed yêu cầu tham số cho -i</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;&#39;</span> <span class=s1>&#39;s/cũ/mới/g&#39;</span> file        <span class=c1># Không sao lưu</span>
</span></span><span class=line><span class=cl>sed -i .bak <span class=s1>&#39;s/cũ/mới/g&#39;</span> file      <span class=c1># Có sao lưu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mẫu an toàn - luôn sao lưu trước</span>
</span></span><span class=line><span class=cl>cp file file.bak <span class=o>&amp;&amp;</span> sed -i <span class=s1>&#39;s/cũ/mới/g&#39;</span> file</span></span></code></pre></div><hr><h2 class=heading-element id=phần-4-phân-tích-độ-phức-tạp><span>PHẦN 4: PHÂN TÍCH ĐỘ PHỨC TẠP</span>
<a href=#ph%e1%ba%a7n-4-ph%c3%a2n-t%c3%adch-%c4%91%e1%bb%99-ph%e1%bb%a9c-t%e1%ba%a1p class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=41-big-o-của-các-thao-tác><span>4.1 Big-O của các thao tác</span>
<a href=#41-big-o-c%e1%bb%a7a-c%c3%a1c-thao-t%c3%a1c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              PHÂN TÍCH ĐỘ PHỨC TẠP                          │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ĐỌC &amp; XỬ LÝ CƠ BẢN
</span></span><span class=line><span class=cl>┌────────────────────┬────────────┬──────────────────────────┐
</span></span><span class=line><span class=cl>│ Thao tác           │ Độ phức tạp│ Ghi chú                  │
</span></span><span class=line><span class=cl>├────────────────────┼────────────┼──────────────────────────┤
</span></span><span class=line><span class=cl>│ Đọc file           │ O(n)       │ n = kích thước file byte │
</span></span><span class=line><span class=cl>│ Tách dòng          │ O(m)       │ m = độ dài dòng          │
</span></span><span class=line><span class=cl>│ Tách trường (awk)  │ O(m)       │ Một lượt qua dòng        │
</span></span><span class=line><span class=cl>│ In                 │ O(k)       │ k = kích thước đầu ra    │
</span></span><span class=line><span class=cl>└────────────────────┴────────────┴──────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>KHỚP MẪU
</span></span><span class=line><span class=cl>┌────────────────────┬────────────┬──────────────────────────┐
</span></span><span class=line><span class=cl>│ Loại mẫu           │ Độ phức tạp│ Ghi chú                  │
</span></span><span class=line><span class=cl>├────────────────────┼────────────┼──────────────────────────┤
</span></span><span class=line><span class=cl>│ Chuỗi cố định      │ O(n*m)     │ n=văn bản, m=mẫu         │
</span></span><span class=line><span class=cl>│ Regex đơn giản     │ O(n)       │ Dựa trên DFA             │
</span></span><span class=line><span class=cl>│ Regex phức tạp     │ O(n*2^m)   │ NFA có quay lui          │
</span></span><span class=line><span class=cl>│ Regex có neo ^$    │ O(m)       │ Chỉ kiểm tra đầu/cuối    │
</span></span><span class=line><span class=cl>└────────────────────┴────────────┴──────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>RIÊNG AWK
</span></span><span class=line><span class=cl>┌────────────────────┬────────────┬──────────────────────────┐
</span></span><span class=line><span class=cl>│ Thao tác           │ Độ phức tạp│ Ghi chú                  │
</span></span><span class=line><span class=cl>├────────────────────┼────────────┼──────────────────────────┤
</span></span><span class=line><span class=cl>│ Truy cập mảng      │ O(1) tb    │ Bảng băm                 │
</span></span><span class=line><span class=cl>│ Duyệt mảng         │ O(k)       │ k = số lượng khóa        │
</span></span><span class=line><span class=cl>│ gsub()             │ O(n*m)     │ n=chuỗi, m=mẫu           │
</span></span><span class=line><span class=cl>│ split()            │ O(n)       │ n = độ dài chuỗi         │
</span></span><span class=line><span class=cl>│ sort (qua pipe)    │ O(n log n) │ Sắp xếp bên ngoài        │
</span></span><span class=line><span class=cl>└────────────────────┴────────────┴──────────────────────────┘</span></span></code></pre></div><h3 class=heading-element id=42-cơ-chế-regex-bên-trong---khi-nào-nó-chậm><span>4.2 Cơ Chế Regex Bên Trong - Khi nào nó chậm</span>
<a href=#42-c%c6%a1-ch%e1%ba%bf-regex-b%c3%aan-trong---khi-n%c3%a0o-n%c3%b3-ch%e1%ba%adm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><p><strong>DFA vs NFA:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>DFA (Máy Tự Động Hữu Hạn Xác Định):
</span></span><span class=line><span class=cl>- Mỗi trạng thái chỉ có 1 chuyển tiếp cho mỗi đầu vào
</span></span><span class=line><span class=cl>- Đảm bảo O(n)
</span></span><span class=line><span class=cl>- Không hỗ trợ tham chiếu ngược
</span></span><span class=line><span class=cl>- Dùng bởi: grep (cho mẫu đơn giản), awk
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NFA (Máy Tự Động Hữu Hạn Không Xác Định):
</span></span><span class=line><span class=cl>- Có thể có nhiều chuyển tiếp
</span></span><span class=line><span class=cl>- Hỗ trợ tham chiếu ngược, nhìn trước
</span></span><span class=line><span class=cl>- Có thể quay lui → trường hợp xấu nhất mũ
</span></span><span class=line><span class=cl>- Dùng bởi: sed, grep -P, PCRE</span></span></code></pre></div><p><strong>Quay Lui Thảm Họa:</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Các mẫu NGUY HIỂM - có thể O(2^n):</span>
</span></span><span class=line><span class=cl><span class=o>(</span>a+<span class=o>)</span>+$              <span class=c1># Lượng từ lồng nhau</span>
</span></span><span class=line><span class=cl><span class=o>(</span>a<span class=p>|</span>aa<span class=o>)</span>+$            <span class=c1># Lựa chọn chồng lấp</span>
</span></span><span class=line><span class=cl><span class=o>(</span>.*a<span class=o>){</span>10<span class=o>}</span>           <span class=c1># Tham lam với lặp lại</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trường hợp thử nghiệm giết chết regex engine:</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;aaaaaaaaaaaaaaaaaaaaaaaab&#34;</span> <span class=p>|</span> grep -E <span class=s1>&#39;(a+)+$&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># Sẽ chạy rất lâu hoặc hết thời gian</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay thế AN TOÀN:</span>
</span></span><span class=line><span class=cl>a+$                 <span class=c1># Bỏ lồng nhau</span>
</span></span><span class=line><span class=cl><span class=o>(</span>?:a<span class=o>)</span>+$             <span class=c1># Nhóm không bắt (PCRE)</span>
</span></span><span class=line><span class=cl><span class=o>[</span>a<span class=o>]</span>+$               <span class=c1># Lớp ký tự</span></span></span></code></pre></div><p><strong>Quy tắc tránh regex chậm:</strong></p><ol><li>Tránh lượng từ lồng nhau: <code>(a+)+</code>, <code>(a*)*</code></li><li>Tránh lựa chọn chồng lấp: <code>(a|ab)+</code></li><li>Dùng neo khi có thể: <code>^mẫu</code>, <code>mẫu$</code></li><li>Ưu tiên lớp ký tự hơn lựa chọn: <code>[aeiou]</code> thay vì <code>a|e|i|o|u</code></li><li>Cụ thể hóa: <code>[0-9]{4}</code> thay vì <code>.*[0-9].*[0-9].*[0-9].*[0-9]</code></li></ol><h3 class=heading-element id=43-sử-dụng-bộ-nhớ><span>4.3 Sử Dụng Bộ Nhớ</span>
<a href=#43-s%e1%bb%ad-d%e1%bb%a5ng-b%e1%bb%99-nh%e1%bb%9b class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Bộ nhớ awk dùng:</span>
</span></span><span class=line><span class=cl><span class=c1># - Mỗi bản ghi: O(m) với m = kích thước bản ghi</span>
</span></span><span class=line><span class=cl><span class=c1># - Mảng: O(k * kích_thước_giá_trị_tb) với k = số khóa</span>
</span></span><span class=line><span class=cl><span class=c1># - Không nạp toàn bộ file vào bộ nhớ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bộ nhớ sed dùng:</span>
</span></span><span class=line><span class=cl><span class=c1># - Không gian mẫu: O(m) với m = kích thước dòng (hoặc lớn hơn với N)</span>
</span></span><span class=line><span class=cl><span class=c1># - Không gian giữ: O(h) với h = kích thước tích lũy</span>
</span></span><span class=line><span class=cl><span class=c1># - Cũng không nạp toàn bộ file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ xử lý file 10GB:</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{tổng += $1} END {print tổng}&#39;</span> file_khổng_lồ.txt
</span></span><span class=line><span class=cl><span class=c1># Bộ nhớ: ~hằng số (chỉ giữ tổng và dòng hiện tại)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NHƯNG nếu nạp tất cả vào mảng:</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{dòng[NR] = $0} END {for (i in dòng) print dòng[i]}&#39;</span> file_khổng_lồ.txt
</span></span><span class=line><span class=cl><span class=c1># Bộ nhớ: O(n) - sẽ hết RAM!</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-5-ví-dụ-thực-tế><span>PHẦN 5: VÍ DỤ THỰC TẾ</span>
<a href=#ph%e1%ba%a7n-5-v%c3%ad-d%e1%bb%a5-th%e1%bb%b1c-t%e1%ba%bf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=51-phân-tích-log><span>5.1 Phân Tích Log</span>
<a href=#51-ph%c3%a2n-t%c3%adch-log class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Phân tích log truy cập nginx</span>
</span></span><span class=line><span class=cl><span class=c1># Định dạng: IP - - [ngày] &#34;phương_thức đường_dẫn giao_thức&#34; trạng_thái bytes &#34;referer&#34; &#34;ua&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Top 10 IP theo số lượng yêu cầu</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $1}&#39;</span> access.log <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn <span class=p>|</span> head -10
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hoặc hoàn toàn trong awk (nhanh hơn - một lượt):</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{ip[$1]++} END {for (i in ip) print ip[i], i}&#39;</span> access.log <span class=p>|</span> sort -rn <span class=p>|</span> head -10
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Số yêu cầu theo phút</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    # Trích xuất timestamp: [10/Dec/2024:10:15:32 +0000]
</span></span></span><span class=line><span class=cl><span class=s1>    split($4, a, &#34;:&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    phút = a[1] &#34;:&#34; a[2] &#34;:&#34; a[3]
</span></span></span><span class=line><span class=cl><span class=s1>    đếm[phút]++
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>END {
</span></span></span><span class=line><span class=cl><span class=s1>    for (m in đếm) print m, đếm[m]
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> access.log <span class=p>|</span> sort
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm yêu cầu chậm (thời gian phản hồi ở trường cuối)</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$NF &gt; 5.0 {print $4, $7, $NF}&#39;</span> access.log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Phân tích mã trạng thái theo giờ</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    split($4, t, &#34;:&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    giờ = t[2]
</span></span></span><span class=line><span class=cl><span class=s1>    trạng_thái = $9
</span></span></span><span class=line><span class=cl><span class=s1>    thống_kê[giờ][trạng_thái]++
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>END {
</span></span></span><span class=line><span class=cl><span class=s1>    for (h in thống_kê) {
</span></span></span><span class=line><span class=cl><span class=s1>        printf &#34;%s: &#34;, h
</span></span></span><span class=line><span class=cl><span class=s1>        for (s in thống_kê[h])
</span></span></span><span class=line><span class=cl><span class=s1>            printf &#34;%s=%d &#34;, s, thống_kê[h][s]
</span></span></span><span class=line><span class=cl><span class=s1>        print &#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> access.log</span></span></code></pre></div><h3 class=heading-element id=52-thao-tác-file-cấu-hình><span>5.2 Thao Tác File Cấu Hình</span>
<a href=#52-thao-t%c3%a1c-file-c%e1%ba%a5u-h%c3%acnh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Thay đổi giá trị trong cấu hình kiểu INI</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/^max_connections=.*/max_connections=500/&#39;</span> my.cnf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay đổi giá trị trong phần cụ thể</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;/^\[mysqld\]/,/^\[/{s/^max_connections=.*/max_connections=500/}&#39;</span> my.cnf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm dòng sau dòng khớp (nếu chưa tồn tại)</span>
</span></span><span class=line><span class=cl>grep -q <span class=s2>&#34;^new_setting&#34;</span> my.cnf <span class=o>||</span> sed -i <span class=s1>&#39;/^\[mysqld\]/a new_setting=value&#39;</span> my.cnf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ghi chú một dòng</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/^dangerous_option/#&amp;/&#39;</span> config.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bỏ ghi chú một dòng</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/^#\(wanted_option\)/\1/&#39;</span> config.conf
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay thế giữa các dấu hiệu</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;/^# BẮT ĐẦU QUẢN LÝ/,/^# KẾT THÚC QUẢN LÝ/{//!d}&#39;</span> file
</span></span><span class=line><span class=cl><span class=c1># Sau đó chèn nội dung mới sau BẮT ĐẦU QUẢN LÝ</span></span></span></code></pre></div><h3 class=heading-element id=53-chuyển-đổi-dữ-liệu><span>5.3 Chuyển Đổi Dữ Liệu</span>
<a href=#53-chuy%e1%bb%83n-%c4%91%e1%bb%95i-d%e1%bb%af-li%e1%bb%87u class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># CSV sang TSV</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/,/\t/g&#39;</span> file.csv &gt; file.tsv
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trích xuất kiểu JSON (trường hợp đơn giản)</span>
</span></span><span class=line><span class=cl>awk -F<span class=s1>&#39;&#34;&#39;</span> <span class=s1>&#39;/&#34;name&#34;:/{print $4}&#39;</span> data.json
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển hàng thành cột</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    for (i = 1; i &lt;= NF; i++)
</span></span></span><span class=line><span class=cl><span class=s1>        a[NR,i] = $i
</span></span></span><span class=line><span class=cl><span class=s1>    if (NF &gt; max_nf) max_nf = NF
</span></span></span><span class=line><span class=cl><span class=s1>}
</span></span></span><span class=line><span class=cl><span class=s1>END {
</span></span></span><span class=line><span class=cl><span class=s1>    for (i = 1; i &lt;= max_nf; i++) {
</span></span></span><span class=line><span class=cl><span class=s1>        for (j = 1; j &lt;= NR; j++)
</span></span></span><span class=line><span class=cl><span class=s1>            printf &#34;%s%s&#34;, a[j,i], (j &lt; NR ? &#34;\t&#34; : &#34;\n&#34;)
</span></span></span><span class=line><span class=cl><span class=s1>    }
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển đổi timestamp epoch sang dạng đọc được</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    cmd = &#34;date -d @&#34; $1 &#34; +\&#34;%Y-%m-%d %H:%M:%S\&#34;&#34;
</span></span></span><span class=line><span class=cl><span class=s1>    cmd | getline đã_định_dạng
</span></span></span><span class=line><span class=cl><span class=s1>    close(cmd)
</span></span></span><span class=line><span class=cl><span class=s1>    $1 = đã_định_dạng
</span></span></span><span class=line><span class=cl><span class=s1>    print
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> timestamps.txt</span></span></code></pre></div><h3 class=heading-element id=54-quản-trị-hệ-thống><span>5.4 Quản Trị Hệ Thống</span>
<a href=#54-qu%e1%ba%a3n-tr%e1%bb%8b-h%e1%bb%87-th%e1%bb%91ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Giết tiến trình theo mẫu</span>
</span></span><span class=line><span class=cl>ps aux <span class=p>|</span> awk <span class=s1>&#39;/mẫu/ &amp;&amp; !/awk/ {print $2}&#39;</span> <span class=p>|</span> xargs <span class=nb>kill</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Báo cáo sử dụng đĩa</span>
</span></span><span class=line><span class=cl>df -h <span class=p>|</span> awk <span class=s1>&#39;NR&gt;1 {
</span></span></span><span class=line><span class=cl><span class=s1>    gsub(/%/, &#34;&#34;, $5)
</span></span></span><span class=line><span class=cl><span class=s1>    if ($5 &gt; 80)
</span></span></span><span class=line><span class=cl><span class=s1>        print &#34;CẢNH BÁO:&#34;, $6, &#34;đã dùng&#34;, $5&#34;%&#34;
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm file lớn</span>
</span></span><span class=line><span class=cl>find /đường_dẫn -type f -size +100M -exec ls -lh <span class=o>{}</span> <span class=se>\;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    awk <span class=s1>&#39;{print $5, $9}&#39;</span> <span class=p>|</span> sort -h
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trích xuất và đếm IP duy nhất từ log xác thực</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/Failed password/ {
</span></span></span><span class=line><span class=cl><span class=s1>    for (i=1; i&lt;=NF; i++)
</span></span></span><span class=line><span class=cl><span class=s1>        if ($i ~ /^[0-9]+\.[0-9]+\.[0-9]+\.[0-9]+$/)
</span></span></span><span class=line><span class=cl><span class=s1>            print $i
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> /var/log/auth.log <span class=p>|</span> sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Theo dõi sử dụng bộ nhớ</span>
</span></span><span class=line><span class=cl><span class=k>while</span> true<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    free -m <span class=p>|</span> awk <span class=s1>&#39;/Mem:/ {printf &#34;%s: Đã dùng %dMB / %dMB (%.1f%%)\n&#34;,
</span></span></span><span class=line><span class=cl><span class=s1>        strftime(&#34;%H:%M:%S&#34;), $3, $2, $3/$2*100}&#39;</span>
</span></span><span class=line><span class=cl>    sleep <span class=m>5</span>
</span></span><span class=line><span class=cl><span class=k>done</span></span></span></code></pre></div><h3 class=heading-element id=55-đường-ống-xử-lý-văn-bản><span>5.5 Đường Ống Xử Lý Văn Bản</span>
<a href=#55-%c4%91%c6%b0%e1%bb%9dng-%e1%bb%91ng-x%e1%bb%ad-l%c3%bd-v%c4%83n-b%e1%ba%a3n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Trích xuất tên miền email duy nhất và đếm</span>
</span></span><span class=line><span class=cl>grep -oE <span class=s1>&#39;[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}&#39;</span> file <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    awk -F<span class=s1>&#39;@&#39;</span> <span class=s1>&#39;{print $2}&#39;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    sort <span class=p>|</span> uniq -c <span class=p>|</span> sort -rn
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo báo cáo từ nhiều file log</span>
</span></span><span class=line><span class=cl><span class=k>for</span> f in *.log<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;=== </span><span class=nv>$f</span><span class=s2> ===&#34;</span>
</span></span><span class=line><span class=cl>    awk <span class=s1>&#39;/ERROR/ {đếm++} END {print &#34;Lỗi:&#34;, đếm+0}&#39;</span> <span class=s2>&#34;</span><span class=nv>$f</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    awk <span class=s1>&#39;/WARNING/ {đếm++} END {print &#34;Cảnh báo:&#34;, đếm+0}&#39;</span> <span class=s2>&#34;</span><span class=nv>$f</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi tên file hàng loạt</span>
</span></span><span class=line><span class=cl>ls *.JPG <span class=p>|</span> sed <span class=s1>&#39;s/\(.*\)\.JPG/mv &#34;&amp;&#34; &#34;\1.jpg&#34;/&#39;</span> <span class=p>|</span> sh
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># An toàn hơn với xem trước:</span>
</span></span><span class=line><span class=cl>ls *.JPG <span class=p>|</span> sed <span class=s1>&#39;s/\(.*\)\.JPG/mv &#34;&amp;&#34; &#34;\1.jpg&#34;/&#39;</span>      <span class=c1># Xem trước</span>
</span></span><span class=line><span class=cl>ls *.JPG <span class=p>|</span> sed <span class=s1>&#39;s/\(.*\)\.JPG/mv &#34;&amp;&#34; &#34;\1.jpg&#34;/&#39;</span> <span class=p>|</span> sh <span class=c1># Thực thi</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-6-sai-lầm-và-thực-hành-tốt><span>PHẦN 6: SAI LẦM VÀ THỰC HÀNH TỐT</span>
<a href=#ph%e1%ba%a7n-6-sai-l%e1%ba%a7m-v%c3%a0-th%e1%bb%b1c-h%c3%a0nh-t%e1%bb%91t class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=61-những-sai-lầm-cần-tránh><span>6.1 Những Sai Lầm Cần Tránh</span>
<a href=#61-nh%e1%bb%afng-sai-l%e1%ba%a7m-c%e1%ba%a7n-tr%c3%a1nh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ❌ DÙNG CAT VÔ ÍCH</span>
</span></span><span class=line><span class=cl>cat file <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># ✅ ĐÚNG</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $1}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ❌ DÙNG GREP VÔ ÍCH TRƯỚC AWK</span>
</span></span><span class=line><span class=cl>grep ERROR file <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span>
</span></span><span class=line><span class=cl><span class=c1># ✅ ĐÚNG</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/ERROR/ {print $1}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ❌ NHIỀU LƯỢT DUYỆT</span>
</span></span><span class=line><span class=cl>grep mẫu file <span class=p>|</span> wc -l
</span></span><span class=line><span class=cl><span class=c1># ✅ MỘT LƯỢT</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/mẫu/ {c++} END {print c+0}&#39;</span> file
</span></span><span class=line><span class=cl><span class=c1># Hoặc</span>
</span></span><span class=line><span class=cl>grep -c mẫu file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ❌ PHÂN TÍCH ĐẦU RA CỦA ls</span>
</span></span><span class=line><span class=cl>ls -l <span class=p>|</span> awk <span class=s1>&#39;{print $9}&#39;</span>  <span class=c1># Hỏng với tên file có dấu cách</span>
</span></span><span class=line><span class=cl><span class=c1># ✅ DÙNG find HOẶC glob</span>
</span></span><span class=line><span class=cl>find . -maxdepth <span class=m>1</span> -type f -name <span class=s2>&#34;*.txt&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> f in *.txt<span class=p>;</span> <span class=k>do</span> <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$f</span><span class=s2>&#34;</span><span class=p>;</span> <span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ❌ DÙNG VÒNG LẶP SHELL ĐỂ XỬ LÝ VĂN BẢN</span>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=nb>read</span> dòng<span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$dòng</span><span class=s2>&#34;</span> <span class=p>|</span> awk <span class=s1>&#39;{print $1}&#39;</span>
</span></span><span class=line><span class=cl><span class=k>done</span> &lt; file
</span></span><span class=line><span class=cl><span class=c1># ✅ ĐỂ AWK TỰ LẶP</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $1}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ❌ ECHO QUA SED/AWK ĐỂ THAO TÁC BIẾN</span>
</span></span><span class=line><span class=cl><span class=nv>kết_quả</span><span class=o>=</span><span class=k>$(</span><span class=nb>echo</span> <span class=s2>&#34;</span><span class=nv>$biến</span><span class=s2>&#34;</span> <span class=p>|</span> sed <span class=s1>&#39;s/cũ/mới/&#39;</span><span class=k>)</span>
</span></span><span class=line><span class=cl><span class=c1># ✅ DÙNG THAO TÁC CHUỖI BASH</span>
</span></span><span class=line><span class=cl><span class=nv>kết_quả</span><span class=o>=</span><span class=s2>&#34;</span><span class=si>${</span><span class=nv>biến</span><span class=p>/cũ/mới</span><span class=si>}</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ❌ REGEX THAM LAM KHÔNG SUY NGHĨ</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/&lt;.*&gt;//&#39;</span> file.html  <span class=c1># Xóa quá nhiều</span>
</span></span><span class=line><span class=cl><span class=c1># ✅ KHÔNG THAM LAM HOẶC LỚP PHỦ ĐỊNH</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/&lt;[^&gt;]*&gt;//g&#39;</span> file.html</span></span></code></pre></div><h3 class=heading-element id=62-mẹo-hiệu-năng><span>6.2 Mẹo Hiệu Năng</span>
<a href=#62-m%e1%ba%b9o-hi%e1%bb%87u-n%c4%83ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># 1. Mẫu có neo nhanh hơn mẫu trôi nổi</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/^ERROR/&#39;</span> file        <span class=c1># Nhanh hơn</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/ERROR/&#39;</span> file         <span class=c1># Chậm hơn (kiểm tra mọi nơi)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Lớp ký tự nhanh hơn lựa chọn</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;[aeiou]&#39;</span> file        <span class=c1># Nhanh hơn</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;a\|e\|i\|o\|u&#39;</span> file  <span class=c1># Chậm hơn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Chuỗi cố định nhanh hơn regex</span>
</span></span><span class=line><span class=cl>grep -F <span class=s1>&#39;chuỗi&#39;</span> file       <span class=c1># Nhanh nhất</span>
</span></span><span class=line><span class=cl>fgrep <span class=s1>&#39;chuỗi&#39;</span> file         <span class=c1># Tương tự</span>
</span></span><span class=line><span class=cl>grep <span class=s1>&#39;chuỗi&#39;</span> file          <span class=c1># Chậm hơn (qua regex engine)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Tránh sinh tiến trình trong vòng lặp</span>
</span></span><span class=line><span class=cl><span class=c1># ❌ TỆ</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{
</span></span></span><span class=line><span class=cl><span class=s1>    cmd = &#34;date -d @&#34; $1
</span></span></span><span class=line><span class=cl><span class=s1>    cmd | getline kết_quả
</span></span></span><span class=line><span class=cl><span class=s1>    close(cmd)
</span></span></span><span class=line><span class=cl><span class=s1>    print kết_quả
</span></span></span><span class=line><span class=cl><span class=s1>}&#39;</span> file
</span></span><span class=line><span class=cl><span class=c1># ✅ TỐT HƠN - xử lý theo lô</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $1}&#39;</span> file <span class=p>|</span> xargs -I<span class=o>{}</span> date -d @<span class=o>{}</span>
</span></span><span class=line><span class=cl><span class=c1># ✅ TỐT NHẤT - làm trong awk nếu có thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. Dùng mawk để tăng tốc (nếu có)</span>
</span></span><span class=line><span class=cl>mawk <span class=s1>&#39;{print $1}&#39;</span> file     <span class=c1># Nhanh hơn gawk 2-10 lần cho tác vụ đơn giản</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 6. LC_ALL=C cho xử lý theo byte</span>
</span></span><span class=line><span class=cl><span class=nv>LC_ALL</span><span class=o>=</span>C grep mẫu file     <span class=c1># Nhanh hơn, nhưng không hỗ trợ Unicode</span></span></span></code></pre></div><h3 class=heading-element id=63-cân-nhắc-tương-thích><span>6.3 Cân Nhắc Tương Thích</span>
<a href=#63-c%c3%a2n-nh%e1%ba%afc-t%c6%b0%c6%a1ng-th%c3%adch class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Khác biệt giữa GNU và BSD sed</span>
</span></span><span class=line><span class=cl><span class=c1># GNU sed:</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;s/cũ/mới/&#39;</span> file           <span class=c1># Tại chỗ, không sao lưu</span>
</span></span><span class=line><span class=cl>sed -i.bak <span class=s1>&#39;s/cũ/mới/&#39;</span> file       <span class=c1># Có sao lưu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BSD sed (macOS):</span>
</span></span><span class=line><span class=cl>sed -i <span class=s1>&#39;&#39;</span> <span class=s1>&#39;s/cũ/mới/&#39;</span> file        <span class=c1># Tại chỗ, không sao lưu</span>
</span></span><span class=line><span class=cl>sed -i .bak <span class=s1>&#39;s/cũ/mới/&#39;</span> file      <span class=c1># Có sao lưu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải pháp tương thích:</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/cũ/mới/&#39;</span> file &gt; tạm <span class=o>&amp;&amp;</span> mv tạm file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Regex mở rộng:</span>
</span></span><span class=line><span class=cl><span class=c1># GNU: sed -r hoặc sed -E</span>
</span></span><span class=line><span class=cl><span class=c1># BSD: chỉ sed -E</span>
</span></span><span class=line><span class=cl><span class=c1># Tương thích: Dùng sed -E (hoạt động trên cả hai phiên bản hiện đại)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khác biệt awk:</span>
</span></span><span class=line><span class=cl><span class=c1># gawk có nhiều mở rộng không có trong POSIX awk</span>
</span></span><span class=line><span class=cl><span class=c1># Để tương thích, dùng tính năng POSIX</span>
</span></span><span class=line><span class=cl><span class=c1># Hoặc gọi rõ ràng gawk khi cần</span></span></span></code></pre></div><hr><h2 class=heading-element id=phần-7-thẻ-tham-khảo-nhanh><span>PHẦN 7: THẺ THAM KHẢO NHANH</span>
<a href=#ph%e1%ba%a7n-7-th%e1%ba%bb-tham-kh%e1%ba%a3o-nhanh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=71-một-dòng-awk-hay-dùng><span>7.1 Một Dòng AWK Hay Dùng</span>
<a href=#71-m%e1%bb%99t-d%c3%b2ng-awk-hay-d%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># In trường cụ thể</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $1, $3}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In dòng khớp mẫu</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/mẫu/&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In dòng KHÔNG khớp</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;!/mẫu/&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In trường nếu điều kiện đúng</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;$3 &gt; 100 {print $1}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tổng một cột</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{tổng += $1} END {print tổng}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trung bình</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{tổng += $1; n++} END {print tổng/n}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đếm dòng khớp</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;/mẫu/ {n++} END {print n+0}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In giá trị duy nhất trong cột</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;!đã_thấy[$1]++&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In số dòng</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print NR, $0}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In trường cuối</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{print $NF}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đảo ngược thứ tự trường</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{for(i=NF;i&gt;0;i--) printf &#34;%s &#34;,$i; print &#34;&#34;}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm giá trị lớn nhất</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;NR==1 || $1&gt;max {max=$1} END {print max}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nối các dòng</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;{printf &#34;%s&#34;, $0} END {print &#34;&#34;}&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa dòng trùng lặp (giữ thứ tự)</span>
</span></span><span class=line><span class=cl>awk <span class=s1>&#39;!đã_thấy[$0]++&#39;</span> file</span></span></code></pre></div><h3 class=heading-element id=72-một-dòng-sed-hay-dùng><span>7.2 Một Dòng SED Hay Dùng</span>
<a href=#72-m%e1%bb%99t-d%c3%b2ng-sed-hay-d%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Thay thế lần xuất hiện đầu tiên</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/cũ/mới/&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay thế tất cả lần xuất hiện</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/cũ/mới/g&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa dòng khớp mẫu</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/mẫu/d&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa dòng trống</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/^$/d&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ in dòng khớp</span>
</span></span><span class=line><span class=cl>sed -n <span class=s1>&#39;/mẫu/p&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In dòng 5-10</span>
</span></span><span class=line><span class=cl>sed -n <span class=s1>&#39;5,10p&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa dòng đầu tiên</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;1d&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa dòng cuối</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;$d&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chèn dòng trước dòng khớp</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/mẫu/i\dòng mới&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chèn dòng sau dòng khớp</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/mẫu/a\dòng mới&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay thế dòng khớp mẫu</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;/mẫu/c\dòng thay thế&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># In số dòng</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;=&#39;</span> file <span class=p>|</span> sed <span class=s1>&#39;N; s/\n/\t/&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa khoảng trắng đầu dòng</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/^[ \t]*//&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa khoảng trắng cuối dòng</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/[ \t]*$//&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa cả hai</span>
</span></span><span class=line><span class=cl>sed <span class=s1>&#39;s/^[ \t]*//; s/[ \t]*$//&#39;</span> file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm dòng trống giữa các dòng</span>
</span></span><span class=line><span class=cl>sed G file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đảo ngược file</span>
</span></span><span class=line><span class=cl>sed -n <span class=s1>&#39;1!G;h;$p&#39;</span> file</span></span></code></pre></div><hr><h2 class=heading-element id=kết-luận><span>KẾT LUẬN</span>
<a href=#k%e1%ba%bft-lu%e1%ba%adn class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><p><strong>Kim Chỉ Nam (Nguyên Tắc Hướng Dẫn):</strong></p><ol><li><p><strong>Chọn công cụ đúng:</strong></p><ul><li>Chỉ cần tìm? → <code>grep</code></li><li>Cần trích xuất cột đơn giản? → <code>cut</code></li><li>Cần tìm & thay thế? → <code>sed</code></li><li>Cần logic, tính toán, tổng hợp? → <code>awk</code></li><li>Cần cả đống? → <code>perl</code> hoặc <code>python</code></li></ul></li><li><p><strong>Về hiệu năng:</strong></p><ul><li>Một lượt > nhiều lượt</li><li>Regex có neo > regex trôi nổi</li><li>Chuỗi cố định > regex khi có thể</li><li>Lớp ký tự > lựa chọn</li><li>Tránh lượng từ lồng nhau trong regex</li></ul></li><li><p><strong>Về bảo trì:</strong></p><ul><li>Ghi chú script awk phức tạp</li><li>Dùng tên biến có nghĩa</li><li>Chia đường ống phức tạp thành các bước</li><li>Thử với dữ liệu mẫu trước</li></ul></li><li><p><strong>Về tương thích:</strong></p><ul><li>Dùng tính năng POSIX khi có thể</li><li>Ghi chú các tính năng không tương thích</li><li>Thử trên hệ thống đích</li></ul></li></ol><hr><p><em>Tài liệu này khoảng 700 dòng. Đánh dấu lại và dùng làm tham khảo khi cần.</em></p></div><hr class=awesome-hr><h2 id=see-also>Nội dung liên quan</h2><ul><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li></ul><div class=collection-card><div class="collection-title text-secondary">Trong <a href=/collections/linux-cli/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>Bộ sưu tập・Linux Cli</span></span></a> 11</div><div class=collection-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ class=collection-nav-item rel=prev title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i><span>Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</span>
</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ class=collection-nav-item rel=next title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><span>Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</span><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Cập nhật ngày 2025-12-11 16:05:24">Cập nhật ngày 2025-12-11&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Chia sẻ trên X" data-sharer=twitter data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ data-title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer" data-hashtags="ai generated post"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên Facebook" data-sharer=facebook data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ data-hashtag="ai generated post"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên 微博" data-sharer=weibo data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ data-title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ai-generated-post/ class=post-tag title="Nhãn - Ai Generated Post">Ai Generated Post</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Quay lại</a></span>&nbsp;|&nbsp;<span><a href=/>Trang chủ</a></span></section></div><div class=post-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ class=post-nav-item rel=prev title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ class=post-nav-item rel=next title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label="Nội dung"><h2 class=toc-title>Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><dialog id=toc-dialog aria-labelledby=toc-dialog-title role=dialog><div class=toc><h2 class=toc-title>Nội dung</h2><div class=toc-content id=toc-content-drawer><nav><ul><li><ul><li><a href=#phần-1-regex-trong-linux---lịch-sử-và-các-biến-thể>PHẦN 1: REGEX TRONG LINUX - LỊCH SỬ VÀ CÁC BIẾN THỂ</a><ul><li><a href=#11-tại-sao-regex-linux-lạ-so-với-regex-hiện-đại>1.1 Tại sao regex Linux &ldquo;lạ&rdquo; so với regex hiện đại?</a></li><li><a href=#12-bảng-so-sánh-regex-bre-vs-ere-vs-pcre>1.2 BẢNG SO SÁNH REGEX: BRE vs ERE vs PCRE</a></li><li><a href=#13-ví-dụ-thực-tế-cùng-một-việc-khác-cú-pháp>1.3 Ví dụ thực tế: Cùng một việc, khác cú pháp</a></li><li><a href=#14-lớp-ký-tự-posix-hoạt-động-trong-cả-bre-và-ere>1.4 Lớp Ký Tự POSIX (hoạt động trong cả BRE và ERE)</a></li></ul></li><li><a href=#phần-2-awk-chuyên-sâu>PHẦN 2: AWK CHUYÊN SÂU</a><ul><li><a href=#21-mô-hình-thực-thi---hiểu-để-tối-ưu>2.1 Mô Hình Thực Thi - Hiểu để tối ưu</a></li><li><a href=#22-biến-có-sẵn---cái-hay-của-awk>2.2 Biến Có Sẵn - Cái hay của awk</a></li><li><a href=#23-các-loại-mẫu---khi-nào-dùng-cái-nào>2.3 Các Loại Mẫu - Khi nào dùng cái nào</a></li><li><a href=#24-mảng-kết-hợp---sức-mạnh-thực-sự-của-awk>2.4 Mảng Kết Hợp - Sức mạnh thực sự của awk</a></li><li><a href=#25-hàm-có-sẵn>2.5 Hàm Có Sẵn</a></li><li><a href=#26-luồng-điều-khiển>2.6 Luồng Điều Khiển</a></li><li><a href=#27-hàm-tự-định-nghĩa>2.7 Hàm Tự Định Nghĩa</a></li><li><a href=#28-printf---xuất-có-định-dạng>2.8 Printf - Xuất Có Định Dạng</a></li></ul></li><li><a href=#phần-3-sed-chuyên-sâu>PHẦN 3: SED CHUYÊN SÂU</a><ul><li><a href=#31-mô-hình-thực-thi>3.1 Mô Hình Thực Thi</a></li><li><a href=#32-các-loại-địa-chỉ---chỉ-định-dòng-để-xử-lý>3.2 Các Loại Địa Chỉ - Chỉ định dòng để xử lý</a></li><li><a href=#33-tham-khảo-lệnh>3.3 Tham Khảo Lệnh</a></li><li><a href=#34-nhiều-lệnh>3.4 Nhiều Lệnh</a></li><li><a href=#35-không-gian-giữ---thao-tác-bộ-đệm-nâng-cao>3.5 Không Gian Giữ - Thao Tác Bộ Đệm Nâng Cao</a></li><li><a href=#36-nhánh-và-nhãn-nâng-cao>3.6 Nhánh và Nhãn (Nâng Cao)</a></li><li><a href=#37-chỉnh-sửa-tại-chỗ>3.7 Chỉnh Sửa Tại Chỗ</a></li></ul></li><li><a href=#phần-4-phân-tích-độ-phức-tạp>PHẦN 4: PHÂN TÍCH ĐỘ PHỨC TẠP</a><ul><li><a href=#41-big-o-của-các-thao-tác>4.1 Big-O của các thao tác</a></li><li><a href=#42-cơ-chế-regex-bên-trong---khi-nào-nó-chậm>4.2 Cơ Chế Regex Bên Trong - Khi nào nó chậm</a></li><li><a href=#43-sử-dụng-bộ-nhớ>4.3 Sử Dụng Bộ Nhớ</a></li></ul></li><li><a href=#phần-5-ví-dụ-thực-tế>PHẦN 5: VÍ DỤ THỰC TẾ</a><ul><li><a href=#51-phân-tích-log>5.1 Phân Tích Log</a></li><li><a href=#52-thao-tác-file-cấu-hình>5.2 Thao Tác File Cấu Hình</a></li><li><a href=#53-chuyển-đổi-dữ-liệu>5.3 Chuyển Đổi Dữ Liệu</a></li><li><a href=#54-quản-trị-hệ-thống>5.4 Quản Trị Hệ Thống</a></li><li><a href=#55-đường-ống-xử-lý-văn-bản>5.5 Đường Ống Xử Lý Văn Bản</a></li></ul></li><li><a href=#phần-6-sai-lầm-và-thực-hành-tốt>PHẦN 6: SAI LẦM VÀ THỰC HÀNH TỐT</a><ul><li><a href=#61-những-sai-lầm-cần-tránh>6.1 Những Sai Lầm Cần Tránh</a></li><li><a href=#62-mẹo-hiệu-năng>6.2 Mẹo Hiệu Năng</a></li><li><a href=#63-cân-nhắc-tương-thích>6.3 Cân Nhắc Tương Thích</a></li></ul></li><li><a href=#phần-7-thẻ-tham-khảo-nhanh>PHẦN 7: THẺ THAM KHẢO NHANH</a><ul><li><a href=#71-một-dòng-awk-hay-dùng>7.1 Một Dòng AWK Hay Dùng</a></li><li><a href=#72-một-dòng-sed-hay-dùng>7.2 Một Dòng SED Hay Dùng</a></li></ul></li><li><a href=#kết-luận>KẾT LUẬN</a></li></ul></li></ul></nav></div></div></dialog></main><footer class=footer><div class=footer-container><div class="footer-line powered">Cung cấp bởi <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.0"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Chủ đề - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span></div></div></footer></div><div class=widgets><div class=fixed-buttons><div class="fixed-button back-to-top animate__faster" role=button aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><svg viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="50"/><circle class="progress" cx="50" cy="50" r="50"/></svg></div><div id=toc-drawer-button class="fixed-button toc-drawer-button" role=button aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></div></div><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/instant-page/instantpage.min.js async defer type=module></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>