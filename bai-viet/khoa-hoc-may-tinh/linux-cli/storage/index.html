<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=vi><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu - Kaizen - tốt hơn mỗi ngày</title><meta name=author content="Kaizen Teams"><meta name=description content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta name=keywords content='ai generated post'><meta itemprop=name content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta itemprop=description content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta itemprop=datePublished content="2025-12-11T04:17:23+07:00"><meta itemprop=dateModified content="2025-12-11T16:05:24+07:00"><meta itemprop=wordCount content="9208"><meta itemprop=keywords content="Ai Generated Post"><meta property="og:url" content="https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/"><meta property="og:site_name" content="Kaizen - tốt hơn mỗi ngày"><meta property="og:title" content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta property="og:description" content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta property="og:locale" content="vi"><meta property="og:type" content="article"><meta property="article:section" content="bai-viet"><meta property="article:published_time" content="2025-12-11T04:17:23+07:00"><meta property="article:modified_time" content="2025-12-11T16:05:24+07:00"><meta property="article:tag" content="Ai Generated Post"><meta name=twitter:card content="summary"><meta name=twitter:title content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta name=twitter:description content="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><meta name=application-name content="Kaizen - tốt hơn mỗi ngày"><meta name=apple-mobile-web-app-title content="Kaizen - tốt hơn mỗi ngày"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#2d89ef"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#FF7359><link rel=manifest href=/site.webmanifest><link rel=canonical type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu - Kaizen - tốt hơn mỗi ngày"><link rel=prev type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><link rel=next type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Disk, Storage \u0026 Filesystem - Hướng Dẫn Chuyên Sâu","inLanguage":"vi","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/storage\/"},"image":[{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}],"genre":"posts","keywords":"ai generated post","wordcount":9208,"url":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/storage\/","datePublished":"2025-12-11T04:17:23+07:00","dateModified":"2025-12-11T16:05:24+07:00","publisher":{"@type":"Organization","name":"Kaizen","logo":{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}},"author":{"@type":"Person","name":"Kaizen Teams"},"description":"Disk, Storage \u0026 Filesystem - Hướng Dẫn Chuyên Sâu"}</script><script src=/js/head/color-scheme.min.js></script></head><body data-instant-intensity=viewport data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=32 width=32><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class="menu-item has-children"><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=26 width=26><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Huỷ</a></li><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Bộ sưu tập"><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title="Bộ sưu tập">Linux Cli</span>
<span class=collection-count>10</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li class=collection-item><span class=active title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</span></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu">Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu">Linux Package Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/selinux/ title="Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc">Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc</a></li></ul><div class=collection-nav-simple><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ class=collection-nav-item rel=prev title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>6/10</span><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ class=collection-nav-item rel=next title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li></ul></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://vanvuvuong.github.io title="Tác giả" target=_blank rel="external nofollow noopener noreferrer author" class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Kaizen Teams</a></span><span class=post-included-in>&nbsp;trong <a href=/collections/linux-cli/ class=post-collection title="Bộ sưu tập - Linux Cli"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Linux Cli</a></span></div><div class=post-meta-line><span title="đăng ngày 2025-12-11 04:17:23"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-11>2025-12-11</time></span>&nbsp;<span title="Cập nhật ngày 2025-12-11 16:05:24"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-11>2025-12-11</time></span>&nbsp;<span title="9208 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>Khoảng 9300 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>44 phút</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Nội dung</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#phần-1-nền-tảng-lưu-trữ>PHẦN 1: NỀN TẢNG LƯU TRỮ</a><ul><li><a href=#11-tổng-quan-storage-stack>1.1 Tổng quan Storage Stack</a></li><li><a href=#12-quy-ước-đặt-tên-thiết-bị-khối>1.2 Quy ước đặt tên thiết bị khối</a></li><li><a href=#13-bảng-phân-vùng-mbr-vs-gpt>1.3 Bảng phân vùng: MBR vs GPT</a></li></ul></li><li><a href=#phần-2-lệnh-thông-tin-đĩa>PHẦN 2: LỆNH THÔNG TIN ĐĨA</a><ul><li><a href=#21-lsblk---liệt-kê-thiết-bị-khối>2.1 lsblk - Liệt kê thiết bị khối</a></li><li><a href=#22-blkid---thuộc-tính-thiết-bị-khối>2.2 blkid - Thuộc tính thiết bị khối</a></li><li><a href=#23-df---dung-lượng-đĩa-trống>2.3 df - Dung lượng đĩa trống</a></li><li><a href=#24-du---dung-lượng-đã-dùng>2.4 du - Dung lượng đã dùng</a></li><li><a href=#25-findmnt---tìm-filesystem-đã-mount>2.5 findmnt - Tìm filesystem đã mount</a></li></ul></li><li><a href=#phần-3-phân-vùng>PHẦN 3: PHÂN VÙNG</a><ul><li><a href=#31-fdisk---phân-vùng-mbr>3.1 fdisk - Phân vùng MBR</a></li><li><a href=#32-parted---phân-vùng-hiện-đại-gpt--mbr>3.2 parted - Phân vùng hiện đại (GPT + MBR)</a></li><li><a href=#33-gdisk---fdisk-cho-gpt>3.3 gdisk - fdisk cho GPT</a></li></ul></li><li><a href=#phần-4-hệ-thống-tệp>PHẦN 4: HỆ THỐNG TỆP</a><ul><li><a href=#41-khái-niệm-filesystem>4.1 Khái niệm Filesystem</a></li><li><a href=#42-mkfs---tạo-filesystem>4.2 mkfs - Tạo Filesystem</a></li><li><a href=#43-fsck---kiểm-tra-filesystem>4.3 fsck - Kiểm tra Filesystem</a></li><li><a href=#44-tune2fs---điều-chỉnh-filesystem-ext>4.4 tune2fs - Điều chỉnh Filesystem ext</a></li><li><a href=#45-resize2fs--xfs_growfs---thay-đổi-kích-thước-filesystem>4.5 resize2fs & xfs_growfs - Thay đổi kích thước Filesystem</a></li></ul></li><li><a href=#phần-5-mount--unmount>PHẦN 5: MOUNT & UNMOUNT</a><ul><li><a href=#51-mount---gắn-kết-filesystem>5.1 mount - Gắn kết Filesystem</a></li><li><a href=#52-umount---tháo-gắn-kết-filesystem>5.2 umount - Tháo gắn kết Filesystem</a></li><li><a href=#53-etcfstab---mount-cố-định>5.3 /etc/fstab - Mount cố định</a></li><li><a href=#54-systemd-mount-units>5.4 Systemd Mount Units</a></li></ul></li><li><a href=#phần-6-lvm---logical-volume-manager>PHẦN 6: LVM - LOGICAL VOLUME MANAGER</a><ul><li><a href=#61-khái-niệm-lvm>6.1 Khái niệm LVM</a></li><li><a href=#62-lệnh-physical-volume-pv>6.2 Lệnh Physical Volume (PV)</a></li><li><a href=#63-lệnh-volume-group-vg>6.3 Lệnh Volume Group (VG)</a></li><li><a href=#64-lệnh-logical-volume-lv>6.4 Lệnh Logical Volume (LV)</a></li><li><a href=#65-thao-tác-thay-đổi-kích-thước-lvm>6.5 Thao tác thay đổi kích thước LVM</a></li><li><a href=#66-lvm-snapshot>6.6 LVM Snapshot</a></li><li><a href=#67-lvm-thin-provisioning>6.7 LVM Thin Provisioning</a></li></ul></li><li><a href=#phần-7-quản-lý-swap>PHẦN 7: QUẢN LÝ SWAP</a><ul><li><a href=#71-khái-niệm-swap>7.1 Khái niệm Swap</a></li><li><a href=#72-mkswap-swapon-swapoff>7.2 mkswap, swapon, swapoff</a></li></ul></li><li><a href=#phần-8-giám-sát-io>PHẦN 8: GIÁM SÁT I/O</a><ul><li><a href=#81-iostat---thống-kê-io>8.1 iostat - Thống kê I/O</a></li><li><a href=#82-iotop---io-theo-tiến-trình>8.2 iotop - I/O theo tiến trình</a></li><li><a href=#83-bộ-lập-lịch-io>8.3 Bộ lập lịch I/O</a></li></ul></li><li><a href=#phần-9-hệ-thống-tệp-mạng>PHẦN 9: HỆ THỐNG TỆP MẠNG</a><ul><li><a href=#91-kiến-trúc-nfs>9.1 Kiến trúc NFS</a></li><li><a href=#92-cài-đặt-nfs-server>9.2 Cài đặt NFS Server</a></li><li><a href=#93-nfs-client>9.3 NFS Client</a></li><li><a href=#94-xử-lý-sự-cố-nfs>9.4 Xử lý sự cố NFS</a></li><li><a href=#95-cifssmb---chia-sẻ-windows>9.5 CIFS/SMB - Chia sẻ Windows</a></li></ul></li><li><a href=#phần-10-tiện-ích-đĩa>PHẦN 10: TIỆN ÍCH ĐĨA</a><ul><li><a href=#101-dd---sao-chép-dữ-liệu>10.1 dd - Sao chép dữ liệu</a></li><li><a href=#102-mkisofs---tạo-ảnh-iso>10.2 mkisofs - Tạo ảnh ISO</a></li><li><a href=#103-giám-sát-smart>10.3 Giám sát SMART</a></li><li><a href=#104-fstrim---trim-cho-ssd>10.4 fstrim - TRIM cho SSD</a></li></ul></li><li><a href=#tóm-tắt-nhanh>TÓM TẮT NHANH</a><ul><li><a href=#thông-tin-đĩa>Thông tin đĩa</a></li><li><a href=#phân-vùng>Phân vùng</a></li><li><a href=#filesystem>Filesystem</a></li><li><a href=#mount>Mount</a></li><li><a href=#lvm>LVM</a></li><li><a href=#swap>Swap</a></li><li><a href=#giám-sát-io>Giám sát I/O</a></li><li><a href=#nfs>NFS</a></li><li><a href=#tiện-ích>Tiện ích</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h2 class=heading-element id=phần-1-nền-tảng-lưu-trữ><span>PHẦN 1: NỀN TẢNG LƯU TRỮ</span>
<a href=#ph%e1%ba%a7n-1-n%e1%bb%81n-t%e1%ba%a3ng-l%c6%b0u-tr%e1%bb%af class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=11-tổng-quan-storage-stack><span>1.1 Tổng quan Storage Stack</span>
<a href=#11-t%e1%bb%95ng-quan-storage-stack class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                 NGĂN XẾP LƯU TRỮ LINUX                      │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                      Ứng dụng                               │
</span></span><span class=line><span class=cl>│              (read, write, open, close)                     │
</span></span><span class=line><span class=cl>└───────────────────────┬─────────────────────────────────────┘
</span></span><span class=line><span class=cl>                        │ Lời gọi hệ thống (System calls)
</span></span><span class=line><span class=cl>                        ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│           Hệ thống tệp ảo (Virtual File System - VFS)       │
</span></span><span class=line><span class=cl>│              Lớp trừu tượng cho mọi filesystem              │
</span></span><span class=line><span class=cl>└───────────────────────┬─────────────────────────────────────┘
</span></span><span class=line><span class=cl>                        │
</span></span><span class=line><span class=cl>        ┌───────────────┼───────────────┐
</span></span><span class=line><span class=cl>        ▼               ▼               ▼
</span></span><span class=line><span class=cl>┌─────────────┐ ┌─────────────┐ ┌─────────────┐
</span></span><span class=line><span class=cl>│    ext4     │ │     XFS     │ │    NFS      │
</span></span><span class=line><span class=cl>│ Filesystem  │ │ Filesystem  │ │  (Mạng)     │
</span></span><span class=line><span class=cl>└──────┬──────┘ └──────┬──────┘ └──────┬──────┘
</span></span><span class=line><span class=cl>       │               │               │
</span></span><span class=line><span class=cl>       └───────┬───────┘               │ Mạng
</span></span><span class=line><span class=cl>               │                       │
</span></span><span class=line><span class=cl>               ▼                       ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────┐ ┌─────────────┐
</span></span><span class=line><span class=cl>│        Lớp Block            │ │   NFS       │
</span></span><span class=line><span class=cl>│  (lập lịch I/O, gộp yêu cầu)│ │   Server    │
</span></span><span class=line><span class=cl>└───────────────┬─────────────┘ └─────────────┘
</span></span><span class=line><span class=cl>                │
</span></span><span class=line><span class=cl>                ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│        Device Mapper (LVM, RAID, mã hóa)                    │
</span></span><span class=line><span class=cl>└───────────────────────┬─────────────────────────────────────┘
</span></span><span class=line><span class=cl>                        │
</span></span><span class=line><span class=cl>                        ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   Thiết bị khối                             │
</span></span><span class=line><span class=cl>│              /dev/sda, /dev/nvme0n1, v.v.                   │
</span></span><span class=line><span class=cl>└───────────────────────┬─────────────────────────────────────┘
</span></span><span class=line><span class=cl>                        │
</span></span><span class=line><span class=cl>                        ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│            Lưu trữ vật lý (HDD, SSD, NVMe)                  │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=12-quy-ước-đặt-tên-thiết-bị-khối><span>1.2 Quy ước đặt tên thiết bị khối</span>
<a href=#12-quy-%c6%b0%e1%bb%9bc-%c4%91%e1%ba%b7t-t%c3%aan-thi%e1%ba%bft-b%e1%bb%8b-kh%e1%bb%91i class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│          QUY ƯỚC ĐẶT TÊN THIẾT BỊ KHỐI                      │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Truyền thống (SATA/SAS/SCSI):
</span></span><span class=line><span class=cl>/dev/sda        # Đĩa thứ nhất
</span></span><span class=line><span class=cl>/dev/sdb        # Đĩa thứ hai
</span></span><span class=line><span class=cl>/dev/sda1       # Phân vùng đầu tiên của sda
</span></span><span class=line><span class=cl>/dev/sda2       # Phân vùng thứ hai của sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>NVMe:
</span></span><span class=line><span class=cl>/dev/nvme0n1    # Controller NVMe đầu tiên, namespace đầu tiên
</span></span><span class=line><span class=cl>/dev/nvme0n1p1  # Phân vùng đầu tiên
</span></span><span class=line><span class=cl>/dev/nvme1n1    # Controller NVMe thứ hai
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ảo hóa (VirtIO):
</span></span><span class=line><span class=cl>/dev/vda        # Đĩa virtio đầu tiên
</span></span><span class=line><span class=cl>/dev/vda1       # Phân vùng đầu tiên
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Device Mapper (LVM, RAID):
</span></span><span class=line><span class=cl>/dev/mapper/vg_name-lv_name
</span></span><span class=line><span class=cl>/dev/dm-0, /dev/dm-1...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thẻ MMC/SD:
</span></span><span class=line><span class=cl>/dev/mmcblk0    # Thiết bị MMC đầu tiên
</span></span><span class=line><span class=cl>/dev/mmcblk0p1  # Phân vùng đầu tiên
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thiết bị loop:
</span></span><span class=line><span class=cl>/dev/loop0      # Thiết bị loop đầu tiên (mount ISO, images)</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=13-bảng-phân-vùng-mbr-vs-gpt><span>1.3 Bảng phân vùng: MBR vs GPT</span>
<a href=#13-b%e1%ba%a3ng-ph%c3%a2n-v%c3%b9ng-mbr-vs-gpt class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    MBR vs GPT                               │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>MBR (Master Boot Record) - Cũ:
</span></span><span class=line><span class=cl>┌────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Sector 0 (512 bytes)                                       │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Mã bootstrap (446 bytes)                                   │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Bảng phân vùng (64 bytes = 4 × 16 bytes)                   │
</span></span><span class=line><span class=cl>│ ┌──────────┬──────────┬──────────┬──────────┐              │
</span></span><span class=line><span class=cl>│ │ Phân vùng│ Phân vùng│ Phân vùng│ Phân vùng│              │
</span></span><span class=line><span class=cl>│ │    1     │    2     │    3     │    4     │              │
</span></span><span class=line><span class=cl>│ └──────────┴──────────┴──────────┴──────────┘              │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ Chữ ký boot (2 bytes: 0x55AA)                              │
</span></span><span class=line><span class=cl>└────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Hạn chế:
</span></span><span class=line><span class=cl>- Tối đa 4 phân vùng chính (hoặc 3 chính + 1 mở rộng)
</span></span><span class=line><span class=cl>- Kích thước đĩa tối đa: 2TB (2^32 × 512 bytes)
</span></span><span class=line><span class=cl>- Không có dự phòng
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>GPT (GUID Partition Table) - Hiện đại:
</span></span><span class=line><span class=cl>┌────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ LBA 0: MBR bảo vệ (tương thích ngược)                      │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ LBA 1: Header GPT chính                                    │
</span></span><span class=line><span class=cl>│   - GUID đĩa                                               │
</span></span><span class=line><span class=cl>│   - Vị trí mục nhập phân vùng                              │
</span></span><span class=line><span class=cl>│   - Checksum CRC32                                         │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ LBA 2-33: Mục nhập phân vùng (128 mục × 128 bytes)         │
</span></span><span class=line><span class=cl>│   - GUID loại phân vùng                                    │
</span></span><span class=line><span class=cl>│   - GUID duy nhất phân vùng                                │
</span></span><span class=line><span class=cl>│   - LBA đầu/cuối                                           │
</span></span><span class=line><span class=cl>│   - Thuộc tính, Tên                                        │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ LBA 34 - (N-34): Các phân vùng thực tế                     │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ LBA (N-33) - (N-1): Mục nhập phân vùng dự phòng            │
</span></span><span class=line><span class=cl>├────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│ LBA N: Header GPT dự phòng                                 │
</span></span><span class=line><span class=cl>└────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ưu điểm:
</span></span><span class=line><span class=cl>- Tối đa 128 phân vùng (mặc định)
</span></span><span class=line><span class=cl>- Kích thước đĩa tối đa: 9.4 ZB (2^64 × 512 bytes)
</span></span><span class=line><span class=cl>- Dự phòng (header + mục nhập dự phòng)
</span></span><span class=line><span class=cl>- Checksum CRC32
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──────────────┬─────────────────────┬─────────────────────┐
</span></span><span class=line><span class=cl>│ Đặc điểm     │ MBR                 │ GPT                 │
</span></span><span class=line><span class=cl>├──────────────┼─────────────────────┼─────────────────────┤
</span></span><span class=line><span class=cl>│ Kích thước   │ 2 TB                │ 9.4 ZB              │
</span></span><span class=line><span class=cl>│ tối đa       │                     │                     │
</span></span><span class=line><span class=cl>│ Phân vùng    │ 4 chính             │ 128 mặc định        │
</span></span><span class=line><span class=cl>│ Chế độ boot  │ BIOS                │ UEFI (hoặc BIOS)    │
</span></span><span class=line><span class=cl>│ Dự phòng     │ Không               │ Backup ở cuối       │
</span></span><span class=line><span class=cl>│ Checksum     │ Không               │ CRC32               │
</span></span><span class=line><span class=cl>│ Công cụ      │ fdisk               │ gdisk, parted       │
</span></span><span class=line><span class=cl>└──────────────┴─────────────────────┴─────────────────────┘</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-2-lệnh-thông-tin-đĩa><span>PHẦN 2: LỆNH THÔNG TIN ĐĨA</span>
<a href=#ph%e1%ba%a7n-2-l%e1%bb%87nh-th%c3%b4ng-tin-%c4%91%c4%a9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=21-lsblk---liệt-kê-thiết-bị-khối><span>2.1 lsblk - Liệt kê thiết bị khối</span>
<a href=#21-lsblk---li%e1%bb%87t-k%c3%aa-thi%e1%ba%bft-b%e1%bb%8b-kh%e1%bb%91i class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># lsblk = Liệt kê thiết bị khối dạng cây</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>lsblk
</span></span><span class=line><span class=cl><span class=c1># NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINT</span>
</span></span><span class=line><span class=cl><span class=c1># sda      8:0    0   500G  0 disk</span>
</span></span><span class=line><span class=cl><span class=c1># ├─sda1   8:1    0   512M  0 part /boot/efi</span>
</span></span><span class=line><span class=cl><span class=c1># ├─sda2   8:2    0     1G  0 part /boot</span>
</span></span><span class=line><span class=cl><span class=c1># └─sda3   8:3    0 498.5G  0 part</span>
</span></span><span class=line><span class=cl><span class=c1>#   ├─vg_root-lv_root  253:0  0   50G  0 lvm  /</span>
</span></span><span class=line><span class=cl><span class=c1>#   ├─vg_root-lv_swap  253:1  0    8G  0 lvm  [SWAP]</span>
</span></span><span class=line><span class=cl><span class=c1>#   └─vg_root-lv_home  253:2  0  440G  0 lvm  /home</span>
</span></span><span class=line><span class=cl><span class=c1># nvme0n1  259:0  0   1TB   0 disk</span>
</span></span><span class=line><span class=cl><span class=c1># └─nvme0n1p1 259:1 0   1TB  0 part /data</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải thích cột:</span>
</span></span><span class=line><span class=cl><span class=c1># NAME:       Tên thiết bị</span>
</span></span><span class=line><span class=cl><span class=c1># MAJ:MIN:    Số thiết bị Major:Minor</span>
</span></span><span class=line><span class=cl><span class=c1># RM:         Tháo rời được (1=có, 0=không)</span>
</span></span><span class=line><span class=cl><span class=c1># SIZE:       Kích thước</span>
</span></span><span class=line><span class=cl><span class=c1># RO:         Chỉ đọc</span>
</span></span><span class=line><span class=cl><span class=c1># TYPE:       disk, part, lvm, raid, crypt...</span>
</span></span><span class=line><span class=cl><span class=c1># MOUNTPOINT: Điểm mount</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn hay dùng</span>
</span></span><span class=line><span class=cl>lsblk -f                    <span class=c1># Thông tin filesystem (loại, nhãn, UUID)</span>
</span></span><span class=line><span class=cl>lsblk -o NAME,SIZE,TYPE,FSTYPE,MOUNTPOINT,UUID
</span></span><span class=line><span class=cl>lsblk -d                    <span class=c1># Chỉ hiện đĩa (không hiện phân vùng)</span>
</span></span><span class=line><span class=cl>lsblk -p                    <span class=c1># Đường dẫn đầy đủ (/dev/sda thay vì sda)</span>
</span></span><span class=line><span class=cl>lsblk -J                    <span class=c1># Xuất JSON</span>
</span></span><span class=line><span class=cl>lsblk -b                    <span class=c1># Kích thước theo bytes</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất với -f:</span>
</span></span><span class=line><span class=cl><span class=c1># NAME   FSTYPE LABEL UUID                                 MOUNTPOINT</span>
</span></span><span class=line><span class=cl><span class=c1># sda</span>
</span></span><span class=line><span class=cl><span class=c1># ├─sda1 vfat   EFI   1234-5678                            /boot/efi</span>
</span></span><span class=line><span class=cl><span class=c1># ├─sda2 ext4   boot  abcd-efgh-ijkl-mnop                  /boot</span>
</span></span><span class=line><span class=cl><span class=c1># └─sda3 LVM2_m       xxxx-yyyy-zzzz</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=22-blkid---thuộc-tính-thiết-bị-khối><span>2.2 blkid - Thuộc tính thiết bị khối</span>
<a href=#22-blkid---thu%e1%bb%99c-t%c3%adnh-thi%e1%ba%bft-b%e1%bb%8b-kh%e1%bb%91i class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># blkid = Định vị/in thuộc tính thiết bị khối</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>blkid
</span></span><span class=line><span class=cl><span class=c1># /dev/sda1: UUID=&#34;1234-5678&#34; TYPE=&#34;vfat&#34; PARTLABEL=&#34;EFI&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sda2: UUID=&#34;abcd-efgh&#34; TYPE=&#34;ext4&#34; LABEL=&#34;boot&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sda3: UUID=&#34;xxxx-yyyy&#34; TYPE=&#34;LVM2_member&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/mapper/vg-lv_root: UUID=&#34;root-uuid&#34; TYPE=&#34;ext4&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thiết bị cụ thể</span>
</span></span><span class=line><span class=cl>blkid /dev/sda1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lấy thuộc tính cụ thể</span>
</span></span><span class=line><span class=cl>blkid -s UUID /dev/sda1
</span></span><span class=line><span class=cl>blkid -s TYPE /dev/sda1
</span></span><span class=line><span class=cl>blkid -s LABEL /dev/sda1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Định dạng xuất</span>
</span></span><span class=line><span class=cl>blkid -o value -s UUID /dev/sda1    <span class=c1># Chỉ giá trị UUID</span>
</span></span><span class=line><span class=cl>blkid -o <span class=nb>export</span> /dev/sda1            <span class=c1># Định dạng export</span>
</span></span><span class=line><span class=cl>blkid -o full                        <span class=c1># Xuất đầy đủ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Probe (buộc đọc lại, không dùng cache)</span>
</span></span><span class=line><span class=cl>blkid -p /dev/sda1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê tất cả UUID đã biết (từ cache)</span>
</span></span><span class=line><span class=cl>blkid -c /dev/null                   <span class=c1># Bỏ qua cache</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=23-df---dung-lượng-đĩa-trống><span>2.3 df - Dung lượng đĩa trống</span>
<a href=#23-df---dung-l%c6%b0%e1%bb%a3ng-%c4%91%c4%a9a-tr%e1%bb%91ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># df = Báo cáo dung lượng filesystem đã dùng</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>df
</span></span><span class=line><span class=cl><span class=c1># Filesystem     1K-blocks    Used Available Use% Mounted on</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sda2       51475068 8234567  40612345  17% /</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sda1         523248   34567    488681   7% /boot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>df -h                       <span class=c1># Dễ đọc (K, M, G, T)</span>
</span></span><span class=line><span class=cl>df -H                       <span class=c1># Đơn vị SI (1000 thay vì 1024)</span>
</span></span><span class=line><span class=cl>df -T                       <span class=c1># Hiện loại filesystem</span>
</span></span><span class=line><span class=cl>df -i                       <span class=c1># Dùng inode (thay vì block)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Filesystem/mount cụ thể</span>
</span></span><span class=line><span class=cl>df /home
</span></span><span class=line><span class=cl>df -h /dev/sda1
</span></span><span class=line><span class=cl>df -h .                     <span class=c1># Filesystem của thư mục hiện tại</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lọc</span>
</span></span><span class=line><span class=cl>df -t ext4                  <span class=c1># Chỉ ext4</span>
</span></span><span class=line><span class=cl>df -x tmpfs                 <span class=c1># Loại trừ tmpfs</span>
</span></span><span class=line><span class=cl>df -x squashfs -x tmpfs     <span class=c1># Loại trừ nhiều loại</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Định dạng xuất</span>
</span></span><span class=line><span class=cl>df -h --output<span class=o>=</span>source,size,used,avail,pcent,target
</span></span><span class=line><span class=cl><span class=c1># Cột: source, fstype, itotal, iused, iavail, ipcent, size, used, avail, pcent, file, target</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Inode quan trọng:</span>
</span></span><span class=line><span class=cl><span class=c1># Filesystem có thể hết inode trước khi hết dung lượng</span>
</span></span><span class=line><span class=cl><span class=c1># (nhiều file nhỏ)</span>
</span></span><span class=line><span class=cl>df -i
</span></span><span class=line><span class=cl><span class=c1># Filesystem     Inodes   IUsed  IFree IUse% Mounted on</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sda2     3276800  234567 3042233    8% /</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=24-du---dung-lượng-đã-dùng><span>2.4 du - Dung lượng đã dùng</span>
<a href=#24-du---dung-l%c6%b0%e1%bb%a3ng-%c4%91%c3%a3-d%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># du = Ước tính dung lượng file/thư mục</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>du                          <span class=c1># Thư mục hiện tại, đệ quy</span>
</span></span><span class=line><span class=cl>du /var/log                 <span class=c1># Thư mục cụ thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>du -h                       <span class=c1># Dễ đọc</span>
</span></span><span class=line><span class=cl>du -s                       <span class=c1># Tóm tắt (chỉ tổng)</span>
</span></span><span class=line><span class=cl>du -sh /var/log             <span class=c1># Tóm tắt + dễ đọc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>du -sh *                    <span class=c1># Kích thước mỗi mục trong thư mục hiện tại</span>
</span></span><span class=line><span class=cl>du -sh * <span class=p>|</span> sort -h          <span class=c1># Sắp xếp theo kích thước</span>
</span></span><span class=line><span class=cl>du -sh * <span class=p>|</span> sort -hr <span class=p>|</span> head  <span class=c1># Top lớn nhất</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm soát độ sâu</span>
</span></span><span class=line><span class=cl>du -d <span class=m>1</span>                     <span class=c1># Độ sâu tối đa 1</span>
</span></span><span class=line><span class=cl>du --max-depth<span class=o>=</span><span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kích thước biểu kiến vs dung lượng đĩa</span>
</span></span><span class=line><span class=cl>du -h file                  <span class=c1># Dung lượng đĩa (blocks thực tế)</span>
</span></span><span class=line><span class=cl>du -h --apparent-size file  <span class=c1># Kích thước biểu kiến (kích thước file)</span>
</span></span><span class=line><span class=cl><span class=c1># File thưa: biểu kiến &gt; đĩa</span>
</span></span><span class=line><span class=cl><span class=c1># File có lỗ hổng: biểu kiến &gt; đĩa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Loại trừ pattern</span>
</span></span><span class=line><span class=cl>du -sh --exclude<span class=o>=</span><span class=s1>&#39;*.log&#39;</span> /var
</span></span><span class=line><span class=cl>du -sh --exclude-from<span class=o>=</span>excludes.txt /var
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Theo symlink</span>
</span></span><span class=line><span class=cl>du -shL /var/log
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ filesystem cụ thể (không vượt qua điểm mount)</span>
</span></span><span class=line><span class=cl>du -shx /                   <span class=c1># Chỉ filesystem root</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sắp xếp theo kích thước (pattern phổ biến)</span>
</span></span><span class=line><span class=cl>du -sh /var/* 2&gt;/dev/null <span class=p>|</span> sort -hr <span class=p>|</span> head -10
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm thư mục lớn</span>
</span></span><span class=line><span class=cl>du -h /var <span class=p>|</span> sort -hr <span class=p>|</span> head -20</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=25-findmnt---tìm-filesystem-đã-mount><span>2.5 findmnt - Tìm filesystem đã mount</span>
<a href=#25-findmnt---t%c3%acm-filesystem-%c4%91%c3%a3-mount class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># findmnt = Tìm filesystem đã mount (dạng cây)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>findmnt
</span></span><span class=line><span class=cl><span class=c1># TARGET                       SOURCE     FSTYPE  OPTIONS</span>
</span></span><span class=line><span class=cl><span class=c1># /                            /dev/sda2  ext4    rw,relatime</span>
</span></span><span class=line><span class=cl><span class=c1># ├─/boot                      /dev/sda1  ext4    rw,relatime</span>
</span></span><span class=line><span class=cl><span class=c1># ├─/home                      /dev/sda3  ext4    rw,relatime</span>
</span></span><span class=line><span class=cl><span class=c1># ├─/proc                      proc       proc    rw,nosuid,nodev</span>
</span></span><span class=line><span class=cl><span class=c1># │ └─/proc/sys/fs/binfmt_misc systemd-1  autofs  rw,relatime</span>
</span></span><span class=line><span class=cl><span class=c1># ├─/sys                       sysfs      sysfs   rw,nosuid,nodev</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>findmnt -l                  <span class=c1># Định dạng danh sách (không cây)</span>
</span></span><span class=line><span class=cl>findmnt -D                  <span class=c1># Xuất kiểu df</span>
</span></span><span class=line><span class=cl>findmnt -t ext4             <span class=c1># Lọc theo loại filesystem</span>
</span></span><span class=line><span class=cl>findmnt -t ext4,xfs         <span class=c1># Nhiều loại</span>
</span></span><span class=line><span class=cl>findmnt -S /dev/sda1        <span class=c1># Theo thiết bị nguồn</span>
</span></span><span class=line><span class=cl>findmnt -T /home/user       <span class=c1># Theo đường dẫn đích</span>
</span></span><span class=line><span class=cl>findmnt -o TARGET,SOURCE,FSTYPE,SIZE,USED,AVAIL,USE%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra đường dẫn có phải điểm mount không</span>
</span></span><span class=line><span class=cl>findmnt /home <span class=o>&amp;&amp;</span> <span class=nb>echo</span> <span class=s2>&#34;Là điểm mount&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất JSON</span>
</span></span><span class=line><span class=cl>findmnt -J
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ filesystem thực (loại trừ ảo)</span>
</span></span><span class=line><span class=cl>findmnt -t notmpfs,nosysfs,noproc,nodevtmpfs</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-3-phân-vùng><span>PHẦN 3: PHÂN VÙNG</span>
<a href=#ph%e1%ba%a7n-3-ph%c3%a2n-v%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=31-fdisk---phân-vùng-mbr><span>3.1 fdisk - Phân vùng MBR</span>
<a href=#31-fdisk---ph%c3%a2n-v%c3%b9ng-mbr class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># fdisk = Công cụ thao tác bảng phân vùng (chủ yếu MBR)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê phân vùng</span>
</span></span><span class=line><span class=cl>fdisk -l                    <span class=c1># Tất cả đĩa</span>
</span></span><span class=line><span class=cl>fdisk -l /dev/sda           <span class=c1># Đĩa cụ thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chế độ tương tác</span>
</span></span><span class=line><span class=cl>fdisk /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lệnh fdisk:</span>
</span></span><span class=line><span class=cl><span class=c1># m     In menu trợ giúp</span>
</span></span><span class=line><span class=cl><span class=c1># p     In bảng phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># n     Thêm phân vùng mới</span>
</span></span><span class=line><span class=cl><span class=c1># d     Xóa phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># t     Đổi loại phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># l     Liệt kê loại phân vùng đã biết</span>
</span></span><span class=line><span class=cl><span class=c1># w     Ghi thay đổi và thoát</span>
</span></span><span class=line><span class=cl><span class=c1># q     Thoát không lưu</span>
</span></span><span class=line><span class=cl><span class=c1># g     Tạo bảng phân vùng GPT mới</span>
</span></span><span class=line><span class=cl><span class=c1># o     Tạo bảng phân vùng MBR mới</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ tạo phân vùng:</span>
</span></span><span class=line><span class=cl><span class=c1># Command (m for help): n</span>
</span></span><span class=line><span class=cl><span class=c1># Partition type:</span>
</span></span><span class=line><span class=cl><span class=c1>#    p   primary (0 primary, 0 extended, 4 free)</span>
</span></span><span class=line><span class=cl><span class=c1>#    e   extended</span>
</span></span><span class=line><span class=cl><span class=c1># Select (default p): p</span>
</span></span><span class=line><span class=cl><span class=c1># Partition number (1-4, default 1): 1</span>
</span></span><span class=line><span class=cl><span class=c1># First sector (2048-xxx, default 2048): &lt;Enter&gt;</span>
</span></span><span class=line><span class=cl><span class=c1># Last sector, +sectors or +size{K,M,G,T,P}: +100G</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Command (m for help): t</span>
</span></span><span class=line><span class=cl><span class=c1># Partition number (1, default 1): 1</span>
</span></span><span class=line><span class=cl><span class=c1># Hex code (type L to list): 83    # Filesystem Linux</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Command (m for help): w</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Không tương tác (script)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> -e <span class=s2>&#34;n\np\n1\n\n+100G\nw&#34;</span> <span class=p>|</span> fdisk /dev/sdb
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hoặc dùng sfdisk (có thể script)</span>
</span></span><span class=line><span class=cl>sfdisk /dev/sdb <span class=s>&lt;&lt; EOF
</span></span></span><span class=line><span class=cl><span class=s>label: gpt
</span></span></span><span class=line><span class=cl><span class=s>size=100G, type=linux
</span></span></span><span class=line><span class=cl><span class=s>size=50G, type=linux
</span></span></span><span class=line><span class=cl><span class=s>type=linux
</span></span></span><span class=line><span class=cl><span class=s>EOF</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=32-parted---phân-vùng-hiện-đại-gpt--mbr><span>3.2 parted - Phân vùng hiện đại (GPT + MBR)</span>
<a href=#32-parted---ph%c3%a2n-v%c3%b9ng-hi%e1%bb%87n-%c4%91%e1%ba%a1i-gpt--mbr class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># parted = GNU Parted (hỗ trợ GPT gốc)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê phân vùng</span>
</span></span><span class=line><span class=cl>parted -l                   <span class=c1># Tất cả đĩa</span>
</span></span><span class=line><span class=cl>parted /dev/sda print       <span class=c1># Đĩa cụ thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chế độ tương tác</span>
</span></span><span class=line><span class=cl>parted /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lệnh parted:</span>
</span></span><span class=line><span class=cl><span class=c1># help              Hiện trợ giúp</span>
</span></span><span class=line><span class=cl><span class=c1># print             In bảng phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># print free        Hiện dung lượng trống</span>
</span></span><span class=line><span class=cl><span class=c1># mklabel gpt       Tạo bảng phân vùng GPT</span>
</span></span><span class=line><span class=cl><span class=c1># mklabel msdos     Tạo bảng phân vùng MBR</span>
</span></span><span class=line><span class=cl><span class=c1># mkpart            Tạo phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># rm NUMBER         Xóa phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># resizepart        Thay đổi kích thước phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># name NUMBER NAME  Đặt tên phân vùng (chỉ GPT)</span>
</span></span><span class=line><span class=cl><span class=c1># set NUMBER FLAG   Đặt cờ (boot, lvm, raid...)</span>
</span></span><span class=line><span class=cl><span class=c1># quit              Thoát</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ tạo GPT + phân vùng:</span>
</span></span><span class=line><span class=cl>parted /dev/sdb
</span></span><span class=line><span class=cl><span class=o>(</span>parted<span class=o>)</span> mklabel gpt
</span></span><span class=line><span class=cl><span class=o>(</span>parted<span class=o>)</span> mkpart primary ext4 0% 100G
</span></span><span class=line><span class=cl><span class=o>(</span>parted<span class=o>)</span> mkpart primary ext4 100G 200G
</span></span><span class=line><span class=cl><span class=o>(</span>parted<span class=o>)</span> mkpart primary ext4 200G 100%
</span></span><span class=line><span class=cl><span class=o>(</span>parted<span class=o>)</span> print
</span></span><span class=line><span class=cl><span class=o>(</span>parted<span class=o>)</span> quit
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Không tương tác</span>
</span></span><span class=line><span class=cl>parted -s /dev/sdb mklabel gpt
</span></span><span class=line><span class=cl>parted -s /dev/sdb mkpart primary ext4 0% 100G
</span></span><span class=line><span class=cl>parted -s /dev/sdb mkpart primary ext4 100G 100%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Căn chỉnh (quan trọng cho SSD/Advanced Format)</span>
</span></span><span class=line><span class=cl>parted -a optimal /dev/sdb mkpart primary ext4 0% 100%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt cờ</span>
</span></span><span class=line><span class=cl>parted /dev/sdb <span class=nb>set</span> <span class=m>1</span> boot on
</span></span><span class=line><span class=cl>parted /dev/sdb <span class=nb>set</span> <span class=m>2</span> lvm on</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=33-gdisk---fdisk-cho-gpt><span>3.3 gdisk - fdisk cho GPT</span>
<a href=#33-gdisk---fdisk-cho-gpt class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># gdisk = fdisk chuyên cho GPT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gdisk -l /dev/sda           <span class=c1># Liệt kê phân vùng GPT</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chế độ tương tác</span>
</span></span><span class=line><span class=cl>gdisk /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lệnh gdisk (tương tự fdisk):</span>
</span></span><span class=line><span class=cl><span class=c1># ?     Trợ giúp</span>
</span></span><span class=line><span class=cl><span class=c1># p     In bảng phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># n     Phân vùng mới</span>
</span></span><span class=line><span class=cl><span class=c1># d     Xóa phân vùng</span>
</span></span><span class=line><span class=cl><span class=c1># t     Đổi loại</span>
</span></span><span class=line><span class=cl><span class=c1># c     Đổi tên</span>
</span></span><span class=line><span class=cl><span class=c1># i     Hiện thông tin chi tiết</span>
</span></span><span class=line><span class=cl><span class=c1># o     Tạo GPT mới</span>
</span></span><span class=line><span class=cl><span class=c1># w     Ghi và thoát</span>
</span></span><span class=line><span class=cl><span class=c1># q     Thoát</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển MBR sang GPT</span>
</span></span><span class=line><span class=cl>gdisk /dev/sdb
</span></span><span class=line><span class=cl><span class=c1># Gdisk sẽ tự phát hiện MBR và hỏi chuyển đổi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sao lưu/phục hồi GPT</span>
</span></span><span class=line><span class=cl>sgdisk -b backup.gpt /dev/sda       <span class=c1># Sao lưu</span>
</span></span><span class=line><span class=cl>sgdisk -l backup.gpt /dev/sda       <span class=c1># Phục hồi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sao chép bảng phân vùng</span>
</span></span><span class=line><span class=cl>sgdisk -R /dev/sdb /dev/sda         <span class=c1># Sao chép sda sang sdb</span>
</span></span><span class=line><span class=cl>sgdisk -G /dev/sdb                  <span class=c1># Tạo GUID mới sau khi sao chép</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-4-hệ-thống-tệp><span>PHẦN 4: HỆ THỐNG TỆP</span>
<a href=#ph%e1%ba%a7n-4-h%e1%bb%87-th%e1%bb%91ng-t%e1%bb%87p class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=41-khái-niệm-filesystem><span>4.1 Khái niệm Filesystem</span>
<a href=#41-kh%c3%a1i-ni%e1%bb%87m-filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              CẤU TRÚC BÊN TRONG FILESYSTEM                  │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Cấu trúc ext4:
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Block khởi│ Nhóm Block 0 │ Nhóm Block 1 │ ... │ Nhóm N     │
</span></span><span class=line><span class=cl>│ động      │              │              │     │            │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>              │
</span></span><span class=line><span class=cl>              ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Cấu trúc Nhóm Block:                                        │
</span></span><span class=line><span class=cl>│ ┌───────────┬───────────┬───────────┬───────────┬─────────┐ │
</span></span><span class=line><span class=cl>│ │  Super    │  Mô tả    │  Bitmap   │  Bitmap   │  Bảng   │ │
</span></span><span class=line><span class=cl>│ │  Block    │  Nhóm     │  Block    │  Inode    │  Inode  │ │
</span></span><span class=line><span class=cl>│ │  (bản sao)│           │           │           │         │ │
</span></span><span class=line><span class=cl>│ ├───────────┴───────────┴───────────┴───────────┴─────────┤ │
</span></span><span class=line><span class=cl>│ │                    Các Block Dữ Liệu                    │ │
</span></span><span class=line><span class=cl>│ └─────────────────────────────────────────────────────────┘ │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Inode (Index Node - Nút chỉ mục):
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Cấu trúc Inode:                                             │
</span></span><span class=line><span class=cl>│ - Loại file (thường, thư mục, symlink...)                   │
</span></span><span class=line><span class=cl>│ - Quyền truy cập (rwxrwxrwx)                                │
</span></span><span class=line><span class=cl>│ - UID/GID chủ sở hữu                                        │
</span></span><span class=line><span class=cl>│ - Kích thước                                                │
</span></span><span class=line><span class=cl>│ - Dấu thời gian (atime, mtime, ctime)                       │
</span></span><span class=line><span class=cl>│ - Số liên kết                                               │
</span></span><span class=line><span class=cl>│ - Con trỏ block:                                            │
</span></span><span class=line><span class=cl>│   - 12 block trực tiếp                                      │
</span></span><span class=line><span class=cl>│   - 1 block gián tiếp                                       │
</span></span><span class=line><span class=cl>│   - 1 block gián tiếp kép                                   │
</span></span><span class=line><span class=cl>│   - 1 block gián tiếp ba                                    │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ ext4 dùng EXTENT thay vì con trỏ block:                     │
</span></span><span class=line><span class=cl>│ Extent = (block_bắt_đầu, độ_dài) - hiệu quả hơn             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thuật toán cấp phát Block:
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ BITMAP: Mỗi bit = 1 block (0=trống, 1=đã dùng)              │
</span></span><span class=line><span class=cl>│ ┌─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┬─┐                           │
</span></span><span class=line><span class=cl>│ │1│1│0│0│1│1│1│0│0│0│1│1│0│0│0│0│                           │
</span></span><span class=line><span class=cl>│ └─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┴─┘                           │
</span></span><span class=line><span class=cl>│  Đã dùng Trống  Đã dùng  Trống  Đã dùng  Trống              │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ Tìm block trống: Quét bitmap - O(n/kích_thước_từ)           │
</span></span><span class=line><span class=cl>│ Tối ưu ext4: Nhóm block + tiền cấp phát                     │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ DỰA TRÊN EXTENT (ext4, XFS, Btrfs):                         │
</span></span><span class=line><span class=cl>│ File: [(block 100, dài 50), (block 500, dài 30)]            │
</span></span><span class=line><span class=cl>│ → Hiệu quả cho file lớn, I/O tuần tự                        │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>XFS dùng B+ Trees:
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│            ┌───────────────┐                                │
</span></span><span class=line><span class=cl>│            │   Nút gốc     │                                │
</span></span><span class=line><span class=cl>│            │ [10|20|30|40] │                                │
</span></span><span class=line><span class=cl>│            └───────┬───────┘                                │
</span></span><span class=line><span class=cl>│         ┌─────────┬┴┬─────────┐                             │
</span></span><span class=line><span class=cl>│         ▼         ▼ ▼         ▼                             │
</span></span><span class=line><span class=cl>│    ┌─────────┐ ┌─────┐ ┌─────────┐                          │
</span></span><span class=line><span class=cl>│    │ &lt;10     │ │10-20│ │  &gt;40    │                          │
</span></span><span class=line><span class=cl>│    │ Extents │ │     │ │ Extents │                          │
</span></span><span class=line><span class=cl>│    └─────────┘ └─────┘ └─────────┘                          │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ B+ Tree: Tra cứu, thêm, xóa O(log n)                        │
</span></span><span class=line><span class=cl>│ Mở rộng tốt với filesystem lớn                              │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=42-mkfs---tạo-filesystem><span>4.2 mkfs - Tạo Filesystem</span>
<a href=#42-mkfs---t%e1%ba%a1o-filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># mkfs.* = Tạo filesystem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ext4 (mặc định cho Linux)</span>
</span></span><span class=line><span class=cl>mkfs.ext4 /dev/sdb1
</span></span><span class=line><span class=cl>mkfs -t ext4 /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn</span>
</span></span><span class=line><span class=cl>mkfs.ext4 -L <span class=s2>&#34;data&#34;</span> /dev/sdb1           <span class=c1># Đặt nhãn</span>
</span></span><span class=line><span class=cl>mkfs.ext4 -U random /dev/sdb1           <span class=c1># Tạo UUID</span>
</span></span><span class=line><span class=cl>mkfs.ext4 -m <span class=m>1</span> /dev/sdb1                <span class=c1># Dành 1% cho root (mặc định 5%)</span>
</span></span><span class=line><span class=cl>mkfs.ext4 -N <span class=m>1000000</span> /dev/sdb1          <span class=c1># Số lượng inode</span>
</span></span><span class=line><span class=cl>mkfs.ext4 -b <span class=m>4096</span> /dev/sdb1             <span class=c1># Kích thước block (mặc định 4096)</span>
</span></span><span class=line><span class=cl>mkfs.ext4 -E <span class=nv>lazy_itable_init</span><span class=o>=</span><span class=m>0</span> /dev/sdb1   <span class=c1># Khởi tạo inode đầy đủ (chậm hơn nhưng an toàn hơn)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># XFS (mặc định cho RHEL 7+, tốt cho file lớn)</span>
</span></span><span class=line><span class=cl>mkfs.xfs /dev/sdb1
</span></span><span class=line><span class=cl>mkfs.xfs -L <span class=s2>&#34;data&#34;</span> /dev/sdb1
</span></span><span class=line><span class=cl>mkfs.xfs -f /dev/sdb1                   <span class=c1># Buộc (ghi đè hiện có)</span>
</span></span><span class=line><span class=cl>mkfs.xfs -b <span class=nv>size</span><span class=o>=</span><span class=m>4096</span> /dev/sdb1         <span class=c1># Kích thước block</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Btrfs (copy-on-write, snapshot)</span>
</span></span><span class=line><span class=cl>mkfs.btrfs /dev/sdb1
</span></span><span class=line><span class=cl>mkfs.btrfs -L <span class=s2>&#34;data&#34;</span> /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># FAT32 (cho USB, EFI)</span>
</span></span><span class=line><span class=cl>mkfs.vfat -F <span class=m>32</span> /dev/sdb1
</span></span><span class=line><span class=cl>mkfs.vfat -n <span class=s2>&#34;USB&#34;</span> /dev/sdb1            <span class=c1># Nhãn (tối đa 11 ký tự, viết hoa)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NTFS (tương thích Windows)</span>
</span></span><span class=line><span class=cl>mkfs.ntfs -f /dev/sdb1                  <span class=c1># Format nhanh</span>
</span></span><span class=line><span class=cl>mkfs.ntfs -L <span class=s2>&#34;Data&#34;</span> /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># exFAT (file lớn trên USB)</span>
</span></span><span class=line><span class=cl>mkfs.exfat -n <span class=s2>&#34;BACKUP&#34;</span> /dev/sdb1</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=43-fsck---kiểm-tra-filesystem><span>4.3 fsck - Kiểm tra Filesystem</span>
<a href=#43-fsck---ki%e1%bb%83m-tra-filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># fsck = Kiểm tra và sửa filesystem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># QUAN TRỌNG: UNMOUNT trước khi fsck!</span>
</span></span><span class=line><span class=cl>umount /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>fsck /dev/sdb1              <span class=c1># Tự phát hiện loại filesystem</span>
</span></span><span class=line><span class=cl>fsck -t ext4 /dev/sdb1      <span class=c1># Chỉ định loại</span>
</span></span><span class=line><span class=cl>fsck.ext4 /dev/sdb1         <span class=c1># Gọi trực tiếp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn</span>
</span></span><span class=line><span class=cl>fsck -n /dev/sdb1           <span class=c1># Không thay đổi (kiểm tra chỉ đọc)</span>
</span></span><span class=line><span class=cl>fsck -y /dev/sdb1           <span class=c1># Đồng ý tất cả sửa chữa</span>
</span></span><span class=line><span class=cl>fsck -a /dev/sdb1           <span class=c1># Tự động sửa (lỗi nhỏ)</span>
</span></span><span class=line><span class=cl>fsck -f /dev/sdb1           <span class=c1># Buộc kiểm tra (ngay cả khi sạch)</span>
</span></span><span class=line><span class=cl>fsck -p /dev/sdb1           <span class=c1># Chế độ preen (tự sửa lỗi an toàn)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra XFS</span>
</span></span><span class=line><span class=cl>xfs_repair /dev/sdb1
</span></span><span class=line><span class=cl>xfs_repair -n /dev/sdb1     <span class=c1># Không sửa (chỉ kiểm tra)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra tất cả filesystem khi khởi động</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/fstab: Trường cuối (fs_passno)</span>
</span></span><span class=line><span class=cl><span class=c1># 0 = không kiểm tra</span>
</span></span><span class=line><span class=cl><span class=c1># 1 = kiểm tra trước (root)</span>
</span></span><span class=line><span class=cl><span class=c1># 2 = kiểm tra sau root</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Buộc fsck khi khởi động lại</span>
</span></span><span class=line><span class=cl>touch /forcefsck
</span></span><span class=line><span class=cl><span class=c1># Hoặc</span>
</span></span><span class=line><span class=cl>shutdown -rF now</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=44-tune2fs---điều-chỉnh-filesystem-ext><span>4.4 tune2fs - Điều chỉnh Filesystem ext</span>
<a href=#44-tune2fs---%c4%91i%e1%bb%81u-ch%e1%bb%89nh-filesystem-ext class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># tune2fs = Điều chỉnh tham số filesystem (ext2/3/4)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem cài đặt hiện tại</span>
</span></span><span class=line><span class=cl>tune2fs -l /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt nhãn</span>
</span></span><span class=line><span class=cl>tune2fs -L <span class=s2>&#34;newlabel&#34;</span> /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt UUID</span>
</span></span><span class=line><span class=cl>tune2fs -U random /dev/sdb1
</span></span><span class=line><span class=cl>tune2fs -U <span class=k>$(</span>uuidgen<span class=k>)</span> /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Block dành riêng (cho root)</span>
</span></span><span class=line><span class=cl>tune2fs -m <span class=m>1</span> /dev/sdb1      <span class=c1># 1% dành riêng</span>
</span></span><span class=line><span class=cl>tune2fs -r <span class=m>10000</span> /dev/sdb1  <span class=c1># 10000 block dành riêng</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Số lần mount tối đa trước khi buộc fsck</span>
</span></span><span class=line><span class=cl>tune2fs -c <span class=m>30</span> /dev/sdb1     <span class=c1># Kiểm tra sau 30 lần mount</span>
</span></span><span class=line><span class=cl>tune2fs -c <span class=m>0</span> /dev/sdb1      <span class=c1># Vô hiệu kiểm tra số lần mount</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra theo khoảng thời gian</span>
</span></span><span class=line><span class=cl>tune2fs -i 1m /dev/sdb1     <span class=c1># Kiểm tra mỗi 1 tháng</span>
</span></span><span class=line><span class=cl>tune2fs -i <span class=m>0</span> /dev/sdb1      <span class=c1># Vô hiệu kiểm tra thời gian</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bật tính năng</span>
</span></span><span class=line><span class=cl>tune2fs -O extents /dev/sdb1
</span></span><span class=line><span class=cl>tune2fs -O ^extents /dev/sdb1   <span class=c1># Tắt (^)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển ext3 sang ext4</span>
</span></span><span class=line><span class=cl>tune2fs -O extents,uninit_bg,dir_index /dev/sdb1
</span></span><span class=line><span class=cl>fsck -pf /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt tùy chọn mount mặc định</span>
</span></span><span class=line><span class=cl>tune2fs -o acl,user_xattr /dev/sdb1</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=45-resize2fs--xfs_growfs---thay-đổi-kích-thước-filesystem><span>4.5 resize2fs & xfs_growfs - Thay đổi kích thước Filesystem</span>
<a href=#45-resize2fs--xfs_growfs---thay-%c4%91%e1%bb%95i-k%c3%adch-th%c6%b0%e1%bb%9bc-filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># QUAN TRỌNG: Sao lưu trước khi thay đổi kích thước!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># resize2fs - Thay đổi kích thước ext2/3/4</span>
</span></span><span class=line><span class=cl><span class=c1># Mở rộng (có thể online nếu đã mount)</span>
</span></span><span class=line><span class=cl>resize2fs /dev/sdb1                 <span class=c1># Mở rộng đến hết phân vùng</span>
</span></span><span class=line><span class=cl>resize2fs /dev/sdb1 100G            <span class=c1># Mở rộng đến 100G</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thu nhỏ (PHẢI unmount)</span>
</span></span><span class=line><span class=cl>umount /dev/sdb1
</span></span><span class=line><span class=cl>fsck -f /dev/sdb1                   <span class=c1># Bắt buộc trước khi thu nhỏ</span>
</span></span><span class=line><span class=cl>resize2fs /dev/sdb1 50G             <span class=c1># Thu nhỏ còn 50G</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># XFS - CHỈ mở rộng, KHÔNG thu nhỏ</span>
</span></span><span class=line><span class=cl><span class=c1># Phải mount để mở rộng</span>
</span></span><span class=line><span class=cl>xfs_growfs /mount/point             <span class=c1># Mở rộng đến hết thiết bị</span>
</span></span><span class=line><span class=cl>xfs_growfs -D 100G /mount/point     <span class=c1># Mở rộng đến 100G</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra thông tin XFS</span>
</span></span><span class=line><span class=cl>xfs_info /mount/point</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-5-mount--unmount><span>PHẦN 5: MOUNT & UNMOUNT</span>
<a href=#ph%e1%ba%a7n-5-mount--unmount class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=51-mount---gắn-kết-filesystem><span>5.1 mount - Gắn kết Filesystem</span>
<a href=#51-mount---g%e1%ba%afn-k%e1%ba%bft-filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># mount = Gắn kết filesystem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount cơ bản</span>
</span></span><span class=line><span class=cl>mount /dev/sdb1 /mnt/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ định loại filesystem</span>
</span></span><span class=line><span class=cl>mount -t ext4 /dev/sdb1 /mnt/data
</span></span><span class=line><span class=cl>mount -t xfs /dev/sdb1 /mnt/data
</span></span><span class=line><span class=cl>mount -t ntfs-3g /dev/sdb1 /mnt/windows   <span class=c1># NTFS với hỗ trợ ghi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn mount</span>
</span></span><span class=line><span class=cl>mount -o ro /dev/sdb1 /mnt/data           <span class=c1># Chỉ đọc</span>
</span></span><span class=line><span class=cl>mount -o rw /dev/sdb1 /mnt/data           <span class=c1># Đọc-ghi</span>
</span></span><span class=line><span class=cl>mount -o noexec /dev/sdb1 /mnt/data       <span class=c1># Không thực thi</span>
</span></span><span class=line><span class=cl>mount -o nosuid /dev/sdb1 /mnt/data       <span class=c1># Không setuid</span>
</span></span><span class=line><span class=cl>mount -o nodev /dev/sdb1 /mnt/data        <span class=c1># Không file thiết bị</span>
</span></span><span class=line><span class=cl>mount -o noatime /dev/sdb1 /mnt/data      <span class=c1># Không cập nhật thời gian truy cập</span>
</span></span><span class=line><span class=cl>mount -o nodiratime /dev/sdb1 /mnt/data   <span class=c1># Không cập nhật thời gian truy cập thư mục</span>
</span></span><span class=line><span class=cl>mount -o relatime /dev/sdb1 /mnt/data     <span class=c1># atime tương đối (mặc định)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kết hợp tùy chọn</span>
</span></span><span class=line><span class=cl>mount -o rw,noexec,nosuid,noatime /dev/sdb1 /mnt/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount bằng UUID (khuyến nghị)</span>
</span></span><span class=line><span class=cl>mount <span class=nv>UUID</span><span class=o>=</span><span class=s2>&#34;xxxx-yyyy-zzzz&#34;</span> /mnt/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount bằng nhãn</span>
</span></span><span class=line><span class=cl>mount <span class=nv>LABEL</span><span class=o>=</span><span class=s2>&#34;data&#34;</span> /mnt/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Remount (đổi tùy chọn không cần unmount)</span>
</span></span><span class=line><span class=cl>mount -o remount,ro /mnt/data
</span></span><span class=line><span class=cl>mount -o remount,rw /mnt/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bind mount (mount thư mục sang vị trí khác)</span>
</span></span><span class=line><span class=cl>mount --bind /source/dir /target/dir
</span></span><span class=line><span class=cl>mount -o <span class=nb>bind</span> /source/dir /target/dir
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hiện filesystem đã mount</span>
</span></span><span class=line><span class=cl>mount                       <span class=c1># Tất cả mount</span>
</span></span><span class=line><span class=cl>mount -t ext4               <span class=c1># Chỉ ext4</span>
</span></span><span class=line><span class=cl>cat /proc/mounts            <span class=c1># Từ kernel</span>
</span></span><span class=line><span class=cl>cat /etc/mtab               <span class=c1># Bảng mount</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount tất cả từ fstab</span>
</span></span><span class=line><span class=cl>mount -a
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount ảnh ISO</span>
</span></span><span class=line><span class=cl>mount -o loop image.iso /mnt/iso</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=52-umount---tháo-gắn-kết-filesystem><span>5.2 umount - Tháo gắn kết Filesystem</span>
<a href=#52-umount---th%c3%a1o-g%e1%ba%afn-k%e1%ba%bft-filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># umount = Tháo gắn kết filesystem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>umount /mnt/data            <span class=c1># Theo điểm mount</span>
</span></span><span class=line><span class=cl>umount /dev/sdb1            <span class=c1># Theo thiết bị</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Buộc tháo (nếu đang bận)</span>
</span></span><span class=line><span class=cl>umount -f /mnt/data         <span class=c1># Buộc (chủ yếu NFS)</span>
</span></span><span class=line><span class=cl>umount -l /mnt/data         <span class=c1># Tháo lười (tách ngay, dọn sau)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra cái gì đang dùng mount</span>
</span></span><span class=line><span class=cl>lsof /mnt/data              <span class=c1># Liệt kê file đang mở</span>
</span></span><span class=line><span class=cl>fuser -vm /mnt/data         <span class=c1># Hiện tiến trình</span>
</span></span><span class=line><span class=cl>fuser -km /mnt/data         <span class=c1># Kill tiến trình đang dùng mount</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tháo tất cả</span>
</span></span><span class=line><span class=cl>umount -a                   <span class=c1># Tháo tất cả (trừ root và ảo)</span>
</span></span><span class=line><span class=cl>umount -a -t nfs            <span class=c1># Tháo tất cả NFS</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=53-etcfstab---mount-cố-định><span>5.3 /etc/fstab - Mount cố định</span>
<a href=#53-etcfstab---mount-c%e1%bb%91-%c4%91%e1%bb%8bnh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Định dạng /etc/fstab:</span>
</span></span><span class=line><span class=cl><span class=c1># &lt;thiết bị&gt;   &lt;điểm mount&gt;  &lt;loại&gt;  &lt;tùy chọn&gt;     &lt;dump&gt;  &lt;pass&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ví dụ /etc/fstab:</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>xxxx-yyyy-zzzz    /           ext4    defaults        <span class=m>1</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>aaaa-bbbb-cccc    /boot       ext4    defaults        <span class=m>1</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>1111-2222         /boot/efi   vfat    <span class=nv>umask</span><span class=o>=</span><span class=m>0077</span>      <span class=m>0</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>dddd-eeee-ffff    /home       ext4    defaults,noatime <span class=m>1</span> <span class=m>2</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>swap-uuid         none        swap    sw              <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>/dev/sdb1              /data       xfs     defaults,noatime <span class=m>0</span> <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount NFS</span>
</span></span><span class=line><span class=cl>server:/export/share   /mnt/nfs    nfs     defaults,_netdev    <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount CIFS/SMB</span>
</span></span><span class=line><span class=cl>//server/share         /mnt/smb    cifs    <span class=nv>credentials</span><span class=o>=</span>/root/.smbcred,uid<span class=o>=</span><span class=m>1000</span> <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Các tùy chọn phổ biến:</span>
</span></span><span class=line><span class=cl><span class=c1># defaults    = rw,suid,dev,exec,auto,nouser,async</span>
</span></span><span class=line><span class=cl><span class=c1># auto        = mount -a sẽ mount</span>
</span></span><span class=line><span class=cl><span class=c1># noauto      = Không tự động mount</span>
</span></span><span class=line><span class=cl><span class=c1># user        = Cho phép user mount</span>
</span></span><span class=line><span class=cl><span class=c1># nouser      = Chỉ root mount (mặc định)</span>
</span></span><span class=line><span class=cl><span class=c1># exec        = Cho phép thực thi</span>
</span></span><span class=line><span class=cl><span class=c1># noexec      = Không thực thi</span>
</span></span><span class=line><span class=cl><span class=c1># ro          = Chỉ đọc</span>
</span></span><span class=line><span class=cl><span class=c1># rw          = Đọc-ghi</span>
</span></span><span class=line><span class=cl><span class=c1># sync        = I/O đồng bộ</span>
</span></span><span class=line><span class=cl><span class=c1># async       = I/O bất đồng bộ (mặc định)</span>
</span></span><span class=line><span class=cl><span class=c1># noatime     = Không cập nhật thời gian truy cập</span>
</span></span><span class=line><span class=cl><span class=c1># nodiratime  = Không cập nhật thời gian truy cập thư mục</span>
</span></span><span class=line><span class=cl><span class=c1># nofail      = Không fail boot nếu thiết bị không có</span>
</span></span><span class=line><span class=cl><span class=c1># _netdev     = Thiết bị mạng (chờ mạng)</span>
</span></span><span class=line><span class=cl><span class=c1># x-systemd.automount = Automount khi truy cập</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trường dump:</span>
</span></span><span class=line><span class=cl><span class=c1># 0 = không backup bằng dump</span>
</span></span><span class=line><span class=cl><span class=c1># 1 = backup</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trường pass (thứ tự fsck):</span>
</span></span><span class=line><span class=cl><span class=c1># 0 = không kiểm tra</span>
</span></span><span class=line><span class=cl><span class=c1># 1 = kiểm tra trước (root)</span>
</span></span><span class=line><span class=cl><span class=c1># 2 = kiểm tra sau root</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Test mục fstab</span>
</span></span><span class=line><span class=cl>mount -a                    <span class=c1># Mount tất cả</span>
</span></span><span class=line><span class=cl>mount /data                 <span class=c1># Mount mục cụ thể theo điểm mount</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Debug mount</span>
</span></span><span class=line><span class=cl>mount -v /data
</span></span><span class=line><span class=cl>dmesg <span class=p>|</span> tail</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=54-systemd-mount-units><span>5.4 Systemd Mount Units</span>
<a href=#54-systemd-mount-units class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Systemd mount units - thay thế cho fstab</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /etc/systemd/system/data.mount</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Unit<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Description</span><span class=o>=</span>Phân vùng Dữ liệu
</span></span><span class=line><span class=cl><span class=nv>After</span><span class=o>=</span>local-fs.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Mount<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>What</span><span class=o>=</span>/dev/sdb1
</span></span><span class=line><span class=cl><span class=nv>Where</span><span class=o>=</span>/data
</span></span><span class=line><span class=cl><span class=nv>Type</span><span class=o>=</span>ext4
</span></span><span class=line><span class=cl><span class=nv>Options</span><span class=o>=</span>defaults,noatime
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Install<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>WantedBy</span><span class=o>=</span>multi-user.target
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kích hoạt và khởi động</span>
</span></span><span class=line><span class=cl>systemctl daemon-reload
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> data.mount
</span></span><span class=line><span class=cl>systemctl start data.mount
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Automount (mount khi truy cập)</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/systemd/system/data.automount</span>
</span></span><span class=line><span class=cl><span class=o>[</span>Unit<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Description</span><span class=o>=</span>Automount Dữ liệu
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Automount<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>Where</span><span class=o>=</span>/data
</span></span><span class=line><span class=cl><span class=nv>TimeoutIdleSec</span><span class=o>=</span><span class=m>300</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=o>[</span>Install<span class=o>]</span>
</span></span><span class=line><span class=cl><span class=nv>WantedBy</span><span class=o>=</span>multi-user.target</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-6-lvm---logical-volume-manager><span>PHẦN 6: LVM - LOGICAL VOLUME MANAGER</span>
<a href=#ph%e1%ba%a7n-6-lvm---logical-volume-manager class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=61-khái-niệm-lvm><span>6.1 Khái niệm LVM</span>
<a href=#61-kh%c3%a1i-ni%e1%bb%87m-lvm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                  KIẾN TRÚC LVM                              │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│               Logical Volumes (LV - Volume logic)           │
</span></span><span class=line><span class=cl>│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐          │
</span></span><span class=line><span class=cl>│  │  lv_root    │  │  lv_home    │  │  lv_data    │          │
</span></span><span class=line><span class=cl>│  │   50GB      │  │   100GB     │  │   200GB     │          │
</span></span><span class=line><span class=cl>│  │   ext4      │  │   ext4      │  │   xfs       │          │
</span></span><span class=line><span class=cl>│  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘          │
</span></span><span class=line><span class=cl>└─────────┼────────────────┼────────────────┼─────────────────┘
</span></span><span class=line><span class=cl>          │                │                │
</span></span><span class=line><span class=cl>          └────────────────┼────────────────┘
</span></span><span class=line><span class=cl>                           │
</span></span><span class=line><span class=cl>┌──────────────────────────┼──────────────────────────────────┐
</span></span><span class=line><span class=cl>│         Volume Group (VG - Nhóm volume): vg_main            │
</span></span><span class=line><span class=cl>│                     Tổng: 500GB                             │
</span></span><span class=line><span class=cl>│              ┌───────────┴───────────┐                      │
</span></span><span class=line><span class=cl>└──────────────┼───────────────────────┼──────────────────────┘
</span></span><span class=line><span class=cl>               │                       │
</span></span><span class=line><span class=cl>┌──────────────┼───────────────────────┼──────────────────────┐
</span></span><span class=line><span class=cl>│       Physical Volumes (PV - Volume vật lý)                 │
</span></span><span class=line><span class=cl>│  ┌───────────┴───────────┐  ┌───────┴───────────┐           │
</span></span><span class=line><span class=cl>│  │    /dev/sda3          │  │    /dev/sdb1      │           │
</span></span><span class=line><span class=cl>│  │      200GB            │  │      300GB        │           │
</span></span><span class=line><span class=cl>│  └───────────────────────┘  └───────────────────┘           │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>               │                       │
</span></span><span class=line><span class=cl>┌──────────────┼───────────────────────┼──────────────────────┐
</span></span><span class=line><span class=cl>│         Đĩa vật lý                                          │
</span></span><span class=line><span class=cl>│  ┌───────────┴───────────┐  ┌───────┴───────────┐           │
</span></span><span class=line><span class=cl>│  │       /dev/sda        │  │      /dev/sdb     │           │
</span></span><span class=line><span class=cl>│  │        500GB          │  │       500GB       │           │
</span></span><span class=line><span class=cl>│  └───────────────────────┘  └───────────────────┘           │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ưu điểm:
</span></span><span class=line><span class=cl>- Thay đổi kích thước volume online
</span></span><span class=line><span class=cl>- Trải rộng nhiều đĩa
</span></span><span class=line><span class=cl>- Snapshot
</span></span><span class=line><span class=cl>- Thin provisioning
</span></span><span class=line><span class=cl>- Dễ dàng di chuyển
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Physical Extent (PE): Đơn vị nhỏ nhất (mặc định 4MB)
</span></span><span class=line><span class=cl>Logical Extent (LE): Ánh xạ tới PE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Các loại ánh xạ:
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ LINEAR: LE ánh xạ tới PE liên tiếp                          │
</span></span><span class=line><span class=cl>│ LE[0]→PE[0], LE[1]→PE[1], LE[2]→PE[2]...                    │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ STRIPED: LE phân bố qua các PV (như RAID 0)                 │
</span></span><span class=line><span class=cl>│ LE[0]→PV1:PE[0], LE[1]→PV2:PE[0], LE[2]→PV1:PE[1]...        │
</span></span><span class=line><span class=cl>│ Hiệu năng tốt hơn, nhưng không có dự phòng                  │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ MIRRORED: LE sao chép sang nhiều PV (như RAID 1)            │
</span></span><span class=line><span class=cl>│ LE[0]→PV1:PE[0] + PV2:PE[0]                                 │
</span></span><span class=line><span class=cl>│ Dự phòng, nhưng mất dung lượng                              │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=62-lệnh-physical-volume-pv><span>6.2 Lệnh Physical Volume (PV)</span>
<a href=#62-l%e1%bb%87nh-physical-volume-pv class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo PV</span>
</span></span><span class=line><span class=cl>pvcreate /dev/sdb1
</span></span><span class=line><span class=cl>pvcreate /dev/sdc1
</span></span><span class=line><span class=cl>pvcreate /dev/sd<span class=o>{</span>b,c,d<span class=o>}</span><span class=m>1</span>    <span class=c1># Nhiều PV</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn</span>
</span></span><span class=line><span class=cl>pvcreate -ff /dev/sdb1      <span class=c1># Buộc buộc (ngay cả khi đang dùng)</span>
</span></span><span class=line><span class=cl>pvcreate --dataalignment 1M /dev/sdb1   <span class=c1># Căn chỉnh cho SSD/RAID</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem thông tin PV</span>
</span></span><span class=line><span class=cl>pvs                         <span class=c1># Tóm tắt</span>
</span></span><span class=line><span class=cl>pvdisplay                   <span class=c1># Chi tiết</span>
</span></span><span class=line><span class=cl>pvdisplay /dev/sdb1         <span class=c1># PV cụ thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất pvs:</span>
</span></span><span class=line><span class=cl><span class=c1># PV         VG      Fmt  Attr PSize   PFree</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sdb1  vg_main lvm2 a--  200.00g 50.00g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Quét tìm PV</span>
</span></span><span class=line><span class=cl>pvscan
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa PV</span>
</span></span><span class=line><span class=cl>pvremove /dev/sdb1          <span class=c1># Xóa PV (phải trống)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Di chuyển dữ liệu khỏi PV (trước khi xóa khỏi VG)</span>
</span></span><span class=line><span class=cl>pvmove /dev/sdb1            <span class=c1># Di chuyển sang PV khác trong VG</span>
</span></span><span class=line><span class=cl>pvmove /dev/sdb1 /dev/sdc1  <span class=c1># Di chuyển sang PV cụ thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thay đổi kích thước PV (sau khi resize phân vùng)</span>
</span></span><span class=line><span class=cl>pvresize /dev/sdb1
</span></span><span class=line><span class=cl>pvresize --setphysicalvolumesize 100G /dev/sdb1</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=63-lệnh-volume-group-vg><span>6.3 Lệnh Volume Group (VG)</span>
<a href=#63-l%e1%bb%87nh-volume-group-vg class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo VG</span>
</span></span><span class=line><span class=cl>vgcreate vg_main /dev/sdb1
</span></span><span class=line><span class=cl>vgcreate vg_main /dev/sdb1 /dev/sdc1    <span class=c1># Nhiều PV</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn</span>
</span></span><span class=line><span class=cl>vgcreate -s 16M vg_main /dev/sdb1       <span class=c1># Kích thước PE 16MB (mặc định 4MB)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem thông tin VG</span>
</span></span><span class=line><span class=cl>vgs                         <span class=c1># Tóm tắt</span>
</span></span><span class=line><span class=cl>vgdisplay                   <span class=c1># Chi tiết</span>
</span></span><span class=line><span class=cl>vgdisplay vg_main           <span class=c1># VG cụ thể</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất vgs:</span>
</span></span><span class=line><span class=cl><span class=c1># VG      #PV #LV #SN Attr   VSize   VFree</span>
</span></span><span class=line><span class=cl><span class=c1># vg_main   2   3   0 wz--n- 500.00g 150.00g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mở rộng VG (thêm PV)</span>
</span></span><span class=line><span class=cl>vgextend vg_main /dev/sdd1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thu nhỏ VG (xóa PV)</span>
</span></span><span class=line><span class=cl>pvmove /dev/sdb1            <span class=c1># Di chuyển dữ liệu trước</span>
</span></span><span class=line><span class=cl>vgreduce vg_main /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi tên VG</span>
</span></span><span class=line><span class=cl>vgrename vg_main vg_new
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa VG</span>
</span></span><span class=line><span class=cl>vgremove vg_main            <span class=c1># Xóa VG (phải trống)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Export/Import (di chuyển VG giữa hệ thống)</span>
</span></span><span class=line><span class=cl>vgexport vg_main            <span class=c1># Hủy kích hoạt + export</span>
</span></span><span class=line><span class=cl><span class=c1># Di chuyển đĩa sang hệ thống mới</span>
</span></span><span class=line><span class=cl>vgimport vg_main            <span class=c1># Import trên hệ thống mới</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kích hoạt/Hủy kích hoạt</span>
</span></span><span class=line><span class=cl>vgchange -a y vg_main       <span class=c1># Kích hoạt</span>
</span></span><span class=line><span class=cl>vgchange -a n vg_main       <span class=c1># Hủy kích hoạt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Quét tìm VG</span>
</span></span><span class=line><span class=cl>vgscan</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=64-lệnh-logical-volume-lv><span>6.4 Lệnh Logical Volume (LV)</span>
<a href=#64-l%e1%bb%87nh-logical-volume-lv class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo LV</span>
</span></span><span class=line><span class=cl>lvcreate -L 50G -n lv_root vg_main          <span class=c1># 50GB</span>
</span></span><span class=line><span class=cl>lvcreate -l 100%FREE -n lv_data vg_main     <span class=c1># Toàn bộ dung lượng còn lại</span>
</span></span><span class=line><span class=cl>lvcreate -l 50%VG -n lv_home vg_main        <span class=c1># 50% của VG</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn kích thước:</span>
</span></span><span class=line><span class=cl><span class=c1># -L 50G          Kích thước tuyệt đối</span>
</span></span><span class=line><span class=cl><span class=c1># -l 100          100 extent</span>
</span></span><span class=line><span class=cl><span class=c1># -l 50%VG        50% của VG</span>
</span></span><span class=line><span class=cl><span class=c1># -l 100%FREE     Toàn bộ dung lượng trống</span>
</span></span><span class=line><span class=cl><span class=c1># -l 100%PVS      Toàn bộ dung lượng trong PV được chỉ định</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># LV striped (giống RAID 0)</span>
</span></span><span class=line><span class=cl>lvcreate -L 100G -i <span class=m>2</span> -I 64K -n lv_striped vg_main
</span></span><span class=line><span class=cl><span class=c1># -i 2: 2 stripe (cần 2 PV)</span>
</span></span><span class=line><span class=cl><span class=c1># -I 64K: kích thước stripe</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># LV mirrored (giống RAID 1)</span>
</span></span><span class=line><span class=cl>lvcreate -L 50G -m <span class=m>1</span> -n lv_mirror vg_main
</span></span><span class=line><span class=cl><span class=c1># -m 1: 1 mirror (tổng 2 bản sao)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem thông tin LV</span>
</span></span><span class=line><span class=cl>lvs                         <span class=c1># Tóm tắt</span>
</span></span><span class=line><span class=cl>lvdisplay                   <span class=c1># Chi tiết</span>
</span></span><span class=line><span class=cl>lvdisplay /dev/vg_main/lv_root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất lvs:</span>
</span></span><span class=line><span class=cl><span class=c1># LV      VG      Attr       LSize  Pool Origin Data%  Meta%</span>
</span></span><span class=line><span class=cl><span class=c1># lv_root vg_main -wi-ao---- 50.00g</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đường dẫn tới LV:</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/vg_main/lv_root</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/mapper/vg_main-lv_root</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa LV</span>
</span></span><span class=line><span class=cl>lvremove /dev/vg_main/lv_data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi tên LV</span>
</span></span><span class=line><span class=cl>lvrename vg_main lv_old lv_new</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=65-thao-tác-thay-đổi-kích-thước-lvm><span>6.5 Thao tác thay đổi kích thước LVM</span>
<a href=#65-thao-t%c3%a1c-thay-%c4%91%e1%bb%95i-k%c3%adch-th%c6%b0%e1%bb%9bc-lvm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># MỞ RỘNG LV (grow)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Mở rộng LV</span>
</span></span><span class=line><span class=cl>lvextend -L +50G /dev/vg_main/lv_root       <span class=c1># Thêm 50G</span>
</span></span><span class=line><span class=cl>lvextend -L 100G /dev/vg_main/lv_root       <span class=c1># Đặt thành 100G</span>
</span></span><span class=line><span class=cl>lvextend -l +100%FREE /dev/vg_main/lv_root  <span class=c1># Thêm toàn bộ dung lượng trống</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Thay đổi kích thước filesystem</span>
</span></span><span class=line><span class=cl><span class=c1># ext4:</span>
</span></span><span class=line><span class=cl>resize2fs /dev/vg_main/lv_root              <span class=c1># Mở rộng đến hết LV</span>
</span></span><span class=line><span class=cl><span class=c1># XFS:</span>
</span></span><span class=line><span class=cl>xfs_growfs /mount/point                     <span class=c1># Phải đang mount</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Một lệnh (lvextend + resize):</span>
</span></span><span class=line><span class=cl>lvextend -r -L +50G /dev/vg_main/lv_root    <span class=c1># -r = resize filesystem</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># THU NHỎ LV (shrink) - chỉ ext4, XFS không thu nhỏ được</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Unmount</span>
</span></span><span class=line><span class=cl>umount /dev/vg_main/lv_root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Kiểm tra filesystem</span>
</span></span><span class=line><span class=cl>fsck -f /dev/vg_main/lv_root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Thu nhỏ filesystem trước</span>
</span></span><span class=line><span class=cl>resize2fs /dev/vg_main/lv_root 40G
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Thu nhỏ LV</span>
</span></span><span class=line><span class=cl>lvreduce -L 40G /dev/vg_main/lv_root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Một lệnh (an toàn hơn):</span>
</span></span><span class=line><span class=cl>lvreduce -r -L 40G /dev/vg_main/lv_root     <span class=c1># -r = resize filesystem trước</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. Mount lại</span>
</span></span><span class=line><span class=cl>mount /dev/vg_main/lv_root /mount/point</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=66-lvm-snapshot><span>6.6 LVM Snapshot</span>
<a href=#66-lvm-snapshot class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Snapshot = Bản sao tại thời điểm (Copy-on-Write)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo snapshot</span>
</span></span><span class=line><span class=cl>lvcreate -s -L 10G -n snap_root /dev/vg_main/lv_root
</span></span><span class=line><span class=cl><span class=c1># -s: snapshot</span>
</span></span><span class=line><span class=cl><span class=c1># -L 10G: Kích thước cho vùng COW (chỉ thay đổi)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount snapshot (chỉ đọc hoặc đọc-ghi)</span>
</span></span><span class=line><span class=cl>mount -o ro /dev/vg_main/snap_root /mnt/snap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem thông tin snapshot</span>
</span></span><span class=line><span class=cl>lvs -a
</span></span><span class=line><span class=cl><span class=c1># snap_root vg_main swi-a-s--- 10.00g      lv_root 5.00</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Gộp snapshot ngược lại (hoàn tác về snapshot)</span>
</span></span><span class=line><span class=cl>lvconvert --merge /dev/vg_main/snap_root
</span></span><span class=line><span class=cl><span class=c1># Sẽ gộp khi LV được hủy kích hoạt/kích hoạt lại</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa snapshot</span>
</span></span><span class=line><span class=cl>lvremove /dev/vg_main/snap_root
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># COW hoạt động như thế nào:</span>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│               SNAPSHOT COW <span class=o>(</span>Copy-on-Write<span class=o>)</span>                  │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ Ban đầu: Snapshot chỉ lưu metadata, trỏ đến bản gốc         │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ LV gốc:     <span class=o>[</span>A<span class=o>]</span> <span class=o>[</span>B<span class=o>]</span> <span class=o>[</span>C<span class=o>]</span> <span class=o>[</span>D<span class=o>]</span> <span class=o>[</span>E<span class=o>]</span>                              │
</span></span><span class=line><span class=cl>│              ↑   ↑   ↑   ↑   ↑                              │
</span></span><span class=line><span class=cl>│ Snapshot:    └───┴───┴───┴───┘                              │
</span></span><span class=line><span class=cl>│             <span class=o>(</span>chỉ con trỏ, ~0 dung lượng<span class=o>)</span>                    │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ Khi ghi block B:                                            │
</span></span><span class=line><span class=cl>│ 1. Sao chép B gốc → vùng COW snapshot                       │
</span></span><span class=line><span class=cl>│ 2. Ghi B<span class=s1>&#39; mới → bản gốc                                     │
</span></span></span><span class=line><span class=cl><span class=s1>│                                                             │
</span></span></span><span class=line><span class=cl><span class=s1>│ LV gốc:     [A] [B&#39;</span><span class=o>]</span> <span class=o>[</span>C<span class=o>]</span> <span class=o>[</span>D<span class=o>]</span> <span class=o>[</span>E<span class=o>]</span>                             │
</span></span><span class=line><span class=cl>│ Snapshot COW: <span class=o>[</span>B<span class=o>]</span>                                           │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ Đọc snapshot: B từ COW, A/C/D/E từ bản gốc                  │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=67-lvm-thin-provisioning><span>6.7 LVM Thin Provisioning</span>
<a href=#67-lvm-thin-provisioning class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Thin = Cấp phát theo yêu cầu (cam kết vượt mức)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo thin pool</span>
</span></span><span class=line><span class=cl>lvcreate -L 100G --thinpool thin_pool vg_main
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo thin LV từ pool</span>
</span></span><span class=line><span class=cl>lvcreate -V 500G --thin -n thin_lv1 vg_main/thin_pool
</span></span><span class=line><span class=cl>lvcreate -V 300G --thin -n thin_lv2 vg_main/thin_pool
</span></span><span class=line><span class=cl><span class=c1># Tổng: 800G ảo từ 100G pool (cam kết vượt mức)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem mức sử dụng</span>
</span></span><span class=line><span class=cl>lvs -a
</span></span><span class=line><span class=cl><span class=c1># thin_pool  vg_main twi-a-t--- 100.00g             45.00</span>
</span></span><span class=line><span class=cl><span class=c1># thin_lv1   vg_main Vwi-a-t--- 500.00g thin_pool   20.00</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mở rộng pool khi cần</span>
</span></span><span class=line><span class=cl>lvextend -L +50G vg_main/thin_pool
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thin snapshot (tức thì, tiết kiệm dung lượng)</span>
</span></span><span class=line><span class=cl>lvcreate -s -n snap_thin /dev/vg_main/thin_lv1
</span></span><span class=line><span class=cl><span class=c1># Không cần chỉ định kích thước, dùng chung pool</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-7-quản-lý-swap><span>PHẦN 7: QUẢN LÝ SWAP</span>
<a href=#ph%e1%ba%a7n-7-qu%e1%ba%a3n-l%c3%bd-swap class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=71-khái-niệm-swap><span>7.1 Khái niệm Swap</span>
<a href=#71-kh%c3%a1i-ni%e1%bb%87m-swap class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    KHÔNG GIAN SWAP                          │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Swap = Mở rộng &#34;bộ nhớ ảo&#34;
</span></span><span class=line><span class=cl>Khi RAM đầy, kernel di chuyển trang không hoạt động → swap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Thay thế trang: Biến thể LRU (Least Recently Used - Ít dùng gần đây nhất)
</span></span><span class=line><span class=cl>- Danh sách hoạt động: Trang được truy cập gần đây
</span></span><span class=line><span class=cl>- Danh sách không hoạt động: Ứng viên để swap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                      BỘ NHỚ                                 │
</span></span><span class=line><span class=cl>│  ┌─────────────────────────────────────────────────────┐    │
</span></span><span class=line><span class=cl>│  │ Trang hoạt động (nóng)                              │    │
</span></span><span class=line><span class=cl>│  │ [A] [B] [C] [D] [E]                                 │    │
</span></span><span class=line><span class=cl>│  └─────────────────────────────────────────────────────┘    │
</span></span><span class=line><span class=cl>│  ┌─────────────────────────────────────────────────────┐    │
</span></span><span class=line><span class=cl>│  │ Trang không hoạt động (lạnh)                        │    │
</span></span><span class=line><span class=cl>│  │ [X] [Y] [Z]  ─────────────► Swap ra                 │    │
</span></span><span class=line><span class=cl>│  └─────────────────────────────────────────────────────┘    │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>                                        │
</span></span><span class=line><span class=cl>                                        ▼
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                   KHÔNG GIAN SWAP                           │
</span></span><span class=line><span class=cl>│  [X] [Y] [Z] [các trang cũ hơn...]                          │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Swappiness (độ swap): 0-100 (mặc định 60)
</span></span><span class=line><span class=cl>- 0: Tránh swap (chỉ khi cần thiết)
</span></span><span class=line><span class=cl>- 100: Tích cực swap
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Khuyến nghị kích thước swap:
</span></span><span class=line><span class=cl>- RAM &lt; 2GB: 2x RAM
</span></span><span class=line><span class=cl>- RAM 2-8GB: = RAM
</span></span><span class=line><span class=cl>- RAM &gt; 8GB: 8GB hoặc &gt;= căn(RAM) cho hibernation</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=72-mkswap-swapon-swapoff><span>7.2 mkswap, swapon, swapoff</span>
<a href=#72-mkswap-swapon-swapoff class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo phân vùng swap</span>
</span></span><span class=line><span class=cl>fdisk /dev/sdb              <span class=c1># Tạo phân vùng với loại 82 (Linux swap)</span>
</span></span><span class=line><span class=cl>mkswap /dev/sdb1
</span></span><span class=line><span class=cl>swapon /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo file swap</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>/swapfile <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>count</span><span class=o>=</span><span class=m>4096</span>   <span class=c1># 4GB</span>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> /swapfile         <span class=c1># Bảo mật</span>
</span></span><span class=line><span class=cl>mkswap /swapfile
</span></span><span class=line><span class=cl>swapon /swapfile
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hoặc dùng fallocate (nhanh hơn, nhưng không phải filesystem nào cũng hỗ trợ)</span>
</span></span><span class=line><span class=cl>fallocate -l 4G /swapfile
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> /swapfile
</span></span><span class=line><span class=cl>mkswap /swapfile
</span></span><span class=line><span class=cl>swapon /swapfile
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem trạng thái swap</span>
</span></span><span class=line><span class=cl>swapon -s
</span></span><span class=line><span class=cl>swapon --show
</span></span><span class=line><span class=cl>free -h
</span></span><span class=line><span class=cl>cat /proc/swaps
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất:</span>
</span></span><span class=line><span class=cl><span class=c1># Filename              Type        Size      Used    Priority</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sdb1             partition   4194300   0       -2</span>
</span></span><span class=line><span class=cl><span class=c1># /swapfile             file        4194300   0       -3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tắt swap</span>
</span></span><span class=line><span class=cl>swapoff /dev/sdb1
</span></span><span class=line><span class=cl>swapoff /swapfile
</span></span><span class=line><span class=cl>swapoff -a                  <span class=c1># Tất cả swap</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ưu tiên (cao hơn = dùng trước)</span>
</span></span><span class=line><span class=cl>swapon -p <span class=m>10</span> /dev/sdb1
</span></span><span class=line><span class=cl>swapon -p <span class=m>5</span> /swapfile
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cố định (thêm vào /etc/fstab)</span>
</span></span><span class=line><span class=cl><span class=c1># /dev/sdb1    none    swap    sw,pri=10    0 0</span>
</span></span><span class=line><span class=cl><span class=c1># /swapfile    none    swap    sw,pri=5     0 0</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>swap-uuid none    swap    sw           <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Điều chỉnh swappiness</span>
</span></span><span class=line><span class=cl>cat /proc/sys/vm/swappiness         <span class=c1># Giá trị hiện tại</span>
</span></span><span class=line><span class=cl>sysctl vm.swappiness<span class=o>=</span><span class=m>10</span>             <span class=c1># Tạm thời</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;vm.swappiness=10&#34;</span> &gt;&gt; /etc/sysctl.conf   <span class=c1># Vĩnh viễn</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-8-giám-sát-io><span>PHẦN 8: GIÁM SÁT I/O</span>
<a href=#ph%e1%ba%a7n-8-gi%c3%a1m-s%c3%a1t-io class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=81-iostat---thống-kê-io><span>8.1 iostat - Thống kê I/O</span>
<a href=#81-iostat---th%e1%bb%91ng-k%c3%aa-io class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># iostat = Báo cáo thống kê CPU và I/O (từ gói sysstat)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>iostat
</span></span><span class=line><span class=cl>iostat -x                   <span class=c1># Thống kê mở rộng</span>
</span></span><span class=line><span class=cl>iostat -d                   <span class=c1># Chỉ thống kê thiết bị</span>
</span></span><span class=line><span class=cl>iostat -c                   <span class=c1># Chỉ thống kê CPU</span>
</span></span><span class=line><span class=cl>iostat -p                   <span class=c1># Bao gồm phân vùng</span>
</span></span><span class=line><span class=cl>iostat -h                   <span class=c1># Dễ đọc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>iostat <span class=m>1</span>                    <span class=c1># Cập nhật mỗi 1 giây</span>
</span></span><span class=line><span class=cl>iostat <span class=m>1</span> <span class=m>10</span>                 <span class=c1># Khoảng 1 giây, 10 lần</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>iostat -xdh <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=c1># Device      r/s     w/s     rkB/s    wkB/s  rrqm/s  wrqm/s  %rrqm  %wrqm r_await w_await aqu-sz rareq-sz wareq-sz  svctm  %util</span>
</span></span><span class=line><span class=cl><span class=c1># sda        10.00   50.00    500.00  2000.00   1.00   10.00  10.00  20.00    1.00    2.00   0.10    50.00    40.00   0.50   3.00</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải thích cột:</span>
</span></span><span class=line><span class=cl><span class=c1># r/s, w/s:       Yêu cầu đọc/ghi mỗi giây</span>
</span></span><span class=line><span class=cl><span class=c1># rkB/s, wkB/s:   KB đọc/ghi mỗi giây</span>
</span></span><span class=line><span class=cl><span class=c1># rrqm/s, wrqm/s: Yêu cầu đọc/ghi được gộp mỗi giây</span>
</span></span><span class=line><span class=cl><span class=c1># r_await, w_await: Thời gian chờ trung bình (ms)</span>
</span></span><span class=line><span class=cl><span class=c1># aqu-sz:         Kích thước hàng đợi trung bình</span>
</span></span><span class=line><span class=cl><span class=c1># %util:          Phần trăm thời gian thiết bị bận</span>
</span></span><span class=line><span class=cl><span class=c1>#                 → 100% = bão hòa (thắt cổ chai)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dấu hiệu cảnh báo:</span>
</span></span><span class=line><span class=cl><span class=c1># - %util &gt; 80-90% liên tục → thắt cổ chai I/O</span>
</span></span><span class=line><span class=cl><span class=c1># - r_await/w_await &gt; 10-20ms → Thiết bị chậm</span>
</span></span><span class=line><span class=cl><span class=c1># - aqu-sz &gt; 1 liên tục → Hàng đợi tích lũy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Theo từng thiết bị</span>
</span></span><span class=line><span class=cl>iostat -xd /dev/sda <span class=m>1</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=82-iotop---io-theo-tiến-trình><span>8.2 iotop - I/O theo tiến trình</span>
<a href=#82-iotop---io-theo-ti%e1%ba%bfn-tr%c3%acnh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># iotop = top cho I/O (cần root)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>iotop
</span></span><span class=line><span class=cl>iotop -o                    <span class=c1># Chỉ tiến trình đang I/O</span>
</span></span><span class=line><span class=cl>iotop -a                    <span class=c1># I/O tích lũy</span>
</span></span><span class=line><span class=cl>iotop -P                    <span class=c1># Hiện tiến trình (không phải thread)</span>
</span></span><span class=line><span class=cl>iotop -b                    <span class=c1># Chế độ batch (để ghi log)</span>
</span></span><span class=line><span class=cl>iotop -d <span class=m>2</span>                  <span class=c1># Cập nhật mỗi 2 giây</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất:</span>
</span></span><span class=line><span class=cl><span class=c1># Total DISK READ:       0.00 B/s | Total DISK WRITE:       0.00 B/s</span>
</span></span><span class=line><span class=cl><span class=c1># Actual DISK READ:      0.00 B/s | Actual DISK WRITE:      0.00 B/s</span>
</span></span><span class=line><span class=cl><span class=c1>#   TID  PRIO  USER     DISK READ  DISK WRITE  SWAPIN     IO&gt;    COMMAND</span>
</span></span><span class=line><span class=cl><span class=c1>#  1234 be/4  mysql        1.00 M/s    2.00 M/s  0.00 %  0.00 % mysqld</span>
</span></span><span class=line><span class=cl><span class=c1>#  5678 be/4  root         0.50 M/s    0.00 B/s  0.00 %  0.00 % rsync</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cột:</span>
</span></span><span class=line><span class=cl><span class=c1># TID:        ID Thread</span>
</span></span><span class=line><span class=cl><span class=c1># PRIO:       Ưu tiên I/O (be = best-effort)</span>
</span></span><span class=line><span class=cl><span class=c1># DISK READ:  Băng thông đọc</span>
</span></span><span class=line><span class=cl><span class=c1># DISK WRITE: Băng thông ghi</span>
</span></span><span class=line><span class=cl><span class=c1># SWAPIN:     Phần trăm thời gian chờ swap</span>
</span></span><span class=line><span class=cl><span class=c1># IO&gt;:        Phần trăm thời gian chờ I/O</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Phím tắt:</span>
</span></span><span class=line><span class=cl><span class=c1># o: Chỉ hiện tiến trình có I/O</span>
</span></span><span class=line><span class=cl><span class=c1># p: Bật tắt thread/tiến trình</span>
</span></span><span class=line><span class=cl><span class=c1># a: Bật tắt tích lũy/băng thông</span>
</span></span><span class=line><span class=cl><span class=c1># q: Thoát</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=83-bộ-lập-lịch-io><span>8.3 Bộ lập lịch I/O</span>
<a href=#83-b%e1%bb%99-l%e1%ba%adp-l%e1%bb%8bch-io class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># I/O Scheduler = Thuật toán quyết định thứ tự yêu cầu I/O</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra scheduler hiện tại</span>
</span></span><span class=line><span class=cl>cat /sys/block/sda/queue/scheduler
</span></span><span class=line><span class=cl><span class=c1># [mq-deadline] kyber bfq none</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Các scheduler có sẵn:</span>
</span></span><span class=line><span class=cl><span class=c1># mq-deadline: Tốt cho hầu hết workload, độ trễ thấp</span>
</span></span><span class=line><span class=cl><span class=c1># kyber:       Cho thiết bị nhanh (NVMe)</span>
</span></span><span class=line><span class=cl><span class=c1># bfq:         Budget Fair Queueing - tốt cho desktop/tương tác</span>
</span></span><span class=line><span class=cl><span class=c1># none:        Không lập lịch (NVMe thường dùng)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi scheduler (tạm thời)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;bfq&#34;</span> &gt; /sys/block/sda/queue/scheduler
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vĩnh viễn (luật udev)</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/udev/rules.d/60-scheduler.rules</span>
</span></span><span class=line><span class=cl><span class=c1># ACTION==&#34;add|change&#34;, KERNEL==&#34;sd*&#34;, ATTR{queue/scheduler}=&#34;bfq&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># ACTION==&#34;add|change&#34;, KERNEL==&#34;nvme*&#34;, ATTR{queue/scheduler}=&#34;none&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hoặc tham số kernel</span>
</span></span><span class=line><span class=cl><span class=c1># elevator=bfq (không dùng nữa trong kernel mới)</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-9-hệ-thống-tệp-mạng><span>PHẦN 9: HỆ THỐNG TỆP MẠNG</span>
<a href=#ph%e1%ba%a7n-9-h%e1%bb%87-th%e1%bb%91ng-t%e1%bb%87p-m%e1%ba%a1ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=91-kiến-trúc-nfs><span>9.1 Kiến trúc NFS</span>
<a href=#91-ki%e1%ba%bfn-tr%c3%bac-nfs class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>┌─────────────────────────────────────────────────────────────┐</span>
</span></span><span class=line><span class=cl><span class=err>│</span>                    <span class=n>KIẾN</span> <span class=n>TRÚC</span> <span class=n>NFS</span>                            <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>└─────────────────────────────────────────────────────────────┘</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=err>┌─────────────────┐</span>                    <span class=err>┌─────────────────┐</span>
</span></span><span class=line><span class=cl><span class=err>│</span>   <span class=n>NFS</span> <span class=n>Client</span>    <span class=err>│</span>                    <span class=err>│</span>   <span class=n>NFS</span> <span class=n>Server</span>    <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>                 <span class=err>│</span>                    <span class=err>│</span>                 <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>┌───────────┐</span>  <span class=err>│</span>    <span class=n>Giao</span> <span class=n>thức</span> <span class=n>NFS</span>   <span class=err>│</span>  <span class=err>┌───────────┐</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>│Ứ</span><span class=n>ng</span> <span class=n>dụng</span>   <span class=err>│</span>  <span class=err>│</span>   <span class=p>(</span><span class=n>RPC</span> <span class=n>qua</span> <span class=n>TCP</span><span class=p>)</span>    <span class=err>│</span>  <span class=err>│</span>  <span class=n>nfsd</span>     <span class=err>│</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>└─────┬─────┘</span>  <span class=err>│◄──────────────────►│</span>  <span class=err>└─────┬─────┘</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>        <span class=err>│</span>        <span class=err>│</span>                    <span class=err>│</span>        <span class=err>│</span>        <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>┌─────┴─────┐</span>  <span class=err>│</span>                    <span class=err>│</span>  <span class=err>┌─────┴─────┐</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>│</span>   <span class=n>VFS</span>     <span class=err>│</span>  <span class=err>│</span>                    <span class=err>│</span>  <span class=err>│</span> <span class=n>Filesystem</span><span class=err>│</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>└─────┬─────┘</span>  <span class=err>│</span>                    <span class=err>│</span>  <span class=err>│</span> <span class=p>(</span><span class=n>ext4</span><span class=p>,</span><span class=n>xfs</span><span class=p>)</span><span class=err>│</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>        <span class=err>│</span>        <span class=err>│</span>                    <span class=err>│</span>  <span class=err>└───────────┘</span>  <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>┌─────┴─────┐</span>  <span class=err>│</span>                    <span class=err>│</span>                 <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>│</span> <span class=n>Module</span>    <span class=err>│</span>  <span class=err>│</span>                    <span class=err>│</span>  <span class=o>/</span><span class=n>etc</span><span class=o>/</span><span class=n>exports</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>│</span><span class=n>NFS</span> <span class=n>Client</span> <span class=err>│</span>  <span class=err>│</span>                    <span class=err>│</span>                 <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span>  <span class=err>└───────────┘</span>  <span class=err>│</span>                    <span class=err>└─────────────────┘</span>
</span></span><span class=line><span class=cl><span class=err>└─────────────────┘</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Các</span> <span class=n>phiên</span> <span class=n>bản</span> <span class=n>NFS</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=err>┌─────────┬────────────────────────────────────────────────┐</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Phiên</span> <span class=n>bản</span> <span class=err>│</span> <span class=n>Tính</span> <span class=n>năng</span>                                    <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>├─────────┼────────────────────────────────────────────────┤</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>NFSv3</span>   <span class=err>│</span> <span class=n>Không</span> <span class=n>trạng</span> <span class=n>thái</span><span class=p>,</span> <span class=n>UDP</span><span class=o>/</span><span class=n>TCP</span><span class=p>,</span> <span class=n>AUTH_SYS</span>            <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>NFSv4</span>   <span class=err>│</span> <span class=n>Có</span> <span class=n>trạng</span> <span class=n>thái</span><span class=p>,</span> <span class=n>chỉ</span> <span class=n>TCP</span><span class=p>,</span> <span class=n>bảo</span> <span class=n>mật</span> <span class=n>mạnh</span><span class=p>,</span> <span class=n>ACL</span>      <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>NFSv4</span><span class=o>.</span><span class=mi>1</span> <span class=err>│</span> <span class=n>pNFS</span> <span class=p>(</span><span class=n>song</span> <span class=n>song</span><span class=p>),</span> <span class=n>session</span><span class=p>,</span> <span class=n>khóa</span> <span class=n>tốt</span> <span class=n>hơn</span>        <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>NFSv4</span><span class=o>.</span><span class=mi>2</span> <span class=err>│</span> <span class=n>Sao</span> <span class=n>chép</span> <span class=n>phía</span> <span class=n>server</span><span class=p>,</span> <span class=n>file</span> <span class=n>thưa</span>                <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>└─────────┴────────────────────────────────────────────────┘</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>RPC</span> <span class=p>(</span><span class=n>Remote</span> <span class=n>Procedure</span> <span class=n>Call</span> <span class=o>-</span> <span class=n>Gọi</span> <span class=n>thủ</span> <span class=n>tục</span> <span class=n>từ</span> <span class=n>xa</span><span class=p>):</span>
</span></span><span class=line><span class=cl><span class=n>Client</span> <span class=n>gọi</span> <span class=n>hàm</span> <span class=n>trên</span> <span class=n>server</span> <span class=n>như</span> <span class=n>hàm</span> <span class=n>local</span>
</span></span><span class=line><span class=cl><span class=n>NFS</span> <span class=n>dùng</span> <span class=n>Sun</span> <span class=n>RPC</span> <span class=p>(</span><span class=n>cổng</span> <span class=mi>111</span> <span class=o>-</span> <span class=n>rpcbind</span><span class=p>,</span> <span class=o>+</span> <span class=n>cổng</span> <span class=err>độ</span><span class=n>ng</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>Caching</span><span class=p>:</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>Cache</span> <span class=n>thuộc</span> <span class=n>tính</span><span class=p>:</span> <span class=n>Metadata</span> <span class=n>file</span> <span class=p>(</span><span class=n>timeout</span> <span class=n>có</span> <span class=n>thể</span> <span class=n>cấu</span> <span class=n>hình</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>Cache</span> <span class=n>dữ</span> <span class=n>liệu</span><span class=p>:</span> <span class=n>Nội</span> <span class=n>dung</span> <span class=n>file</span>
</span></span><span class=line><span class=cl><span class=o>-</span> <span class=n>Tính</span> <span class=n>nhất</span> <span class=n>quán</span> <span class=n>close</span><span class=o>-</span><span class=n>to</span><span class=o>-</span><span class=n>open</span><span class=p>:</span> <span class=n>Xác</span> <span class=n>thực</span> <span class=n>lại</span> <span class=n>khi</span> <span class=n>mở</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=92-cài-đặt-nfs-server><span>9.2 Cài đặt NFS Server</span>
<a href=#92-c%c3%a0i-%c4%91%e1%ba%b7t-nfs-server class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Cài đặt NFS server</span>
</span></span><span class=line><span class=cl>apt install nfs-kernel-server      <span class=c1># Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>yum install nfs-utils              <span class=c1># RHEL/CentOS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /etc/exports - Định nghĩa chia sẻ</span>
</span></span><span class=line><span class=cl>/data           192.168.1.0/24<span class=o>(</span>rw,sync,no_subtree_check<span class=o>)</span>
</span></span><span class=line><span class=cl>/home           192.168.1.0/24<span class=o>(</span>rw,sync,no_root_squash<span class=o>)</span>
</span></span><span class=line><span class=cl>/public         *<span class=o>(</span>ro,sync<span class=o>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn export:</span>
</span></span><span class=line><span class=cl><span class=c1># rw:              Đọc-ghi</span>
</span></span><span class=line><span class=cl><span class=c1># ro:              Chỉ đọc</span>
</span></span><span class=line><span class=cl><span class=c1># sync:            Ghi đồng bộ (an toàn hơn)</span>
</span></span><span class=line><span class=cl><span class=c1># async:           Ghi bất đồng bộ (nhanh hơn, rủi ro)</span>
</span></span><span class=line><span class=cl><span class=c1># no_subtree_check: Tắt kiểm tra subtree (hiệu năng)</span>
</span></span><span class=line><span class=cl><span class=c1># no_root_squash:  Root trên client = root trên server (không an toàn)</span>
</span></span><span class=line><span class=cl><span class=c1># root_squash:     Root trên client = nobody (mặc định)</span>
</span></span><span class=line><span class=cl><span class=c1># all_squash:      Tất cả user = nobody</span>
</span></span><span class=line><span class=cl><span class=c1># anonuid/anongid: UID/GID cho user ẩn danh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Áp dụng exports</span>
</span></span><span class=line><span class=cl>exportfs -a                 <span class=c1># Export tất cả</span>
</span></span><span class=line><span class=cl>exportfs -r                 <span class=c1># Re-export (làm mới)</span>
</span></span><span class=line><span class=cl>exportfs -v                 <span class=c1># Verbose (hiện exports hiện tại)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Export thư mục đơn lẻ</span>
</span></span><span class=line><span class=cl>exportfs -o rw,sync 192.168.1.0/24:/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hủy export</span>
</span></span><span class=line><span class=cl>exportfs -u 192.168.1.0/24:/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khởi động dịch vụ</span>
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now nfs-server
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> --now rpcbind
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tường lửa</span>
</span></span><span class=line><span class=cl>firewall-cmd --permanent --add-service<span class=o>=</span>nfs
</span></span><span class=line><span class=cl>firewall-cmd --permanent --add-service<span class=o>=</span>rpc-bind
</span></span><span class=line><span class=cl>firewall-cmd --permanent --add-service<span class=o>=</span>mountd
</span></span><span class=line><span class=cl>firewall-cmd --reload</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=93-nfs-client><span>9.3 NFS Client</span>
<a href=#93-nfs-client class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Cài đặt NFS client</span>
</span></span><span class=line><span class=cl>apt install nfs-common             <span class=c1># Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>yum install nfs-utils              <span class=c1># RHEL/CentOS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hiện exports từ server</span>
</span></span><span class=line><span class=cl>showmount -e server_ip
</span></span><span class=line><span class=cl>showmount -e 192.168.1.10
</span></span><span class=line><span class=cl><span class=c1># Export list for 192.168.1.10:</span>
</span></span><span class=line><span class=cl><span class=c1># /data   192.168.1.0/24</span>
</span></span><span class=line><span class=cl><span class=c1># /home   192.168.1.0/24</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount NFS</span>
</span></span><span class=line><span class=cl>mount -t nfs server:/data /mnt/nfs
</span></span><span class=line><span class=cl>mount -t nfs 192.168.1.10:/data /mnt/nfs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn mount</span>
</span></span><span class=line><span class=cl>mount -t nfs -o rw,hard,intr server:/data /mnt/nfs
</span></span><span class=line><span class=cl>mount -t nfs -o <span class=nv>vers</span><span class=o>=</span><span class=m>4</span> server:/data /mnt/nfs      <span class=c1># Buộc NFSv4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn phổ biến:</span>
</span></span><span class=line><span class=cl><span class=c1># rw/ro:          Đọc-ghi / Chỉ đọc</span>
</span></span><span class=line><span class=cl><span class=c1># hard:           Thử lại mãi nếu server down (mặc định)</span>
</span></span><span class=line><span class=cl><span class=c1># soft:           Trả lỗi nếu server down</span>
</span></span><span class=line><span class=cl><span class=c1># intr:           Cho phép interrupt thao tác treo</span>
</span></span><span class=line><span class=cl><span class=c1># timeo=n:        Timeout tính bằng 1/10 giây</span>
</span></span><span class=line><span class=cl><span class=c1># retrans=n:      Số lần thử lại</span>
</span></span><span class=line><span class=cl><span class=c1># vers=4:         Phiên bản NFS</span>
</span></span><span class=line><span class=cl><span class=c1># sec=sys:        Chế độ bảo mật (sys, krb5, krb5i, krb5p)</span>
</span></span><span class=line><span class=cl><span class=c1># noatime:        Không cập nhật thời gian truy cập</span>
</span></span><span class=line><span class=cl><span class=c1># nocto:          Tắt tính nhất quán close-to-open</span>
</span></span><span class=line><span class=cl><span class=c1># actimeo=n:      Timeout cache thuộc tính</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount cố định (/etc/fstab)</span>
</span></span><span class=line><span class=cl>server:/data    /mnt/nfs    nfs    defaults,_netdev    <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># AutoFS (mount theo yêu cầu)</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/auto.master</span>
</span></span><span class=line><span class=cl>/mnt/nfs    /etc/auto.nfs    --timeout<span class=o>=</span><span class=m>300</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /etc/auto.nfs</span>
</span></span><span class=line><span class=cl>data    -rw,soft    server:/data
</span></span><span class=line><span class=cl>home    -rw,soft    server:/home
</span></span><span class=line><span class=cl><span class=c1># Truy cập /mnt/nfs/data → tự động mount server:/data</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=94-xử-lý-sự-cố-nfs><span>9.4 Xử lý sự cố NFS</span>
<a href=#94-x%e1%bb%ad-l%c3%bd-s%e1%bb%b1-c%e1%bb%91-nfs class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Kiểm tra dịch vụ NFS</span>
</span></span><span class=line><span class=cl>systemctl status nfs-server
</span></span><span class=line><span class=cl>systemctl status rpcbind
</span></span><span class=line><span class=cl>rpcinfo -p                  <span class=c1># Liệt kê dịch vụ RPC</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra exports</span>
</span></span><span class=line><span class=cl>exportfs -v
</span></span><span class=line><span class=cl>cat /var/lib/nfs/etab       <span class=c1># Filesystem thực sự exported</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra mount</span>
</span></span><span class=line><span class=cl>mount <span class=p>|</span> grep nfs
</span></span><span class=line><span class=cl>cat /proc/mounts <span class=p>|</span> grep nfs
</span></span><span class=line><span class=cl>nfsstat -m                  <span class=c1># Thống kê mount NFS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thống kê NFS</span>
</span></span><span class=line><span class=cl>nfsstat                     <span class=c1># Thống kê server + client</span>
</span></span><span class=line><span class=cl>nfsstat -s                  <span class=c1># Chỉ server</span>
</span></span><span class=line><span class=cl>nfsstat -c                  <span class=c1># Chỉ client</span>
</span></span><span class=line><span class=cl>nfsstat -o rpc              <span class=c1># Thống kê RPC</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Debug vấn đề mount</span>
</span></span><span class=line><span class=cl>mount -v -t nfs server:/data /mnt/nfs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra kết nối</span>
</span></span><span class=line><span class=cl>rpcinfo -p server_ip
</span></span><span class=line><span class=cl>showmount -e server_ip
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Vấn đề phổ biến:</span>
</span></span><span class=line><span class=cl><span class=c1># 1. Tường lửa chặn cổng</span>
</span></span><span class=line><span class=cl><span class=c1># 2. Lỗi cú pháp /etc/exports</span>
</span></span><span class=line><span class=cl><span class=c1># 3. IP client không trong dải cho phép</span>
</span></span><span class=line><span class=cl><span class=c1># 4. Permission denied (kiểm tra tùy chọn exports)</span>
</span></span><span class=line><span class=cl><span class=c1># 5. Stale file handle (server restart, re-export)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sửa stale file handle</span>
</span></span><span class=line><span class=cl>umount -f /mnt/nfs
</span></span><span class=line><span class=cl><span class=c1># Hoặc</span>
</span></span><span class=line><span class=cl>umount -l /mnt/nfs
</span></span><span class=line><span class=cl>mount server:/data /mnt/nfs</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=95-cifssmb---chia-sẻ-windows><span>9.5 CIFS/SMB - Chia sẻ Windows</span>
<a href=#95-cifssmb---chia-s%e1%ba%bb-windows class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Cài đặt CIFS client</span>
</span></span><span class=line><span class=cl>apt install cifs-utils              <span class=c1># Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>yum install cifs-utils              <span class=c1># RHEL/CentOS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount chia sẻ Windows</span>
</span></span><span class=line><span class=cl>mount -t cifs //server/share /mnt/smb -o <span class=nv>username</span><span class=o>=</span>user,password<span class=o>=</span>pass
</span></span><span class=line><span class=cl>mount -t cifs //192.168.1.10/data /mnt/smb -o <span class=nv>user</span><span class=o>=</span>admin,pass<span class=o>=</span>secret
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># File credentials (an toàn hơn)</span>
</span></span><span class=line><span class=cl><span class=c1># /root/.smbcredentials</span>
</span></span><span class=line><span class=cl><span class=nv>username</span><span class=o>=</span>myuser
</span></span><span class=line><span class=cl><span class=nv>password</span><span class=o>=</span>mypassword
</span></span><span class=line><span class=cl><span class=nv>domain</span><span class=o>=</span>MYDOMAIN
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> /root/.smbcredentials
</span></span><span class=line><span class=cl>mount -t cifs //server/share /mnt/smb -o <span class=nv>credentials</span><span class=o>=</span>/root/.smbcredentials
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn</span>
</span></span><span class=line><span class=cl>mount -t cifs //server/share /mnt/smb -o <span class=nv>credentials</span><span class=o>=</span>/root/.smbcred,uid<span class=o>=</span>1000,gid<span class=o>=</span>1000,file_mode<span class=o>=</span>0644,dir_mode<span class=o>=</span><span class=m>0755</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /etc/fstab</span>
</span></span><span class=line><span class=cl>//server/share  /mnt/smb  cifs  <span class=nv>credentials</span><span class=o>=</span>/root/.smbcred,uid<span class=o>=</span>1000,gid<span class=o>=</span>1000,_netdev  <span class=m>0</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Duyệt chia sẻ</span>
</span></span><span class=line><span class=cl>smbclient -L //server -U user
</span></span><span class=line><span class=cl>smbclient //server/share -U user    <span class=c1># Tương tác</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-10-tiện-ích-đĩa><span>PHẦN 10: TIỆN ÍCH ĐĨA</span>
<a href=#ph%e1%ba%a7n-10-ti%e1%bb%87n-%c3%adch-%c4%91%c4%a9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=101-dd---sao-chép-dữ-liệu><span>10.1 dd - Sao chép dữ liệu</span>
<a href=#101-dd---sao-ch%c3%a9p-d%e1%bb%af-li%e1%bb%87u class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># dd = Chuyển đổi và sao chép file (cấp thấp)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CẢNH BÁO: dd rất nguy hiểm, có thể phá hủy dữ liệu!</span>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra kỹ if= và of= trước khi chạy</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Clone đĩa/phân vùng</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/sda <span class=nv>of</span><span class=o>=</span>/dev/sdb <span class=nv>bs</span><span class=o>=</span>64K <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/sda1 <span class=nv>of</span><span class=o>=</span>/dev/sdb1 <span class=nv>bs</span><span class=o>=</span>64K <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo ảnh đĩa</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/sda <span class=nv>of</span><span class=o>=</span>/backup/sda.img <span class=nv>bs</span><span class=o>=</span>64K <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Phục hồi ảnh đĩa</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/backup/sda.img <span class=nv>of</span><span class=o>=</span>/dev/sda <span class=nv>bs</span><span class=o>=</span>64K <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo USB bootable</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>ubuntu.iso <span class=nv>of</span><span class=o>=</span>/dev/sdb <span class=nv>bs</span><span class=o>=</span>4M <span class=nv>status</span><span class=o>=</span>progress <span class=nv>conv</span><span class=o>=</span>fdatasync
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa đĩa (điền zero)</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>/dev/sdb <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa an toàn (dữ liệu ngẫu nhiên)</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/urandom <span class=nv>of</span><span class=o>=</span>/dev/sdb <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo file kích thước cụ thể</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>testfile <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>count</span><span class=o>=</span><span class=m>100</span>    <span class=c1># File 100MB</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Benchmark tốc độ đĩa</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>testfile <span class=nv>bs</span><span class=o>=</span>1G <span class=nv>count</span><span class=o>=</span><span class=m>1</span> <span class=nv>oflag</span><span class=o>=</span>direct  <span class=c1># Ghi</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>testfile <span class=nv>of</span><span class=o>=</span>/dev/null <span class=nv>bs</span><span class=o>=</span>1G <span class=nv>count</span><span class=o>=</span><span class=m>1</span> <span class=nv>iflag</span><span class=o>=</span>direct  <span class=c1># Đọc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn:</span>
</span></span><span class=line><span class=cl><span class=c1># if=         File đầu vào</span>
</span></span><span class=line><span class=cl><span class=c1># of=         File đầu ra</span>
</span></span><span class=line><span class=cl><span class=c1># bs=         Kích thước block</span>
</span></span><span class=line><span class=cl><span class=c1># count=      Số block</span>
</span></span><span class=line><span class=cl><span class=c1># skip=       Bỏ qua block ở đầu đầu vào</span>
</span></span><span class=line><span class=cl><span class=c1># seek=       Bỏ qua block ở đầu đầu ra</span>
</span></span><span class=line><span class=cl><span class=c1># status=     Hiện tiến độ (none, noxfer, progress)</span>
</span></span><span class=line><span class=cl><span class=c1># conv=       Tùy chọn chuyển đổi</span>
</span></span><span class=line><span class=cl><span class=c1>#   fdatasync: Sync trước khi thoát</span>
</span></span><span class=line><span class=cl><span class=c1>#   fsync:     Sync dữ liệu + metadata</span>
</span></span><span class=line><span class=cl><span class=c1>#   notrunc:   Không cắt bớt đầu ra</span>
</span></span><span class=line><span class=cl><span class=c1>#   noerror:   Tiếp tục khi lỗi đọc</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=102-mkisofs---tạo-ảnh-iso><span>10.2 mkisofs - Tạo ảnh ISO</span>
<a href=#102-mkisofs---t%e1%ba%a1o-%e1%ba%a3nh-iso class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># mkisofs / genisoimage = Tạo ảnh filesystem ISO 9660</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ISO cơ bản</span>
</span></span><span class=line><span class=cl>mkisofs -o output.iso /path/to/directory
</span></span><span class=line><span class=cl>genisoimage -o output.iso /path/to/directory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với tùy chọn</span>
</span></span><span class=line><span class=cl>mkisofs -o output.iso <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -V <span class=s2>&#34;Nhãn Volume&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -A <span class=s2>&#34;ID Ứng dụng&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -J <span class=se>\ </span>                   <span class=c1># Mở rộng Joliet (Windows)</span>
</span></span><span class=line><span class=cl>    -r <span class=se>\ </span>                   <span class=c1># Mở rộng Rock Ridge (Unix)</span>
</span></span><span class=line><span class=cl>    -v <span class=se>\ </span>                   <span class=c1># Verbose</span>
</span></span><span class=line><span class=cl>    /path/to/directory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ISO bootable (BIOS)</span>
</span></span><span class=line><span class=cl>mkisofs -o output.iso <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -b isolinux/isolinux.bin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -c isolinux/boot.cat <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -no-emul-boot <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -boot-load-size <span class=m>4</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -boot-info-table <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    /path/to/directory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ISO bootable (UEFI)</span>
</span></span><span class=line><span class=cl>mkisofs -o output.iso <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -eltorito-alt-boot <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -e images/efiboot.img <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -no-emul-boot <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    /path/to/directory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount ISO</span>
</span></span><span class=line><span class=cl>mount -o loop output.iso /mnt/iso</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=103-giám-sát-smart><span>10.3 Giám sát SMART</span>
<a href=#103-gi%c3%a1m-s%c3%a1t-smart class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># smartctl = Giám sát đĩa SMART (từ smartmontools)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra SMART có hỗ trợ không</span>
</span></span><span class=line><span class=cl>smartctl -i /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bật SMART</span>
</span></span><span class=line><span class=cl>smartctl -s on /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra sức khỏe (nhanh)</span>
</span></span><span class=line><span class=cl>smartctl -H /dev/sda
</span></span><span class=line><span class=cl><span class=c1># PASSED = OK</span>
</span></span><span class=line><span class=cl><span class=c1># FAILED = Thay đĩa NGAY!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thông tin đầy đủ</span>
</span></span><span class=line><span class=cl>smartctl -a /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chạy self-test</span>
</span></span><span class=line><span class=cl>smartctl -t short /dev/sda      <span class=c1># ~2 phút</span>
</span></span><span class=line><span class=cl>smartctl -t long /dev/sda       <span class=c1># ~vài giờ</span>
</span></span><span class=line><span class=cl>smartctl -t conveyance /dev/sda <span class=c1># ~vài phút (sau khi vận chuyển)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem kết quả test</span>
</span></span><span class=line><span class=cl>smartctl -l selftest /dev/sda
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thuộc tính quan trọng cần theo dõi:</span>
</span></span><span class=line><span class=cl><span class=c1># 5:   Reallocated_Sector_Ct - Sector xấu đã remap</span>
</span></span><span class=line><span class=cl><span class=c1># 187: Reported_Uncorrect - Lỗi không sửa được</span>
</span></span><span class=line><span class=cl><span class=c1># 188: Command_Timeout - Lệnh thất bại</span>
</span></span><span class=line><span class=cl><span class=c1># 197: Current_Pending_Sector - Đang chờ remap</span>
</span></span><span class=line><span class=cl><span class=c1># 198: Offline_Uncorrectable - Không thể remap</span>
</span></span><span class=line><span class=cl><span class=c1># 199: UDMA_CRC_Error_Count - Lỗi cáp/giao diện</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># NVMe</span>
</span></span><span class=line><span class=cl>smartctl -a /dev/nvme0n1
</span></span><span class=line><span class=cl>nvme smart-log /dev/nvme0n1</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=104-fstrim---trim-cho-ssd><span>10.4 fstrim - TRIM cho SSD</span>
<a href=#104-fstrim---trim-cho-ssd class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># fstrim = Loại bỏ block không dùng (tối ưu SSD)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TRIM filesystem đơn lẻ</span>
</span></span><span class=line><span class=cl>fstrim -v /
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TRIM tất cả filesystem đã mount</span>
</span></span><span class=line><span class=cl>fstrim -a -v
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># TRIM theo lịch (khuyến nghị)</span>
</span></span><span class=line><span class=cl>systemctl <span class=nb>enable</span> fstrim.timer
</span></span><span class=line><span class=cl>systemctl start fstrim.timer
</span></span><span class=line><span class=cl><span class=c1># Chạy hàng tuần theo mặc định</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra hỗ trợ TRIM</span>
</span></span><span class=line><span class=cl>lsblk -D
</span></span><span class=line><span class=cl><span class=c1># DISC-GRAN DISC-MAX = Khác 0 nghĩa là hỗ trợ TRIM</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn mount (TRIM liên tục - không khuyến nghị)</span>
</span></span><span class=line><span class=cl><span class=c1># Trong /etc/fstab:</span>
</span></span><span class=line><span class=cl><span class=nv>UUID</span><span class=o>=</span>xxx  /  ext4  defaults,discard  <span class=m>0</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=c1># Dùng fstrim.timer thay vì tùy chọn mount discard</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=tóm-tắt-nhanh><span>TÓM TẮT NHANH</span>
<a href=#t%c3%b3m-t%e1%ba%aft-nhanh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=thông-tin-đĩa><span>Thông tin đĩa</span>
<a href=#th%c3%b4ng-tin-%c4%91%c4%a9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>lsblk -f                    <span class=c1># Thiết bị khối + thông tin filesystem</span>
</span></span><span class=line><span class=cl>blkid                       <span class=c1># UUID, loại, nhãn</span>
</span></span><span class=line><span class=cl>fdisk -l                    <span class=c1># Bảng phân vùng</span>
</span></span><span class=line><span class=cl>df -hT                      <span class=c1># Dung lượng đĩa đã dùng</span>
</span></span><span class=line><span class=cl>du -sh *                    <span class=c1># Kích thước thư mục</span>
</span></span><span class=line><span class=cl>findmnt                     <span class=c1># Cây mount</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=phân-vùng><span>Phân vùng</span>
<a href=#ph%c3%a2n-v%c3%b9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>fdisk /dev/sda              <span class=c1># Phân vùng MBR</span>
</span></span><span class=line><span class=cl>gdisk /dev/sda              <span class=c1># Phân vùng GPT</span>
</span></span><span class=line><span class=cl>parted /dev/sda             <span class=c1># Cả MBR/GPT</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=filesystem><span>Filesystem</span>
<a href=#filesystem class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkfs.ext4 /dev/sda1         <span class=c1># Tạo ext4</span>
</span></span><span class=line><span class=cl>mkfs.xfs /dev/sda1          <span class=c1># Tạo XFS</span>
</span></span><span class=line><span class=cl>fsck /dev/sda1              <span class=c1># Kiểm tra/sửa (unmount trước!)</span>
</span></span><span class=line><span class=cl>tune2fs -l /dev/sda1        <span class=c1># Thông tin ext4</span>
</span></span><span class=line><span class=cl>resize2fs /dev/sda1         <span class=c1># Thay đổi kích thước ext4</span>
</span></span><span class=line><span class=cl>xfs_growfs /mount           <span class=c1># Mở rộng XFS</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=mount><span>Mount</span>
<a href=#mount class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mount /dev/sda1 /mnt        <span class=c1># Mount</span>
</span></span><span class=line><span class=cl>umount /mnt                 <span class=c1># Unmount</span>
</span></span><span class=line><span class=cl>mount -a                    <span class=c1># Mount tất cả từ fstab</span>
</span></span><span class=line><span class=cl>mount -o remount,rw /       <span class=c1># Remount với tùy chọn</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=lvm><span>LVM</span>
<a href=#lvm class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># PV</span>
</span></span><span class=line><span class=cl>pvcreate /dev/sdb1
</span></span><span class=line><span class=cl>pvs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># VG</span>
</span></span><span class=line><span class=cl>vgcreate vg_name /dev/sdb1
</span></span><span class=line><span class=cl>vgextend vg_name /dev/sdc1
</span></span><span class=line><span class=cl>vgs
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># LV</span>
</span></span><span class=line><span class=cl>lvcreate -L 50G -n lv_name vg_name
</span></span><span class=line><span class=cl>lvextend -r -L +10G /dev/vg_name/lv_name
</span></span><span class=line><span class=cl>lvs</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=swap><span>Swap</span>
<a href=#swap class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>mkswap /dev/sdb1
</span></span><span class=line><span class=cl>swapon /dev/sdb1
</span></span><span class=line><span class=cl>swapoff /dev/sdb1
</span></span><span class=line><span class=cl>swapon --show</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=giám-sát-io><span>Giám sát I/O</span>
<a href=#gi%c3%a1m-s%c3%a1t-io class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>iostat -xdh <span class=m>1</span>               <span class=c1># Thống kê I/O</span>
</span></span><span class=line><span class=cl>iotop -o                    <span class=c1># I/O theo tiến trình</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=nfs><span>NFS</span>
<a href=#nfs class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Server</span>
</span></span><span class=line><span class=cl>/etc/exports                <span class=c1># Định nghĩa chia sẻ</span>
</span></span><span class=line><span class=cl>exportfs -ra                <span class=c1># Áp dụng exports</span>
</span></span><span class=line><span class=cl>showmount -e                <span class=c1># Hiện exports</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Client</span>
</span></span><span class=line><span class=cl>showmount -e server         <span class=c1># Liệt kê exports của server</span>
</span></span><span class=line><span class=cl>mount -t nfs server:/share /mnt</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=tiện-ích><span>Tiện ích</span>
<a href=#ti%e1%bb%87n-%c3%adch class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/sda <span class=nv>of</span><span class=o>=</span>disk.img <span class=nv>bs</span><span class=o>=</span>64K <span class=nv>status</span><span class=o>=</span>progress
</span></span><span class=line><span class=cl>smartctl -a /dev/sda        <span class=c1># Sức khỏe SMART</span>
</span></span><span class=line><span class=cl>fstrim -av                  <span class=c1># TRIM SSD</span></span></span></code></pre></td></tr></table></div></div></div><hr class=awesome-hr><h2 id=see-also>Nội dung liên quan</h2><ul><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li></ul><div class=collection-card><div class="collection-title text-secondary">Trong <a href=/collections/linux-cli/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>Bộ sưu tập・Linux Cli</span></span></a> 10</div><div class=collection-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ class=collection-nav-item rel=prev title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i><span>Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</span>
</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ class=collection-nav-item rel=next title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu"><span>Linux User & Group Management - Hướng Dẫn Chuyên Sâu</span><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Cập nhật ngày 2025-12-11 16:05:24">Cập nhật ngày 2025-12-11&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Chia sẻ trên X" data-sharer=twitter data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ data-title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu" data-hashtags="ai generated post"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên Facebook" data-sharer=facebook data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ data-hashtag="ai generated post"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên 微博" data-sharer=weibo data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ data-title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ai-generated-post/ class=post-tag title="Nhãn - Ai Generated Post">Ai Generated Post</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Quay lại</a></span>&nbsp;|&nbsp;<span><a href=/>Trang chủ</a></span></section></div><div class=post-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ class=post-nav-item rel=prev title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ class=post-nav-item rel=next title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label="Nội dung"><h2 class=toc-title>Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><dialog id=toc-dialog aria-labelledby=toc-dialog-title role=dialog><div class=toc><h2 class=toc-title>Nội dung</h2><div class=toc-content id=toc-content-drawer><nav><ul><li><ul><li><a href=#phần-1-nền-tảng-lưu-trữ>PHẦN 1: NỀN TẢNG LƯU TRỮ</a><ul><li><a href=#11-tổng-quan-storage-stack>1.1 Tổng quan Storage Stack</a></li><li><a href=#12-quy-ước-đặt-tên-thiết-bị-khối>1.2 Quy ước đặt tên thiết bị khối</a></li><li><a href=#13-bảng-phân-vùng-mbr-vs-gpt>1.3 Bảng phân vùng: MBR vs GPT</a></li></ul></li><li><a href=#phần-2-lệnh-thông-tin-đĩa>PHẦN 2: LỆNH THÔNG TIN ĐĨA</a><ul><li><a href=#21-lsblk---liệt-kê-thiết-bị-khối>2.1 lsblk - Liệt kê thiết bị khối</a></li><li><a href=#22-blkid---thuộc-tính-thiết-bị-khối>2.2 blkid - Thuộc tính thiết bị khối</a></li><li><a href=#23-df---dung-lượng-đĩa-trống>2.3 df - Dung lượng đĩa trống</a></li><li><a href=#24-du---dung-lượng-đã-dùng>2.4 du - Dung lượng đã dùng</a></li><li><a href=#25-findmnt---tìm-filesystem-đã-mount>2.5 findmnt - Tìm filesystem đã mount</a></li></ul></li><li><a href=#phần-3-phân-vùng>PHẦN 3: PHÂN VÙNG</a><ul><li><a href=#31-fdisk---phân-vùng-mbr>3.1 fdisk - Phân vùng MBR</a></li><li><a href=#32-parted---phân-vùng-hiện-đại-gpt--mbr>3.2 parted - Phân vùng hiện đại (GPT + MBR)</a></li><li><a href=#33-gdisk---fdisk-cho-gpt>3.3 gdisk - fdisk cho GPT</a></li></ul></li><li><a href=#phần-4-hệ-thống-tệp>PHẦN 4: HỆ THỐNG TỆP</a><ul><li><a href=#41-khái-niệm-filesystem>4.1 Khái niệm Filesystem</a></li><li><a href=#42-mkfs---tạo-filesystem>4.2 mkfs - Tạo Filesystem</a></li><li><a href=#43-fsck---kiểm-tra-filesystem>4.3 fsck - Kiểm tra Filesystem</a></li><li><a href=#44-tune2fs---điều-chỉnh-filesystem-ext>4.4 tune2fs - Điều chỉnh Filesystem ext</a></li><li><a href=#45-resize2fs--xfs_growfs---thay-đổi-kích-thước-filesystem>4.5 resize2fs & xfs_growfs - Thay đổi kích thước Filesystem</a></li></ul></li><li><a href=#phần-5-mount--unmount>PHẦN 5: MOUNT & UNMOUNT</a><ul><li><a href=#51-mount---gắn-kết-filesystem>5.1 mount - Gắn kết Filesystem</a></li><li><a href=#52-umount---tháo-gắn-kết-filesystem>5.2 umount - Tháo gắn kết Filesystem</a></li><li><a href=#53-etcfstab---mount-cố-định>5.3 /etc/fstab - Mount cố định</a></li><li><a href=#54-systemd-mount-units>5.4 Systemd Mount Units</a></li></ul></li><li><a href=#phần-6-lvm---logical-volume-manager>PHẦN 6: LVM - LOGICAL VOLUME MANAGER</a><ul><li><a href=#61-khái-niệm-lvm>6.1 Khái niệm LVM</a></li><li><a href=#62-lệnh-physical-volume-pv>6.2 Lệnh Physical Volume (PV)</a></li><li><a href=#63-lệnh-volume-group-vg>6.3 Lệnh Volume Group (VG)</a></li><li><a href=#64-lệnh-logical-volume-lv>6.4 Lệnh Logical Volume (LV)</a></li><li><a href=#65-thao-tác-thay-đổi-kích-thước-lvm>6.5 Thao tác thay đổi kích thước LVM</a></li><li><a href=#66-lvm-snapshot>6.6 LVM Snapshot</a></li><li><a href=#67-lvm-thin-provisioning>6.7 LVM Thin Provisioning</a></li></ul></li><li><a href=#phần-7-quản-lý-swap>PHẦN 7: QUẢN LÝ SWAP</a><ul><li><a href=#71-khái-niệm-swap>7.1 Khái niệm Swap</a></li><li><a href=#72-mkswap-swapon-swapoff>7.2 mkswap, swapon, swapoff</a></li></ul></li><li><a href=#phần-8-giám-sát-io>PHẦN 8: GIÁM SÁT I/O</a><ul><li><a href=#81-iostat---thống-kê-io>8.1 iostat - Thống kê I/O</a></li><li><a href=#82-iotop---io-theo-tiến-trình>8.2 iotop - I/O theo tiến trình</a></li><li><a href=#83-bộ-lập-lịch-io>8.3 Bộ lập lịch I/O</a></li></ul></li><li><a href=#phần-9-hệ-thống-tệp-mạng>PHẦN 9: HỆ THỐNG TỆP MẠNG</a><ul><li><a href=#91-kiến-trúc-nfs>9.1 Kiến trúc NFS</a></li><li><a href=#92-cài-đặt-nfs-server>9.2 Cài đặt NFS Server</a></li><li><a href=#93-nfs-client>9.3 NFS Client</a></li><li><a href=#94-xử-lý-sự-cố-nfs>9.4 Xử lý sự cố NFS</a></li><li><a href=#95-cifssmb---chia-sẻ-windows>9.5 CIFS/SMB - Chia sẻ Windows</a></li></ul></li><li><a href=#phần-10-tiện-ích-đĩa>PHẦN 10: TIỆN ÍCH ĐĨA</a><ul><li><a href=#101-dd---sao-chép-dữ-liệu>10.1 dd - Sao chép dữ liệu</a></li><li><a href=#102-mkisofs---tạo-ảnh-iso>10.2 mkisofs - Tạo ảnh ISO</a></li><li><a href=#103-giám-sát-smart>10.3 Giám sát SMART</a></li><li><a href=#104-fstrim---trim-cho-ssd>10.4 fstrim - TRIM cho SSD</a></li></ul></li><li><a href=#tóm-tắt-nhanh>TÓM TẮT NHANH</a><ul><li><a href=#thông-tin-đĩa>Thông tin đĩa</a></li><li><a href=#phân-vùng>Phân vùng</a></li><li><a href=#filesystem>Filesystem</a></li><li><a href=#mount>Mount</a></li><li><a href=#lvm>LVM</a></li><li><a href=#swap>Swap</a></li><li><a href=#giám-sát-io>Giám sát I/O</a></li><li><a href=#nfs>NFS</a></li><li><a href=#tiện-ích>Tiện ích</a></li></ul></li></ul></li></ul></nav></div></div></dialog></main><footer class=footer><div class=footer-container><div class="footer-line powered">Cung cấp bởi <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.0"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Chủ đề - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span></div></div></footer></div><div class=widgets><div class=fixed-buttons><div class="fixed-button back-to-top animate__faster" role=button aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><svg viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="50"/><circle class="progress" cx="50" cy="50" r="50"/></svg></div><div id=toc-drawer-button class="fixed-button toc-drawer-button" role=button aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></div></div><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/instant-page/instantpage.min.js async defer type=module></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>