<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=vi><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu - Kaizen - tốt hơn mỗi ngày</title><meta name=author content="Kaizen Teams"><meta name=description content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta name=keywords content='ai generated post'><meta itemprop=name content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta itemprop=description content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta itemprop=datePublished content="2025-12-11T06:17:23+07:00"><meta itemprop=dateModified content="2025-12-11T16:05:24+07:00"><meta itemprop=wordCount content="11864"><meta itemprop=keywords content="Ai Generated Post"><meta property="og:url" content="https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/"><meta property="og:site_name" content="Kaizen - tốt hơn mỗi ngày"><meta property="og:title" content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta property="og:description" content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta property="og:locale" content="vi"><meta property="og:type" content="article"><meta property="article:section" content="bai-viet"><meta property="article:published_time" content="2025-12-11T06:17:23+07:00"><meta property="article:modified_time" content="2025-12-11T16:05:24+07:00"><meta property="article:tag" content="Ai Generated Post"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta name=twitter:description content="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><meta name=application-name content="Kaizen - tốt hơn mỗi ngày"><meta name=apple-mobile-web-app-title content="Kaizen - tốt hơn mỗi ngày"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#2d89ef"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#FF7359><link rel=manifest href=/site.webmanifest><link rel=canonical type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu - Kaizen - tốt hơn mỗi ngày"><link rel=prev type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu"><link rel=next type=text/html href=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/selinux/ title="Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc"><link rel=stylesheet href=/css/config.min.css><link rel=stylesheet href=/css/style.min.css><link rel=preload href=/lib/fontawesome-free/all.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/fontawesome-free/all.min.css></noscript><link rel=preload href=/lib/animate/animate.min.css as=style onload='this.removeAttribute("onload"),this.rel="stylesheet"'><noscript><link rel=stylesheet href=/lib/animate/animate.min.css></noscript><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Linux Cryptography \u0026 Security Tools - Hướng Dẫn Chuyên Sâu","inLanguage":"vi","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/encryption-and-security\/"},"image":[{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}],"genre":"posts","keywords":"ai generated post","wordcount":11864,"url":"https:\/\/vanvuvuong.github.io\/bai-viet\/khoa-hoc-may-tinh\/linux-cli\/encryption-and-security\/","datePublished":"2025-12-11T06:17:23+07:00","dateModified":"2025-12-11T16:05:24+07:00","publisher":{"@type":"Organization","name":"Kaizen","logo":{"@type":"ImageObject","url":"https:\/\/vanvuvuong.github.io\/images\/avatar.jpeg","width":330,"height":330}},"author":{"@type":"Person","name":"Kaizen Teams"},"description":"Linux Cryptography \u0026 Security Tools - Hướng Dẫn Chuyên Sâu"}</script><script src=/js/head/color-scheme.min.js></script></head><body data-instant-intensity=viewport data-header-desktop=sticky data-header-mobile=auto><div class=wrapper data-page-style=normal><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=32 width=32><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class="menu-item has-children"><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a><i class="dropdown-icon fa-solid fa-chevron-down" aria-hidden=true></i><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title="Kaizen - tốt hơn mỗi ngày"><img class=logo src=/images/kaizen-logo.png alt="Kaizen - tốt hơn mỗi ngày" height=26 width=26><span class=header-title-text>Kaizen</span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder="Tìm tiêu đề hoặc nội dung..." id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title="Tìm kiếm"><i class="fa-solid fa-search fa-fw" aria-hidden=true></i>
</a><a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=Xoá><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i>
</a><span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>Huỷ</a></li><li class=menu-item><a class=menu-link href=/gioi-thieu><i class="fa-solid fa-comments fa-fw fa-sm" aria-hidden=true></i> Giới thiệu</a></li><li class=menu-item><span class=nested-item><a class=menu-link href=/bai-viet><i class="fa-solid fa-newspaper fa-fw fa-sm" aria-hidden=true></i> Bài viết</a>
<i class="dropdown-icon fa-solid fa-chevron-right" aria-hidden=true></i></span><ul class=sub-menu><li class=menu-item><a class=menu-link href=/bai-viet/khoa-hoc-may-tinh><i class="fa-solid fa-laptop fa-fw fa-sm" aria-hidden=true></i> Khoa học máy tính</a></li><li class=menu-item><a class=menu-link href=/bai-viet/cuoc-song><i class="fa-solid fa-life-ring fa-fw fa-sm" aria-hidden=true></i> Cuộc sống</a></li><li class=menu-item><a class=menu-link href=/bai-viet/hoc-vien-luat-tu-nhien><i class="fa-solid fa-dragon fa-fw fa-sm" aria-hidden=true></i> Học viện luật tự nhiên</a></li><li class=menu-item><a class=menu-link href=/collections><i class="fa-solid fa-layer-group fa-fw fa-sm" aria-hidden=true></i> Bộ sưu tập</a></li><li class=menu-item><a class=menu-link href=/tags><i class="fa-solid fa-tags fa-fw fa-sm" aria-hidden=true></i> Tags</a></li></ul></li><li class=menu-item><a class=menu-link href=/sach-hay><i class="fa-solid fa-book fa-fw fa-sm" aria-hidden=true></i> Sách hay</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title="Đổi chủ đề"><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><main class=fi-container><aside class="aside-collection animate__animated animate__fadeIn animate__faster" aria-label="Bộ sưu tập"><div class="details collection-details open"><div class="details-summary collection-summary"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i>
<span class=collection-name title="Bộ sưu tập">Linux Cli</span>
<span class=collection-count>10</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content collection-content"><nav><ul class=collection-list><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/shell-co-ban/ title="Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux">Những Điều Cơ Bản Về Bash & Fish Shell Trong Linux</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/grep-diff-sort/ title="Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu">Grep, Sort, Diff - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/network/ title="Linux Network Commands - Hướng Dẫn Chuyên Sâu">Linux Network Commands - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><span class=active title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu">Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu</span></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu">Linux Package Management - Hướng Dẫn Chuyên Sâu</a></li><li class=collection-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/selinux/ title="Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc">Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc</a></li></ul><div class=collection-nav-simple><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ class=collection-nav-item rel=prev title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i></a><span class=text-secondary>8/10</span><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ class=collection-nav-item rel=next title="Linux Package Management - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></nav></div></div><div class="details related-details open"><div class="details-summary related-summary"><i class="fa-solid fa-fire fa-fade text-danger fa-fw" aria-hidden=true></i>
<span class=related-title>Nội dung liên quan</span><i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class="details-content related-content"><ul class=related-list><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu">Linux Package Management - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li class=related-item><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li></ul></div></div></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=https://vanvuvuong.github.io title="Tác giả" target=_blank rel="external nofollow noopener noreferrer author" class=author><i class="fa-solid fa-user-circle" aria-hidden=true></i>
Kaizen Teams</a></span><span class=post-included-in>&nbsp;trong <a href=/collections/linux-cli/ class=post-collection title="Bộ sưu tập - Linux Cli"><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> Linux Cli</a></span></div><div class=post-meta-line><span title="đăng ngày 2025-12-11 06:17:23"><i class="fa-solid fa-calendar-days fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-11>2025-12-11</time></span>&nbsp;<span title="Cập nhật ngày 2025-12-11 16:05:24"><i class="fa-regular fa-calendar-check fa-fw me-1" aria-hidden=true></i><time datetime=2025-12-11>2025-12-11</time></span>&nbsp;<span title="11864 từ"><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>Khoảng 11900 từ</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>56 phút</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=false><div class="details-summary toc-title"><span>Nội dung</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><ul><li><a href=#phần-1-nền-tảng-mật-mã-học>PHẦN 1: NỀN TẢNG MẬT MÃ HỌC</a><ul><li><a href=#11-hàm-băm-hash-functions>1.1 Hàm băm (Hash Functions)</a></li><li><a href=#12-so-sánh-thuật-toán-băm>1.2 So sánh thuật toán băm</a></li><li><a href=#13-mã-hóa-đối-xứng-vs-bất-đối-xứng>1.3 Mã hóa đối xứng vs Bất đối xứng</a></li><li><a href=#14-chữ-ký-số-digital-signatures>1.4 Chữ ký số (Digital Signatures)</a></li><li><a href=#15-độ-mạnh-khóa-tương-đương>1.5 Độ mạnh khóa tương đương</a></li></ul></li><li><a href=#phần-2-checksum--hashing>PHẦN 2: CHECKSUM & HASHING</a><ul><li><a href=#21-cksum---crc-checksum>2.1 cksum - CRC Checksum</a></li><li><a href=#22-md5sum---md5-hash-lỗi-thời>2.2 md5sum - MD5 Hash (Lỗi thời)</a></li><li><a href=#23-sha-family---sha1sum-đến-sha512sum>2.3 SHA Family - sha1sum đến sha512sum</a></li><li><a href=#24-b2sum---blake2-hash>2.4 b2sum - BLAKE2 Hash</a></li><li><a href=#25-quy-trình-thực-tế-với-hash>2.5 Quy trình thực tế với Hash</a></li></ul></li><li><a href=#phần-3-gpg---gnu-privacy-guard>PHẦN 3: GPG - GNU PRIVACY GUARD</a><ul><li><a href=#31-kiến-trúc-gpg>3.1 Kiến trúc GPG</a></li><li><a href=#32-tạo-và-quản-lý-khóa>3.2 Tạo và quản lý khóa</a></li><li><a href=#33-mã-hóa-và-giải-mã>3.3 Mã hóa và Giải mã</a></li><li><a href=#34-ký-và-xác-thực>3.4 Ký và Xác thực</a></li><li><a href=#35-tin-cậy-và-keyserver>3.5 Tin cậy và Keyserver</a></li><li><a href=#36-cấu-hình-gpg>3.6 Cấu hình GPG</a></li></ul></li><li><a href=#phần-4-ssh-key-management>PHẦN 4: SSH KEY MANAGEMENT</a><ul><li><a href=#41-so-sánh-loại-khóa-ssh>4.1 So sánh loại khóa SSH</a></li><li><a href=#42-ssh-keygen---tạo-và-quản-lý-khóa>4.2 ssh-keygen - Tạo và quản lý khóa</a></li><li><a href=#43-ssh-agent>4.3 SSH Agent</a></li><li><a href=#44-triển-khai-khóa-ssh>4.4 Triển khai khóa SSH</a></li><li><a href=#45-ssh-certificates-nâng-cao>4.5 SSH Certificates (Nâng cao)</a></li></ul></li><li><a href=#phần-5-openssl>PHẦN 5: OPENSSL</a><ul><li><a href=#51-hash-và-hmac>5.1 Hash và HMAC</a></li><li><a href=#52-mã-hóa-đối-xứng>5.2 Mã hóa đối xứng</a></li><li><a href=#53-khóa-rsa-và-ec>5.3 Khóa RSA và EC</a></li><li><a href=#54-chứng-chỉ-x509>5.4 Chứng chỉ X.509</a></li><li><a href=#55-kiểm-tra-tlsssl>5.5 Kiểm tra TLS/SSL</a></li><li><a href=#56-tạo-số-ngẫu-nhiên>5.6 Tạo số ngẫu nhiên</a></li></ul></li><li><a href=#phần-6-mã-hóa-file>PHẦN 6: MÃ HÓA FILE</a><ul><li><a href=#61-age---công-cụ-mã-hóa-hiện-đại>6.1 age - Công cụ mã hóa hiện đại</a></li><li><a href=#62-luks---mã-hóa-ổ-đĩa>6.2 LUKS - Mã hóa ổ đĩa</a></li><li><a href=#63-fscrypt---mã-hóa-thư-mục>6.3 fscrypt - Mã hóa thư mục</a></li></ul></li><li><a href=#phần-7-quản-lý-mật-khẩu>PHẦN 7: QUẢN LÝ MẬT KHẨU</a><ul><li><a href=#71-pass---unix-password-manager>7.1 pass - Unix Password Manager</a></li><li><a href=#72-secret-tool---gnome-keyring-cli>7.2 secret-tool - GNOME Keyring CLI</a></li><li><a href=#73-tạo-mật-khẩu-mạnh>7.3 Tạo mật khẩu mạnh</a></li></ul></li><li><a href=#phần-8-xóa-file-an-toàn>PHẦN 8: XÓA FILE AN TOÀN</a><ul><li><a href=#81-shred---ghi-đè-file>8.1 shred - Ghi đè file</a></li><li><a href=#82-secure-delete>8.2 secure-delete</a></li><li><a href=#83-file-tạm-an-toàn>8.3 File tạm an toàn</a></li><li><a href=#84-thuộc-tính-file>8.4 Thuộc tính file</a></li></ul></li><li><a href=#phần-9-bảo-mật-mạng>PHẦN 9: BẢO MẬT MẠNG</a><ul><li><a href=#91-kiểm-tra-ssltls>9.1 Kiểm tra SSL/TLS</a></li><li><a href=#92-ssh-hardening>9.2 SSH Hardening</a></li><li><a href=#93-xác-thực-gpg-cho-download>9.3 Xác thực GPG cho download</a></li></ul></li><li><a href=#phần-10-quy-trình-thực-tế>PHẦN 10: QUY TRÌNH THỰC TẾ</a><ul><li><a href=#101-backup-mã-hóa>10.1 Backup mã hóa</a></li><li><a href=#102-truyền-file-an-toàn>10.2 Truyền file an toàn</a></li><li><a href=#103-rotate-ssh-keys>10.3 Rotate SSH keys</a></li></ul></li><li><a href=#tóm-tắt-nhanh>TÓM TẮT NHANH</a><ul><li><a href=#lệnh-hash>Lệnh Hash</a></li><li><a href=#lệnh-gpg>Lệnh GPG</a></li><li><a href=#lệnh-ssh>Lệnh SSH</a></li><li><a href=#lệnh-openssl>Lệnh OpenSSL</a></li><li><a href=#hướng-dẫn-chọn-nhanh>Hướng dẫn chọn nhanh</a></li></ul></li></ul></li></ul></nav></div></div><div class=content id=content><h2 class=heading-element id=phần-1-nền-tảng-mật-mã-học><span>PHẦN 1: NỀN TẢNG MẬT MÃ HỌC</span>
<a href=#ph%e1%ba%a7n-1-n%e1%bb%81n-t%e1%ba%a3ng-m%e1%ba%adt-m%c3%a3-h%e1%bb%8dc class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=11-hàm-băm-hash-functions><span>1.1 Hàm băm (Hash Functions)</span>
<a href=#11-h%c3%a0m-b%c4%83m-hash-functions class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    HÀM BĂM CRYPTOGRAPHIC                    │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Định nghĩa: Hàm một chiều biến đầu vào có độ dài bất kỳ thành
</span></span><span class=line><span class=cl>đầu ra có độ dài cố định (digest/hash).
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ TÍNH CHẤT                                                   │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 1. MỘT CHIỀU (Preimage Resistance)                          │
</span></span><span class=line><span class=cl>│    Cho hash H, không thể tìm được input M sao cho hash(M)=H │
</span></span><span class=line><span class=cl>│    Độ phức tạp: O(2^n) với n = số bit của hash              │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 2. KHÁNG VA CHẠM YẾU (Second Preimage Resistance)           │
</span></span><span class=line><span class=cl>│    Cho M1, không thể tìm M2 ≠ M1 sao cho hash(M1)=hash(M2)  │
</span></span><span class=line><span class=cl>│    Độ phức tạp: O(2^n)                                      │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 3. KHÁNG VA CHẠM MẠNH (Collision Resistance)                │
</span></span><span class=line><span class=cl>│    Không thể tìm bất kỳ cặp M1, M2 sao cho hash(M1)=hash(M2)│
</span></span><span class=line><span class=cl>│    Độ phức tạp: O(2^(n/2)) do Birthday Attack               │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 4. HIỆU ỨNG TUYẾT LỞ (Avalanche Effect)                     │
</span></span><span class=line><span class=cl>│    Thay đổi 1 bit input → thay đổi ~50% bit output          │
</span></span><span class=line><span class=cl>│    &#34;password1&#34; → a7b9c3d4e5f6...                            │
</span></span><span class=line><span class=cl>│    &#34;password2&#34; → 8f2e1a9b7c4d... (hoàn toàn khác!)          │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ ỨNG DỤNG                                                    │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 1. KIỂM TRA TOÀN VẸN                                        │
</span></span><span class=line><span class=cl>│    Tải file → so sánh hash với hash gốc → phát hiện thay đổi│
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 2. LƯU TRỮ MẬT KHẨU                                         │
</span></span><span class=line><span class=cl>│    Lưu hash(password + salt), không lưu password gốc        │
</span></span><span class=line><span class=cl>│    Dùng hàm chậm: bcrypt, Argon2 (KHÔNG DÙNG SHA trực tiếp) │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 3. CHỮ KÝ SỐ                                                │
</span></span><span class=line><span class=cl>│    Ký hash của tài liệu thay vì ký toàn bộ tài liệu         │
</span></span><span class=line><span class=cl>│    Nhanh hơn vì hash có kích thước cố định                  │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 4. LOẠI BỎ TRÙNG LẶP (Deduplication)                        │
</span></span><span class=line><span class=cl>│    So sánh hash thay vì so sánh nội dung file               │
</span></span><span class=line><span class=cl>│    O(1) thay vì O(n) với n = kích thước file                │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│ 5. CÂY MERKLE (Merkle Tree)                                 │
</span></span><span class=line><span class=cl>│    Cấu trúc cây hash cho xác thực dữ liệu phân tán          │
</span></span><span class=line><span class=cl>│    Dùng trong: Git, Blockchain, BitTorrent                  │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=12-so-sánh-thuật-toán-băm><span>1.2 So sánh thuật toán băm</span>
<a href=#12-so-s%c3%a1nh-thu%e1%ba%adt-to%c3%a1n-b%c4%83m class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              SO SÁNH THUẬT TOÁN BĂM                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌───────────┬────────┬─────────────┬──────────────────────────────┐
</span></span><span class=line><span class=cl>│ Thuật toán│ Bit    │ Trạng thái  │ Ghi chú                      │
</span></span><span class=line><span class=cl>├───────────┼────────┼─────────────┼──────────────────────────────┤
</span></span><span class=line><span class=cl>│ CRC32     │ 32     │ KHÔNG MÃ HÓA│ Chỉ phát hiện lỗi truyền     │
</span></span><span class=line><span class=cl>│           │        │             │ Không chống giả mạo          │
</span></span><span class=line><span class=cl>├───────────┼────────┼─────────────┼──────────────────────────────┤
</span></span><span class=line><span class=cl>│ MD5       │ 128    │ BỊ PHÁ      │ Tấn công va chạm 2^18        │
</span></span><span class=line><span class=cl>│           │        │             │ KHÔNG dùng cho bảo mật       │
</span></span><span class=line><span class=cl>├───────────┼────────┼─────────────┼──────────────────────────────┤
</span></span><span class=line><span class=cl>│ SHA-1     │ 160    │ BỊ PHÁ      │ Tấn công va chạm 2^63        │
</span></span><span class=line><span class=cl>│           │        │             │ Không dùng cho chứng chỉ     │
</span></span><span class=line><span class=cl>├───────────┼────────┼─────────────┼──────────────────────────────┤
</span></span><span class=line><span class=cl>│ SHA-256   │ 256    │ AN TOÀN     │ KHUYẾN NGHỊ cho đa số        │
</span></span><span class=line><span class=cl>│ SHA-384   │ 384    │ AN TOÀN     │ Dùng khi cần bảo mật cao     │
</span></span><span class=line><span class=cl>│ SHA-512   │ 512    │ AN TOÀN     │ Nhanh hơn SHA-256 trên 64-bit│
</span></span><span class=line><span class=cl>├───────────┼────────┼─────────────┼──────────────────────────────┤
</span></span><span class=line><span class=cl>│ SHA3-256  │ 256    │ AN TOÀN     │ Thiết kế khác SHA-2          │
</span></span><span class=line><span class=cl>│ SHA3-512  │ 512    │ AN TOÀN     │ Dự phòng nếu SHA-2 bị phá    │
</span></span><span class=line><span class=cl>├───────────┼────────┼─────────────┼──────────────────────────────┤
</span></span><span class=line><span class=cl>│ BLAKE2b   │ 512    │ AN TOÀN     │ Nhanh hơn MD5, an toàn       │
</span></span><span class=line><span class=cl>│ BLAKE3    │ 256    │ AN TOÀN     │ Song song hóa, cực nhanh     │
</span></span><span class=line><span class=cl>└───────────┴────────┴─────────────┴──────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>KHUYẾN NGHỊ 2024+:
</span></span><span class=line><span class=cl>- Kiểm tra toàn vẹn: SHA-256, BLAKE2b
</span></span><span class=line><span class=cl>- Mật khẩu: Argon2id, bcrypt (KHÔNG PHẢI SHA!)
</span></span><span class=line><span class=cl>- Chữ ký số: SHA-256, SHA-384
</span></span><span class=line><span class=cl>- Hiệu năng cao: BLAKE3</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=13-mã-hóa-đối-xứng-vs-bất-đối-xứng><span>1.3 Mã hóa đối xứng vs Bất đối xứng</span>
<a href=#13-m%c3%a3-h%c3%b3a-%c4%91%e1%bb%91i-x%e1%bb%a9ng-vs-b%e1%ba%a5t-%c4%91%e1%bb%91i-x%e1%bb%a9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              MÃ HÓA ĐỐI XỨNG (Symmetric)                    │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Cùng khóa dùng để mã hóa và giải mã.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│    Văn bản gốc                      Văn bản gốc             │
</span></span><span class=line><span class=cl>│         │                                ▲                  │
</span></span><span class=line><span class=cl>│         ▼                                │                  │
</span></span><span class=line><span class=cl>│   ┌───────────┐                    ┌───────────┐            │
</span></span><span class=line><span class=cl>│   │  MÃ HÓA   │───── Bản mã ──────►│ GIẢI MÃ   │            │
</span></span><span class=line><span class=cl>│   └─────┬─────┘                    └─────┬─────┘            │
</span></span><span class=line><span class=cl>│         │                                │                  │
</span></span><span class=line><span class=cl>│         ▼                                ▼                  │
</span></span><span class=line><span class=cl>│    ┌─────────┐                      ┌─────────┐             │
</span></span><span class=line><span class=cl>│    │  KHÓA   │══════════════════════│  KHÓA   │             │
</span></span><span class=line><span class=cl>│    │  BÍ MẬT │    (CÙNG KHÓA)       │  BÍ MẬT │             │
</span></span><span class=line><span class=cl>│    └─────────┘                      └─────────┘             │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│  Ưu điểm: Nhanh (1000x so với bất đối xứng)                 │
</span></span><span class=line><span class=cl>│  Nhược điểm: Làm sao trao đổi khóa an toàn?                 │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│  Thuật toán: AES-256-GCM, ChaCha20-Poly1305                 │
</span></span><span class=line><span class=cl>│  Độ dài khóa: 128-bit, 256-bit                              │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              MÃ HÓA BẤT ĐỐI XỨNG (Asymmetric)               │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Cặp khóa: Khóa công khai (mã hóa) + Khóa riêng tư (giải mã)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│    Văn bản gốc                      Văn bản gốc             │
</span></span><span class=line><span class=cl>│         │                                ▲                  │
</span></span><span class=line><span class=cl>│         ▼                                │                  │
</span></span><span class=line><span class=cl>│   ┌───────────┐                    ┌───────────┐            │
</span></span><span class=line><span class=cl>│   │  MÃ HÓA   │───── Bản mã ──────►│ GIẢI MÃ   │            │
</span></span><span class=line><span class=cl>│   └─────┬─────┘                    └─────┬─────┘            │
</span></span><span class=line><span class=cl>│         │                                │                  │
</span></span><span class=line><span class=cl>│         ▼                                ▼                  │
</span></span><span class=line><span class=cl>│    ┌─────────┐                      ┌─────────┐             │
</span></span><span class=line><span class=cl>│    │  KHÓA   │                      │  KHÓA   │             │
</span></span><span class=line><span class=cl>│    │CÔNG KHAI│                      │RIÊNG TƯ │             │
</span></span><span class=line><span class=cl>│    └─────────┘                      └─────────┘             │
</span></span><span class=line><span class=cl>│    (Ai cũng có)                     (Chỉ chủ có)            │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│  Ưu điểm: Giải quyết vấn đề trao đổi khóa                   │
</span></span><span class=line><span class=cl>│  Nhược điểm: Chậm, chỉ mã hóa dữ liệu nhỏ                   │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│  Thuật toán: RSA (2048-4096 bit), ECC (256-384 bit)         │
</span></span><span class=line><span class=cl>│  Thực tế: Mã hóa khóa đối xứng, rồi dùng khóa đó mã hóa data│
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              MÃ HÓA LAI (Hybrid Encryption)                 │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Kết hợp cả hai: Bất đối xứng trao đổi khóa, Đối xứng mã hóa data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Người gửi                          Người nhận
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>      │  1. Tạo khóa phiên ngẫu nhiên    │
</span></span><span class=line><span class=cl>      │     (session key, 256-bit)       │
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>      │  2. Mã hóa data bằng khóa phiên  │
</span></span><span class=line><span class=cl>      │     (AES-256-GCM, nhanh)         │
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>      │  3. Mã hóa khóa phiên bằng       │
</span></span><span class=line><span class=cl>      │     khóa công khai người nhận    │
</span></span><span class=line><span class=cl>      │     (RSA/ECC, chậm nhưng ngắn)   │
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>      │  4. Gửi: [khóa phiên mã hóa]     │
</span></span><span class=line><span class=cl>      │         + [data mã hóa]          │
</span></span><span class=line><span class=cl>      │─────────────────────────────────►│
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>      │                    5. Giải mã khóa phiên
</span></span><span class=line><span class=cl>      │                       bằng khóa riêng tư
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>      │                    6. Giải mã data
</span></span><span class=line><span class=cl>      │                       bằng khóa phiên
</span></span><span class=line><span class=cl>      │                                  │
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ví dụ: TLS/HTTPS, GPG, SSH đều dùng hybrid encryption</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=14-chữ-ký-số-digital-signatures><span>1.4 Chữ ký số (Digital Signatures)</span>
<a href=#14-ch%e1%bb%af-k%c3%bd-s%e1%bb%91-digital-signatures class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    CHỮ KÝ SỐ                                │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Ký bằng khóa riêng tư, xác thực bằng khóa công khai
</span></span><span class=line><span class=cl>(Ngược với mã hóa!)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ QUÁ TRÌNH KÝ                                                │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│    Tài liệu                                                 │
</span></span><span class=line><span class=cl>│        │                                                    │
</span></span><span class=line><span class=cl>│        ▼                                                    │
</span></span><span class=line><span class=cl>│   ┌─────────┐                                               │
</span></span><span class=line><span class=cl>│   │   BĂM   │ ──► Hash (256-bit)                            │
</span></span><span class=line><span class=cl>│   └─────────┘          │                                    │
</span></span><span class=line><span class=cl>│                        ▼                                    │
</span></span><span class=line><span class=cl>│                  ┌───────────┐                              │
</span></span><span class=line><span class=cl>│                  │    KÝ     │◄── Khóa riêng tư             │
</span></span><span class=line><span class=cl>│                  └─────┬─────┘                              │
</span></span><span class=line><span class=cl>│                        │                                    │
</span></span><span class=line><span class=cl>│                        ▼                                    │
</span></span><span class=line><span class=cl>│                   Chữ ký số                                 │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│   Gửi đi: [Tài liệu] + [Chữ ký số]                          │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ QUÁ TRÌNH XÁC THỰC                                          │
</span></span><span class=line><span class=cl>├─────────────────────────────────────────────────────────────┤
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>│   Tài liệu          Chữ ký số                               │
</span></span><span class=line><span class=cl>│       │                  │                                  │
</span></span><span class=line><span class=cl>│       ▼                  ▼                                  │
</span></span><span class=line><span class=cl>│  ┌─────────┐       ┌───────────┐                            │
</span></span><span class=line><span class=cl>│  │   BĂM   │       │ XÁC THỰC  │◄── Khóa công khai          │
</span></span><span class=line><span class=cl>│  └────┬────┘       └─────┬─────┘                            │
</span></span><span class=line><span class=cl>│       │                  │                                  │
</span></span><span class=line><span class=cl>│       ▼                  ▼                                  │
</span></span><span class=line><span class=cl>│    Hash A             Hash B                                │
</span></span><span class=line><span class=cl>│       │                  │                                  │
</span></span><span class=line><span class=cl>│       └────── SO SÁNH ───┘                                  │
</span></span><span class=line><span class=cl>│                  │                                          │
</span></span><span class=line><span class=cl>│                  ▼                                          │
</span></span><span class=line><span class=cl>│          Khớp = Hợp lệ                                      │
</span></span><span class=line><span class=cl>│        Không khớp = Giả mạo                                 │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ĐẢM BẢO:
</span></span><span class=line><span class=cl>- Xác thực (Authentication): Chứng minh ai là người ký
</span></span><span class=line><span class=cl>- Toàn vẹn (Integrity): Tài liệu không bị sửa đổi
</span></span><span class=line><span class=cl>- Không thể chối bỏ (Non-repudiation): Người ký không thể phủ nhận
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>THUẬT TOÁN:
</span></span><span class=line><span class=cl>- RSA-PSS: Phổ biến, tương thích tốt
</span></span><span class=line><span class=cl>- ECDSA: Chữ ký ngắn hơn, nhanh hơn
</span></span><span class=line><span class=cl>- Ed25519: KHUYẾN NGHỊ - nhanh, an toàn, xác định (deterministic)</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=15-độ-mạnh-khóa-tương-đương><span>1.5 Độ mạnh khóa tương đương</span>
<a href=#15-%c4%91%e1%bb%99-m%e1%ba%a1nh-kh%c3%b3a-t%c6%b0%c6%a1ng-%c4%91%c6%b0%c6%a1ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              ĐỘ MẠNH KHÓA TƯƠNG ĐƯƠNG                       │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Các loại khóa khác nhau cung cấp cùng mức bảo mật:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────┬───────────┬───────────┬───────────────────────┐
</span></span><span class=line><span class=cl>│ Đối xứng    │ RSA/DH    │ ECC       │ Hash (kháng va chạm)  │
</span></span><span class=line><span class=cl>│ (bit)       │ (bit)     │ (bit)     │ (bit)                 │
</span></span><span class=line><span class=cl>├─────────────┼───────────┼───────────┼───────────────────────┤
</span></span><span class=line><span class=cl>│ 80          │ 1024      │ 160       │ 160                   │
</span></span><span class=line><span class=cl>│ 112         │ 2048      │ 224       │ 224                   │
</span></span><span class=line><span class=cl>│ 128         │ 3072      │ 256       │ 256 (SHA-256)         │
</span></span><span class=line><span class=cl>│ 192         │ 7680      │ 384       │ 384 (SHA-384)         │
</span></span><span class=line><span class=cl>│ 256         │ 15360     │ 512       │ 512 (SHA-512)         │
</span></span><span class=line><span class=cl>└─────────────┴───────────┴───────────┴───────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>GIẢI THÍCH:
</span></span><span class=line><span class=cl>- 128-bit đối xứng = 3072-bit RSA = 256-bit ECC
</span></span><span class=line><span class=cl>- ECC hiệu quả hơn nhiều: khóa ngắn, cùng độ bảo mật
</span></span><span class=line><span class=cl>- RSA 2048-bit ≈ 112-bit đối xứng (đủ cho hiện tại)
</span></span><span class=line><span class=cl>- RSA 4096-bit ≈ 140-bit đối xứng (cho tương lai)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>KHUYẾN NGHỊ 2024+:
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│ Loại             │ Khuyến nghị       │ Tối thiểu            │
</span></span><span class=line><span class=cl>├──────────────────┼───────────────────┼──────────────────────┤
</span></span><span class=line><span class=cl>│ RSA              │ 4096-bit          │ 2048-bit             │
</span></span><span class=line><span class=cl>│ ECC              │ P-256, X25519     │ P-256                │
</span></span><span class=line><span class=cl>│ Đối xứng         │ AES-256           │ AES-128              │
</span></span><span class=line><span class=cl>│ Hash             │ SHA-256           │ SHA-256              │
</span></span><span class=line><span class=cl>│ Chữ ký           │ Ed25519           │ ECDSA P-256          │
</span></span><span class=line><span class=cl>└──────────────────┴───────────────────┴──────────────────────┘</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-2-checksum--hashing><span>PHẦN 2: CHECKSUM & HASHING</span>
<a href=#ph%e1%ba%a7n-2-checksum--hashing class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=21-cksum---crc-checksum><span>2.1 cksum - CRC Checksum</span>
<a href=#21-cksum---crc-checksum class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># cksum - Tạo checksum CRC32</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CRC = Cyclic Redundancy Check (Kiểm tra dư thừa vòng)</span>
</span></span><span class=line><span class=cl><span class=c1># Dùng phép chia đa thức, KHÔNG PHẢI mã hóa!</span>
</span></span><span class=line><span class=cl><span class=c1># Chỉ phát hiện lỗi truyền, KHÔNG chống giả mạo</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp cơ bản</span>
</span></span><span class=line><span class=cl>cksum file.txt
</span></span><span class=line><span class=cl><span class=c1># Kết quả: 3915230286 1024 file.txt</span>
</span></span><span class=line><span class=cl><span class=c1>#          └─CRC32─┘ └size┘ └─tên─┘</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nhiều file</span>
</span></span><span class=line><span class=cl>cksum *.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Từ stdin</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;kiểm tra&#34;</span> <span class=p>|</span> cksum
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># THUẬT TOÁN CRC32</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Coi dữ liệu như đa thức nhị phân</span>
</span></span><span class=line><span class=cl><span class=c1># 2. Chia cho đa thức sinh (generator polynomial)</span>
</span></span><span class=line><span class=cl><span class=c1># 3. Phần dư = CRC</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Độ phức tạp: O(n) với n = kích thước file</span>
</span></span><span class=line><span class=cl><span class=c1># Tăng tốc phần cứng: CPU có instruction CRC32C</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ƯU ĐIỂM:</span>
</span></span><span class=line><span class=cl><span class=c1># - Cực nhanh</span>
</span></span><span class=line><span class=cl><span class=c1># - Phát hiện lỗi bit đơn, burst errors</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># NHƯỢC ĐIỂM:</span>
</span></span><span class=line><span class=cl><span class=c1># - Dễ tạo va chạm có chủ đích</span>
</span></span><span class=line><span class=cl><span class=c1># - KHÔNG AN TOÀN cho bảo mật!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KHI NÀO DÙNG cksum</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ✓ Kiểm tra lỗi truyền tải</span>
</span></span><span class=line><span class=cl><span class=c1># ✓ Phát hiện file hỏng ngẫu nhiên</span>
</span></span><span class=line><span class=cl><span class=c1># ✓ Cần tốc độ cao, không cần bảo mật</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ KHÔNG dùng cho xác thực file download</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ KHÔNG dùng khi có kẻ tấn công</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ KHÔNG dùng cho chữ ký số</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=22-md5sum---md5-hash-lỗi-thời><span>2.2 md5sum - MD5 Hash (Lỗi thời)</span>
<a href=#22-md5sum---md5-hash-l%e1%bb%97i-th%e1%bb%9di class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># md5sum - Tạo hash MD5 128-bit</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CẢNH BÁO: MD5 đã BỊ PHÁ!</span>
</span></span><span class=line><span class=cl><span class=c1># Tấn công va chạm: ~2^18 operations (vài giây)</span>
</span></span><span class=line><span class=cl><span class=c1># CHỈ dùng khi tương thích với hệ thống cũ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp cơ bản</span>
</span></span><span class=line><span class=cl>md5sum file.txt
</span></span><span class=line><span class=cl><span class=c1># d41d8cd98f00b204e9800998ecf8427e  file.txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nhiều file</span>
</span></span><span class=line><span class=cl>md5sum *.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Từ stdin</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;test&#34;</span> <span class=p>|</span> md5sum
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Định dạng BSD (một số hệ thống cũ)</span>
</span></span><span class=line><span class=cl>md5sum --tag file.txt
</span></span><span class=line><span class=cl><span class=c1># MD5 (file.txt) = d41d8cd98f00b204e9800998ecf8427e</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÁC THỰC FILE</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo file checksum</span>
</span></span><span class=line><span class=cl>md5sum file1.txt file2.txt &gt; checksums.md5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực</span>
</span></span><span class=line><span class=cl>md5sum -c checksums.md5
</span></span><span class=line><span class=cl><span class=c1># file1.txt: OK</span>
</span></span><span class=line><span class=cl><span class=c1># file2.txt: OK</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tùy chọn xác thực</span>
</span></span><span class=line><span class=cl>md5sum -c checksums.md5 --quiet      <span class=c1># Chỉ hiện lỗi</span>
</span></span><span class=line><span class=cl>md5sum -c checksums.md5 --status     <span class=c1># Không in gì, chỉ exit code</span>
</span></span><span class=line><span class=cl>md5sum -c checksums.md5 --warn       <span class=c1># Cảnh báo dòng sai định dạng</span>
</span></span><span class=line><span class=cl>md5sum -c checksums.md5 --ignore-missing  <span class=c1># Bỏ qua file thiếu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠI SAO MD5 BỊ PHÁ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Năm 2004: Tìm được va chạm</span>
</span></span><span class=line><span class=cl><span class=c1># Năm 2008: Tạo chứng chỉ SSL giả bằng va chạm MD5</span>
</span></span><span class=line><span class=cl><span class=c1># Năm 2012: Malware Flame dùng va chạm MD5</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># Hai file khác nhau, cùng MD5:</span>
</span></span><span class=line><span class=cl><span class=c1># File A: [dữ liệu hợp lệ] + [padding đặc biệt]</span>
</span></span><span class=line><span class=cl><span class=c1># File B: [mã độc]         + [padding khác]</span>
</span></span><span class=line><span class=cl><span class=c1># md5sum(A) == md5sum(B) ← NGUY HIỂM!</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># KHÔNG BAO GIỜ tin MD5 cho bảo mật!</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=23-sha-family---sha1sum-đến-sha512sum><span>2.3 SHA Family - sha1sum đến sha512sum</span>
<a href=#23-sha-family---sha1sum-%c4%91%e1%ba%bfn-sha512sum class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SHA FAMILY - Secure Hash Algorithm</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-1: 160-bit - BỊ PHÁ, không dùng cho bảo mật</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-224: 224-bit - Ít dùng</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-256: 256-bit - KHUYẾN NGHỊ, chuẩn công nghiệp</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-384: 384-bit - Bảo mật cao hơn</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-512: 512-bit - Nhanh hơn SHA-256 trên CPU 64-bit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-1 (KHÔNG KHUYẾN NGHỊ)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sha1sum file.txt
</span></span><span class=line><span class=cl><span class=c1># da39a3ee5e6b4b0d3255bfef95601890afd80709  file.txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CẢNH BÁO: SHA-1 bị phá năm 2017 (SHAttered attack)</span>
</span></span><span class=line><span class=cl><span class=c1># Google và CWI tạo được 2 PDF khác nhau, cùng SHA-1</span>
</span></span><span class=line><span class=cl><span class=c1># Chi phí: ~$110,000 tính toán</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-256 (KHUYẾN NGHỊ)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sha256sum file.txt
</span></span><span class=line><span class=cl><span class=c1># e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855  file.txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo file checksum</span>
</span></span><span class=line><span class=cl>sha256sum *.iso &gt; SHA256SUMS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực</span>
</span></span><span class=line><span class=cl>sha256sum -c SHA256SUMS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-384 và SHA-512</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sha384sum file.txt
</span></span><span class=line><span class=cl><span class=c1># 38b060a751ac96384cd9327eb1b1e36a21fdb71114be...  file.txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>sha512sum file.txt
</span></span><span class=line><span class=cl><span class=c1># cf83e1357eefb8bdf1542850d66d8007d620e4050b57...  file.txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-512 nhanh hơn SHA-256 trên CPU 64-bit vì:</span>
</span></span><span class=line><span class=cl><span class=c1># - SHA-256 dùng phép toán 32-bit</span>
</span></span><span class=line><span class=cl><span class=c1># - SHA-512 dùng phép toán 64-bit (native trên CPU 64-bit)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># shasum - Công cụ hợp nhất (phổ biến trên macOS)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>shasum file.txt              <span class=c1># Mặc định SHA-1</span>
</span></span><span class=line><span class=cl>shasum -a <span class=m>256</span> file.txt       <span class=c1># SHA-256</span>
</span></span><span class=line><span class=cl>shasum -a <span class=m>384</span> file.txt       <span class=c1># SHA-384</span>
</span></span><span class=line><span class=cl>shasum -a <span class=m>512</span> file.txt       <span class=c1># SHA-512</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>shasum -a <span class=m>256</span> -c SHA256SUMS  <span class=c1># Xác thực</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÁC THỰC DOWNLOAD (QUY TRÌNH CHUẨN)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Tải file và checksum từ website chính thức</span>
</span></span><span class=line><span class=cl>wget https://example.com/file.iso
</span></span><span class=line><span class=cl>wget https://example.com/SHA256SUMS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Xác thực</span>
</span></span><span class=line><span class=cl>sha256sum -c SHA256SUMS 2&gt;/dev/null <span class=p>|</span> grep file.iso
</span></span><span class=line><span class=cl><span class=c1># file.iso: OK</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hoặc so sánh thủ công</span>
</span></span><span class=line><span class=cl>sha256sum file.iso
</span></span><span class=line><span class=cl><span class=c1># So sánh với giá trị trên website</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Nếu có chữ ký GPG (tốt hơn!)</span>
</span></span><span class=line><span class=cl>wget https://example.com/SHA256SUMS.gpg
</span></span><span class=line><span class=cl>gpg --verify SHA256SUMS.gpg SHA256SUMS
</span></span><span class=line><span class=cl>sha256sum -c SHA256SUMS</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=24-b2sum---blake2-hash><span>2.4 b2sum - BLAKE2 Hash</span>
<a href=#24-b2sum---blake2-hash class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># b2sum - BLAKE2b Hash</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BLAKE2b: Nhanh hơn MD5, an toàn như SHA-3</span>
</span></span><span class=line><span class=cl><span class=c1># Thiết kế bởi nhóm tạo Argon2 (hash mật khẩu thắng giải)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp cơ bản (mặc định 512-bit)</span>
</span></span><span class=line><span class=cl>b2sum file.txt
</span></span><span class=line><span class=cl><span class=c1># 786a02f742015903c6c6fd852552d272912f4740e15847618a86e217f71f5419d25e1031afee...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Độ dài tùy chỉnh (tối đa 512-bit = 64 bytes)</span>
</span></span><span class=line><span class=cl>b2sum -l <span class=m>256</span> file.txt    <span class=c1># 256-bit output</span>
</span></span><span class=line><span class=cl>b2sum -l <span class=m>128</span> file.txt    <span class=c1># 128-bit output</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực</span>
</span></span><span class=line><span class=cl>b2sum *.txt &gt; BLAKE2SUMS
</span></span><span class=line><span class=cl>b2sum -c BLAKE2SUMS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠI SAO DÙNG BLAKE2</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HIỆU NĂNG (trên CPU hiện đại):</span>
</span></span><span class=line><span class=cl><span class=c1># BLAKE2b: ~1 GB/s</span>
</span></span><span class=line><span class=cl><span class=c1># SHA-256: ~500 MB/s</span>
</span></span><span class=line><span class=cl><span class=c1># MD5:     ~600 MB/s</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># BLAKE2 nhanh hơn MD5 mà vẫn an toàn!</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ỨNG DỤNG:</span>
</span></span><span class=line><span class=cl><span class=c1># - WireGuard VPN dùng BLAKE2s</span>
</span></span><span class=line><span class=cl><span class=c1># - Argon2 (hash mật khẩu) dùng BLAKE2b</span>
</span></span><span class=line><span class=cl><span class=c1># - IPFS dùng BLAKE2b</span>
</span></span><span class=line><span class=cl><span class=c1># - RAR5 dùng BLAKE2sp</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># BLAKE3 (Mới hơn, nhanh hơn)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BLAKE3: Có thể song song hóa, cực nhanh</span>
</span></span><span class=line><span class=cl><span class=c1># Cài đặt: cargo install b3sum (cần Rust)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># b3sum file.txt</span>
</span></span><span class=line><span class=cl><span class=c1># Nhanh gấp nhiều lần BLAKE2 trên CPU đa nhân</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=25-quy-trình-thực-tế-với-hash><span>2.5 Quy trình thực tế với Hash</span>
<a href=#25-quy-tr%c3%acnh-th%e1%bb%b1c-t%e1%ba%bf-v%e1%bb%9bi-hash class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÁC THỰC FILE DOWNLOAD</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl><span class=c1># verify_download.sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>URL</span><span class=o>=</span><span class=s2>&#34;https://example.com/software.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>EXPECTED_SHA256</span><span class=o>=</span><span class=s2>&#34;abc123...&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tải file</span>
</span></span><span class=line><span class=cl>wget -q <span class=s2>&#34;</span><span class=nv>$URL</span><span class=s2>&#34;</span> -O software.tar.gz
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tính hash</span>
</span></span><span class=line><span class=cl><span class=nv>ACTUAL_SHA256</span><span class=o>=</span><span class=k>$(</span>sha256sum software.tar.gz <span class=p>|</span> cut -d<span class=s1>&#39; &#39;</span> -f1<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># So sánh</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> <span class=s2>&#34;</span><span class=nv>$ACTUAL_SHA256</span><span class=s2>&#34;</span> <span class=o>=</span> <span class=s2>&#34;</span><span class=nv>$EXPECTED_SHA256</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;✓ Xác thực thành công&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;✗ Hash không khớp!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;  Mong đợi: </span><span class=nv>$EXPECTED_SHA256</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;  Thực tế:  </span><span class=nv>$ACTUAL_SHA256</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    rm software.tar.gz
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO CHECKSUM CHO THƯ MỤC</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tất cả file trong thư mục</span>
</span></span><span class=line><span class=cl>find /path/to/dir -type f -exec sha256sum <span class=o>{}</span> <span class=se>\;</span> &gt; checksums.sha256
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực sau</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> /path/to/dir
</span></span><span class=line><span class=cl>sha256sum -c checksums.sha256
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># PHÁT HIỆN THAY ĐỔI FILE (IDS đơn giản)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo baseline</span>
</span></span><span class=line><span class=cl>find /etc -type f -exec sha256sum <span class=o>{}</span> <span class=se>\;</span> 2&gt;/dev/null &gt; /root/baseline.sha256
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra định kỳ (cron)</span>
</span></span><span class=line><span class=cl>sha256sum -c /root/baseline.sha256 2&gt;/dev/null <span class=p>|</span> grep -v <span class=s2>&#34;: OK</span>$<span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Hiện file đã thay đổi hoặc mất</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TÌM FILE TRÙNG LẶP BẰNG HASH</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm file trùng trong thư mục</span>
</span></span><span class=line><span class=cl>find . -type f -exec sha256sum <span class=o>{}</span> <span class=se>\;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    sort <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    uniq -d -w <span class=m>64</span>
</span></span><span class=line><span class=cl><span class=c1># -w 64: so sánh 64 ký tự đầu (hash SHA-256)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># HASH FILE LỚN (Streaming)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Không cần load toàn bộ file vào RAM</span>
</span></span><span class=line><span class=cl><span class=c1># Hash xử lý từng block, O(n) với n = kích thước file</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kết hợp với pv để xem tiến trình</span>
</span></span><span class=line><span class=cl>pv large_file.iso <span class=p>|</span> sha256sum
</span></span><span class=line><span class=cl><span class=c1># 10.5GiB 0:01:23 [125MiB/s] [=========&gt;] 100%</span>
</span></span><span class=line><span class=cl><span class=c1># a1b2c3d4e5f6...  -</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-3-gpg---gnu-privacy-guard><span>PHẦN 3: GPG - GNU PRIVACY GUARD</span>
<a href=#ph%e1%ba%a7n-3-gpg---gnu-privacy-guard class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=31-kiến-trúc-gpg><span>3.1 Kiến trúc GPG</span>
<a href=#31-ki%e1%ba%bfn-tr%c3%bac-gpg class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                    KIẾN TRÚC KHÓA GPG                       │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│                      KHÓA CHÍNH (Master Key)                │
</span></span><span class=line><span class=cl>│  ┌─────────────────────────────────────────────────────┐    │
</span></span><span class=line><span class=cl>│  │  ID: 0xABCD1234                                     │    │
</span></span><span class=line><span class=cl>│  │  Khả năng: [C] Chứng nhận                           │    │
</span></span><span class=line><span class=cl>│  │  Thuật toán: RSA 4096 hoặc Ed25519                  │    │
</span></span><span class=line><span class=cl>│  │  Hết hạn: 2026-01-01                                │    │
</span></span><span class=line><span class=cl>│  │                                                     │    │
</span></span><span class=line><span class=cl>│  │  UID: Tên Người Dùng &lt;email@example.com&gt;            │    │
</span></span><span class=line><span class=cl>│  └─────────────────────────────────────────────────────┘    │
</span></span><span class=line><span class=cl>│          │                                                  │
</span></span><span class=line><span class=cl>│          ├─────────────────┬─────────────────┐              │
</span></span><span class=line><span class=cl>│          ▼                 ▼                 ▼              │
</span></span><span class=line><span class=cl>│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
</span></span><span class=line><span class=cl>│  │  KHÓA PHỤ    │  │  KHÓA PHỤ    │  │  KHÓA PHỤ    │       │
</span></span><span class=line><span class=cl>│  │  [S] Ký      │  │  [E] Mã hóa  │  │  [A] Xác thực│       │
</span></span><span class=line><span class=cl>│  │  Ed25519     │  │  X25519      │  │  Ed25519     │       │
</span></span><span class=line><span class=cl>│  └──────────────┘  └──────────────┘  └──────────────┘       │
</span></span><span class=line><span class=cl>│                                                             │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>KHẢ NĂNG KHÓA:
</span></span><span class=line><span class=cl>[C] Certify  - Chứng nhận khóa khác (chỉ khóa chính)
</span></span><span class=line><span class=cl>[S] Sign     - Ký tài liệu, email
</span></span><span class=line><span class=cl>[E] Encrypt  - Mã hóa dữ liệu
</span></span><span class=line><span class=cl>[A] Authenticate - Xác thực SSH, TLS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>LỢI ÍCH KHÓA PHỤ:
</span></span><span class=line><span class=cl>- Khóa chính giữ offline an toàn
</span></span><span class=line><span class=cl>- Khóa phụ bị lộ → thu hồi, tạo mới
</span></span><span class=line><span class=cl>- Không cần thu hồi toàn bộ danh tính</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=32-tạo-và-quản-lý-khóa><span>3.2 Tạo và quản lý khóa</span>
<a href=#32-t%e1%ba%a1o-v%c3%a0-qu%e1%ba%a3n-l%c3%bd-kh%c3%b3a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span><span class=lnt>91
</span><span class=lnt>92
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO KHÓA MỚI</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo nhanh với mặc định</span>
</span></span><span class=line><span class=cl>gpg --generate-key
</span></span><span class=line><span class=cl><span class=c1># Nhập tên và email, tạo khóa RSA 3072-bit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo đầy đủ tùy chọn (KHUYẾN NGHỊ)</span>
</span></span><span class=line><span class=cl>gpg --full-generate-key
</span></span><span class=line><span class=cl><span class=c1># Chọn: (1) RSA và RSA hoặc (9) ECC và ECC</span>
</span></span><span class=line><span class=cl><span class=c1># Kích thước: 4096 (RSA) hoặc Curve 25519 (ECC)</span>
</span></span><span class=line><span class=cl><span class=c1># Hết hạn: 2y (2 năm) - KHÔNG để không bao giờ hết hạn!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa nâng cao (chuyên gia)</span>
</span></span><span class=line><span class=cl>gpg --expert --full-generate-key
</span></span><span class=line><span class=cl><span class=c1># Cho phép chọn riêng khả năng cho từng khóa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># LIỆT KÊ KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khóa công khai</span>
</span></span><span class=line><span class=cl>gpg --list-keys
</span></span><span class=line><span class=cl>gpg -k
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khóa riêng tư</span>
</span></span><span class=line><span class=cl>gpg --list-secret-keys
</span></span><span class=line><span class=cl>gpg -K
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chi tiết đầy đủ</span>
</span></span><span class=line><span class=cl>gpg --list-keys --keyid-format long
</span></span><span class=line><span class=cl>gpg --list-keys --fingerprint
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem khả năng khóa</span>
</span></span><span class=line><span class=cl>gpg --list-keys --with-colons
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XUẤT/NHẬP KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất khóa công khai (chia sẻ được)</span>
</span></span><span class=line><span class=cl>gpg --export -a <span class=s2>&#34;email@example.com&#34;</span> &gt; public.asc
</span></span><span class=line><span class=cl>gpg --export --armor KEY_ID &gt; public.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất khóa riêng tư (GIỮ BÍ MẬT!)</span>
</span></span><span class=line><span class=cl>gpg --export-secret-keys -a KEY_ID &gt; private.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nhập khóa</span>
</span></span><span class=line><span class=cl>gpg --import public.asc
</span></span><span class=line><span class=cl>gpg --import private.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CHỈNH SỬA KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>gpg --edit-key KEY_ID
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trong chế độ chỉnh sửa:</span>
</span></span><span class=line><span class=cl><span class=c1># expire    - Đổi ngày hết hạn</span>
</span></span><span class=line><span class=cl><span class=c1># adduid    - Thêm email/danh tính</span>
</span></span><span class=line><span class=cl><span class=c1># deluid    - Xóa danh tính</span>
</span></span><span class=line><span class=cl><span class=c1># addkey    - Thêm khóa phụ</span>
</span></span><span class=line><span class=cl><span class=c1># delkey    - Xóa khóa phụ</span>
</span></span><span class=line><span class=cl><span class=c1># passwd    - Đổi mật khẩu</span>
</span></span><span class=line><span class=cl><span class=c1># trust     - Đặt mức tin cậy</span>
</span></span><span class=line><span class=cl><span class=c1># save      - Lưu và thoát</span>
</span></span><span class=line><span class=cl><span class=c1># quit      - Thoát không lưu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO CHỨNG CHỈ THU HỒI (RẤT QUAN TRỌNG!)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo NGAY sau khi tạo khóa, lưu offline!</span>
</span></span><span class=line><span class=cl>gpg --gen-revoke KEY_ID &gt; revoke.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khi cần thu hồi (khóa bị lộ, mất, v.v.)</span>
</span></span><span class=line><span class=cl>gpg --import revoke.asc
</span></span><span class=line><span class=cl>gpg --send-keys KEY_ID    <span class=c1># Gửi lên keyserver</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÓA KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa khóa công khai</span>
</span></span><span class=line><span class=cl>gpg --delete-keys KEY_ID
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa khóa riêng tư</span>
</span></span><span class=line><span class=cl>gpg --delete-secret-keys KEY_ID
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa cả hai</span>
</span></span><span class=line><span class=cl>gpg --delete-secret-and-public-keys KEY_ID</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=33-mã-hóa-và-giải-mã><span>3.3 Mã hóa và Giải mã</span>
<a href=#33-m%c3%a3-h%c3%b3a-v%c3%a0-gi%e1%ba%a3i-m%c3%a3 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA BẤT ĐỐI XỨNG (Với khóa công khai)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa cho người nhận</span>
</span></span><span class=line><span class=cl>gpg -e -r recipient@example.com file.txt
</span></span><span class=line><span class=cl><span class=c1># Tạo file.txt.gpg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa với nhiều người nhận</span>
</span></span><span class=line><span class=cl>gpg -e -r alice@example.com -r bob@example.com file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Luôn mã hóa cho chính mình (đọc lại được)</span>
</span></span><span class=line><span class=cl>gpg -e -r recipient@example.com --encrypt-to yourself@example.com file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa với armor (văn bản ASCII, gửi email được)</span>
</span></span><span class=line><span class=cl>gpg -e -a -r recipient@example.com file.txt
</span></span><span class=line><span class=cl><span class=c1># Tạo file.txt.asc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA ĐỐI XỨNG (Với mật khẩu)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa bằng mật khẩu (không cần khóa GPG)</span>
</span></span><span class=line><span class=cl>gpg -c file.txt
</span></span><span class=line><span class=cl><span class=c1># Nhập mật khẩu, tạo file.txt.gpg</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ định thuật toán</span>
</span></span><span class=line><span class=cl>gpg -c --cipher-algo AES256 file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với armor</span>
</span></span><span class=line><span class=cl>gpg -c -a file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># GIẢI MÃ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã (tự động phát hiện loại)</span>
</span></span><span class=line><span class=cl>gpg -d file.txt.gpg
</span></span><span class=line><span class=cl><span class=c1># In ra stdout</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã ra file</span>
</span></span><span class=line><span class=cl>gpg -d -o file.txt file.txt.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã không tương tác (script)</span>
</span></span><span class=line><span class=cl>gpg --batch --passphrase <span class=s2>&#34;mật_khẩu&#34;</span> -d file.txt.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA THƯ MỤC</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nén rồi mã hóa</span>
</span></span><span class=line><span class=cl>tar czf - thư_mục/ <span class=p>|</span> gpg -c -o thư_mục.tar.gz.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã và giải nén</span>
</span></span><span class=line><span class=cl>gpg -d thư_mục.tar.gz.gpg <span class=p>|</span> tar xzf -
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với khóa công khai</span>
</span></span><span class=line><span class=cl>tar czf - thư_mục/ <span class=p>|</span> gpg -e -r recipient@example.com -o backup.tar.gz.gpg</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=34-ký-và-xác-thực><span>3.4 Ký và Xác thực</span>
<a href=#34-k%c3%bd-v%c3%a0-x%c3%a1c-th%e1%bb%b1c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KÝ FILE</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chữ ký tách rời (detached signature)</span>
</span></span><span class=line><span class=cl>gpg --detach-sign file.txt
</span></span><span class=line><span class=cl><span class=c1># Tạo file.txt.sig</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chữ ký tách rời dạng ASCII</span>
</span></span><span class=line><span class=cl>gpg -b -a file.txt
</span></span><span class=line><span class=cl><span class=c1># Tạo file.txt.asc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chữ ký rõ ràng (clearsign) - văn bản + chữ ký</span>
</span></span><span class=line><span class=cl>gpg --clearsign document.txt
</span></span><span class=line><span class=cl><span class=c1># Tạo document.txt.asc với nội dung và chữ ký</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký và mã hóa</span>
</span></span><span class=line><span class=cl>gpg -se -r recipient@example.com file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÁC THỰC CHỮ KÝ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực chữ ký tách rời</span>
</span></span><span class=line><span class=cl>gpg --verify file.txt.sig file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực clearsign</span>
</span></span><span class=line><span class=cl>gpg --verify document.txt.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực và giải mã</span>
</span></span><span class=line><span class=cl>gpg -d file.txt.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># gpgv - Xác thực nhẹ (Không cần keyring đầy đủ)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># gpgv dùng cho xác thực tự động (package manager)</span>
</span></span><span class=line><span class=cl><span class=c1># Keyring riêng: ~/.gnupg/trustedkeys.kbx</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nhập khóa tin cậy</span>
</span></span><span class=line><span class=cl>gpg --no-default-keyring --keyring trustedkeys.kbx --import key.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực</span>
</span></span><span class=line><span class=cl>gpgv --keyring trustedkeys.kbx file.sig file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUY TRÌNH XÁC THỰC DOWNLOAD CHUẨN</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Tải file, checksum, và chữ ký</span>
</span></span><span class=line><span class=cl>wget https://example.com/software.tar.gz
</span></span><span class=line><span class=cl>wget https://example.com/SHA256SUMS
</span></span><span class=line><span class=cl>wget https://example.com/SHA256SUMS.gpg
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Nhập khóa ký (một lần)</span>
</span></span><span class=line><span class=cl>gpg --recv-keys KEY_ID
</span></span><span class=line><span class=cl><span class=c1># Hoặc</span>
</span></span><span class=line><span class=cl>gpg --import signing_key.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Xác thực chữ ký của checksum</span>
</span></span><span class=line><span class=cl>gpg --verify SHA256SUMS.gpg SHA256SUMS
</span></span><span class=line><span class=cl><span class=c1># Phải thấy &#34;Good signature from...&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Xác thực file với checksum</span>
</span></span><span class=line><span class=cl>sha256sum -c SHA256SUMS 2&gt;/dev/null <span class=p>|</span> grep software.tar.gz
</span></span><span class=line><span class=cl><span class=c1># software.tar.gz: OK</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=35-tin-cậy-và-keyserver><span>3.5 Tin cậy và Keyserver</span>
<a href=#35-tin-c%e1%ba%ady-v%c3%a0-keyserver class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MỨC ĐỘ TIN CẬY (Trust Levels)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt tin cậy cho khóa</span>
</span></span><span class=line><span class=cl>gpg --edit-key KEY_ID
</span></span><span class=line><span class=cl>trust
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mức tin cậy:</span>
</span></span><span class=line><span class=cl><span class=c1># 1 = Không biết (unknown)</span>
</span></span><span class=line><span class=cl><span class=c1># 2 = Không tin (never)</span>
</span></span><span class=line><span class=cl><span class=c1># 3 = Tin phần nào (marginal)</span>
</span></span><span class=line><span class=cl><span class=c1># 4 = Tin hoàn toàn (full)</span>
</span></span><span class=line><span class=cl><span class=c1># 5 = Tuyệt đối (ultimate) - chỉ cho khóa của mình</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Web of Trust:</span>
</span></span><span class=line><span class=cl><span class=c1># - Khóa được ký bởi người bạn tin → bạn cũng tin khóa đó</span>
</span></span><span class=line><span class=cl><span class=c1># - 1 chữ ký full trust = tin khóa</span>
</span></span><span class=line><span class=cl><span class=c1># - 3 chữ ký marginal trust = tin khóa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KÝ KHÓA (Xác nhận danh tính)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký khóa của người khác (sau khi xác minh fingerprint trực tiếp!)</span>
</span></span><span class=line><span class=cl>gpg --sign-key KEY_ID
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký với mức độ cẩn thận</span>
</span></span><span class=line><span class=cl>gpg --ask-cert-level --sign-key KEY_ID
</span></span><span class=line><span class=cl><span class=c1># 0 = Không nói (no comment)</span>
</span></span><span class=line><span class=cl><span class=c1># 1 = Không kiểm tra (no check)</span>
</span></span><span class=line><span class=cl><span class=c1># 2 = Kiểm tra qua loa (casual check)</span>
</span></span><span class=line><span class=cl><span class=c1># 3 = Kiểm tra kỹ lưỡng (careful check)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất khóa đã ký để gửi cho chủ khóa</span>
</span></span><span class=line><span class=cl>gpg --export -a KEY_ID &gt; signed_key.asc
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KEYSERVER</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Keyserver phổ biến:</span>
</span></span><span class=line><span class=cl><span class=c1># keys.openpgp.org      - Xác thực email, KHUYẾN NGHỊ</span>
</span></span><span class=line><span class=cl><span class=c1># keyserver.ubuntu.com  - Không xác thực</span>
</span></span><span class=line><span class=cl><span class=c1># keys.gnupg.net        - Pool cũ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Gửi khóa lên keyserver</span>
</span></span><span class=line><span class=cl>gpg --keyserver keys.openpgp.org --send-keys KEY_ID
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm khóa</span>
</span></span><span class=line><span class=cl>gpg --keyserver keys.openpgp.org --search-keys email@example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tải khóa</span>
</span></span><span class=line><span class=cl>gpg --keyserver keys.openpgp.org --recv-keys KEY_ID
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Làm mới khóa (cập nhật chữ ký, thu hồi)</span>
</span></span><span class=line><span class=cl>gpg --keyserver keys.openpgp.org --refresh-keys
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># WKD - Web Key Directory (Thay thế Keyserver)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># WKD: Lấy khóa trực tiếp từ domain của email</span>
</span></span><span class=line><span class=cl><span class=c1># email@example.com → https://example.com/.well-known/openpgpkey/...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm khóa qua WKD</span>
</span></span><span class=line><span class=cl>gpg --locate-keys email@example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tự động hơn keyserver, domain chịu trách nhiệm về khóa</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=36-cấu-hình-gpg><span>3.6 Cấu hình GPG</span>
<a href=#36-c%e1%ba%a5u-h%c3%acnh-gpg class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># FILE CẤU HÌNH: ~/.gnupg/gpg.conf</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat &gt; ~/.gnupg/gpg.conf <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s># Thuật toán ưu tiên (mạnh nhất trước)
</span></span></span><span class=line><span class=cl><span class=s>personal-cipher-preferences AES256 AES192 AES
</span></span></span><span class=line><span class=cl><span class=s>personal-digest-preferences SHA512 SHA384 SHA256
</span></span></span><span class=line><span class=cl><span class=s>personal-compress-preferences ZLIB BZIP2 ZIP Uncompressed
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Thuật toán mặc định
</span></span></span><span class=line><span class=cl><span class=s>default-preference-list SHA512 SHA384 SHA256 AES256 AES192 AES ZLIB BZIP2 ZIP Uncompressed
</span></span></span><span class=line><span class=cl><span class=s>cert-digest-algo SHA512
</span></span></span><span class=line><span class=cl><span class=s>s2k-digest-algo SHA512
</span></span></span><span class=line><span class=cl><span class=s>s2k-cipher-algo AES256
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Keyserver
</span></span></span><span class=line><span class=cl><span class=s>keyserver hkps://keys.openpgp.org
</span></span></span><span class=line><span class=cl><span class=s>keyserver-options auto-key-retrieve
</span></span></span><span class=line><span class=cl><span class=s>keyserver-options no-honor-keyserver-url
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Hiển thị
</span></span></span><span class=line><span class=cl><span class=s>keyid-format 0xlong
</span></span></span><span class=line><span class=cl><span class=s>with-fingerprint
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Bảo mật
</span></span></span><span class=line><span class=cl><span class=s>no-emit-version
</span></span></span><span class=line><span class=cl><span class=s>no-comments
</span></span></span><span class=line><span class=cl><span class=s>export-options export-minimal
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Trust model
</span></span></span><span class=line><span class=cl><span class=s>trust-model tofu+pgp
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Quyền truy cập</span>
</span></span><span class=line><span class=cl>chmod <span class=m>700</span> ~/.gnupg
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> ~/.gnupg/*</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-4-ssh-key-management><span>PHẦN 4: SSH KEY MANAGEMENT</span>
<a href=#ph%e1%ba%a7n-4-ssh-key-management class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=41-so-sánh-loại-khóa-ssh><span>4.1 So sánh loại khóa SSH</span>
<a href=#41-so-s%c3%a1nh-lo%e1%ba%a1i-kh%c3%b3a-ssh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>┌─────────────────────────────────────────────────────────────┐
</span></span><span class=line><span class=cl>│              SO SÁNH LOẠI KHÓA SSH                          │
</span></span><span class=line><span class=cl>└─────────────────────────────────────────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>┌──────────┬─────────┬────────────┬───────────────────────────┐
</span></span><span class=line><span class=cl>│ Loại     │ Kích cỡ │ Trạng thái │ Ghi chú                   │
</span></span><span class=line><span class=cl>├──────────┼─────────┼────────────┼───────────────────────────┤
</span></span><span class=line><span class=cl>│ RSA      │ 2048+   │ Tốt        │ Dùng ≥3072, tốt nhất 4096 │
</span></span><span class=line><span class=cl>│          │         │            │ Tương thích cao           │
</span></span><span class=line><span class=cl>├──────────┼─────────┼────────────┼───────────────────────────┤
</span></span><span class=line><span class=cl>│ DSA      │ 1024    │ TRÁNH      │ Chỉ 1024-bit, lỗi thời    │
</span></span><span class=line><span class=cl>│          │         │            │ Bị vô hiệu hóa mặc định   │
</span></span><span class=line><span class=cl>├──────────┼─────────┼────────────┼───────────────────────────┤
</span></span><span class=line><span class=cl>│ ECDSA    │ 256/384 │ OK         │ Dùng curve P-256, P-384   │
</span></span><span class=line><span class=cl>│          │ /521    │            │ Nhanh hơn RSA             │
</span></span><span class=line><span class=cl>├──────────┼─────────┼────────────┼───────────────────────────┤
</span></span><span class=line><span class=cl>│ Ed25519  │ 256     │ KHUYẾN NGHỊ│ Nhanh, an toàn, nhỏ gọn   │
</span></span><span class=line><span class=cl>│          │         │            │ Xác định (deterministic)  │
</span></span><span class=line><span class=cl>│          │         │            │ Kháng side-channel        │
</span></span><span class=line><span class=cl>└──────────┴─────────┴────────────┴───────────────────────────┘
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>TẠI SAO Ed25519 TỐT NHẤT:
</span></span><span class=line><span class=cl>- Khóa nhỏ (256-bit) nhưng bảo mật cao (~128-bit đối xứng)
</span></span><span class=line><span class=cl>- Xác định: cùng input → cùng chữ ký (không cần số ngẫu nhiên)
</span></span><span class=line><span class=cl>- Thiết kế chống side-channel attack từ đầu
</span></span><span class=line><span class=cl>- Ký/xác thực nhanh gấp nhiều lần RSA
</span></span><span class=line><span class=cl>- Không có backdoor (curve Curve25519 công khai)</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=42-ssh-keygen---tạo-và-quản-lý-khóa><span>4.2 ssh-keygen - Tạo và quản lý khóa</span>
<a href=#42-ssh-keygen---t%e1%ba%a1o-v%c3%a0-qu%e1%ba%a3n-l%c3%bd-kh%c3%b3a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ed25519 - KHUYẾN NGHỊ</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -C <span class=s2>&#34;email@example.com&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># Tạo: ~/.ssh/id_ed25519 (riêng tư)</span>
</span></span><span class=line><span class=cl><span class=c1>#      ~/.ssh/id_ed25519.pub (công khai)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># RSA 4096-bit (khi cần tương thích)</span>
</span></span><span class=line><span class=cl>ssh-keygen -t rsa -b <span class=m>4096</span> -C <span class=s2>&#34;email@example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ECDSA P-384</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ecdsa -b <span class=m>384</span> -C <span class=s2>&#34;email@example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tên file tùy chỉnh</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -f ~/.ssh/id_work -C <span class=s2>&#34;work key&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Không có passphrase (cho automation - THẬN TRỌNG!)</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -N <span class=s2>&#34;&#34;</span> -f ~/.ssh/id_automation
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUẢN LÝ KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi passphrase</span>
</span></span><span class=line><span class=cl>ssh-keygen -p -f ~/.ssh/id_ed25519
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem fingerprint</span>
</span></span><span class=line><span class=cl>ssh-keygen -l -f ~/.ssh/id_ed25519
</span></span><span class=line><span class=cl><span class=c1># 256 SHA256:abc123... email@example.com (ED25519)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ssh-keygen -l -E md5 -f ~/.ssh/id_ed25519
</span></span><span class=line><span class=cl><span class=c1># 256 MD5:ab:cd:ef:... email@example.com (ED25519)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trích xuất khóa công khai từ khóa riêng tư</span>
</span></span><span class=line><span class=cl>ssh-keygen -y -f ~/.ssh/id_ed25519 &gt; ~/.ssh/id_ed25519.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem comment</span>
</span></span><span class=line><span class=cl>ssh-keygen -l -f ~/.ssh/id_ed25519.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUẢN LÝ known_hosts</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa host khỏi known_hosts (sau khi server đổi khóa)</span>
</span></span><span class=line><span class=cl>ssh-keygen -R hostname
</span></span><span class=line><span class=cl>ssh-keygen -R 192.168.1.100
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm host trong known_hosts</span>
</span></span><span class=line><span class=cl>ssh-keygen -F hostname
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hash tên host (bảo mật hơn)</span>
</span></span><span class=line><span class=cl>ssh-keygen -H -f ~/.ssh/known_hosts
</span></span><span class=line><span class=cl><span class=c1># Tên host bị hash, không đọc được nếu file bị lộ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CHUYỂN ĐỔI ĐỊNH DẠNG</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển sang định dạng PEM</span>
</span></span><span class=line><span class=cl>ssh-keygen -p -m PEM -f ~/.ssh/id_rsa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chuyển sang định dạng PKCS8</span>
</span></span><span class=line><span class=cl>ssh-keygen -p -m PKCS8 -f ~/.ssh/id_rsa
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xuất khóa công khai định dạng PEM</span>
</span></span><span class=line><span class=cl>ssh-keygen -e -m PEM -f ~/.ssh/id_ed25519.pub</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=43-ssh-agent><span>4.3 SSH Agent</span>
<a href=#43-ssh-agent class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SSH AGENT - Quản lý khóa trong bộ nhớ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khởi động agent</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=k>$(</span>ssh-agent<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=c1># Hoặc</span>
</span></span><span class=line><span class=cl>ssh-agent bash
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm khóa vào agent</span>
</span></span><span class=line><span class=cl>ssh-add                          <span class=c1># Khóa mặc định</span>
</span></span><span class=line><span class=cl>ssh-add ~/.ssh/id_work           <span class=c1># Khóa cụ thể</span>
</span></span><span class=line><span class=cl>ssh-add -t <span class=m>3600</span> ~/.ssh/id_ed25519  <span class=c1># Tự xóa sau 1 giờ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê khóa trong agent</span>
</span></span><span class=line><span class=cl>ssh-add -l                       <span class=c1># Fingerprint</span>
</span></span><span class=line><span class=cl>ssh-add -L                       <span class=c1># Khóa công khai đầy đủ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa khóa khỏi agent</span>
</span></span><span class=line><span class=cl>ssh-add -d ~/.ssh/id_ed25519     <span class=c1># Xóa một khóa</span>
</span></span><span class=line><span class=cl>ssh-add -D                       <span class=c1># Xóa tất cả</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khóa agent (cần mật khẩu để dùng)</span>
</span></span><span class=line><span class=cl>ssh-add -x                       <span class=c1># Khóa</span>
</span></span><span class=line><span class=cl>ssh-add -X                       <span class=c1># Mở khóa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CẤU HÌNH SSH CLIENT: ~/.ssh/config</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>cat &gt; ~/.ssh/config <span class=s>&lt;&lt; &#39;EOF&#39;
</span></span></span><span class=line><span class=cl><span class=s># Cài đặt toàn cục
</span></span></span><span class=line><span class=cl><span class=s>Host *
</span></span></span><span class=line><span class=cl><span class=s>    AddKeysToAgent yes           # Tự động thêm khóa vào agent
</span></span></span><span class=line><span class=cl><span class=s>    IdentitiesOnly yes           # Chỉ dùng khóa được chỉ định
</span></span></span><span class=line><span class=cl><span class=s>    HashKnownHosts yes           # Hash tên host
</span></span></span><span class=line><span class=cl><span class=s>    ServerAliveInterval 60       # Giữ kết nối
</span></span></span><span class=line><span class=cl><span class=s>    ServerAliveCountMax 3
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Server làm việc
</span></span></span><span class=line><span class=cl><span class=s>Host work
</span></span></span><span class=line><span class=cl><span class=s>    HostName server.work.com
</span></span></span><span class=line><span class=cl><span class=s>    User admin
</span></span></span><span class=line><span class=cl><span class=s>    IdentityFile ~/.ssh/id_work
</span></span></span><span class=line><span class=cl><span class=s>    Port 22
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># Server qua jump host (bastion)
</span></span></span><span class=line><span class=cl><span class=s>Host internal
</span></span></span><span class=line><span class=cl><span class=s>    HostName 10.0.0.50
</span></span></span><span class=line><span class=cl><span class=s>    User deploy
</span></span></span><span class=line><span class=cl><span class=s>    ProxyJump bastion.example.com
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># GitHub
</span></span></span><span class=line><span class=cl><span class=s>Host github.com
</span></span></span><span class=line><span class=cl><span class=s>    HostName github.com
</span></span></span><span class=line><span class=cl><span class=s>    User git
</span></span></span><span class=line><span class=cl><span class=s>    IdentityFile ~/.ssh/id_github
</span></span></span><span class=line><span class=cl><span class=s>
</span></span></span><span class=line><span class=cl><span class=s># GitLab với port khác
</span></span></span><span class=line><span class=cl><span class=s>Host gitlab
</span></span></span><span class=line><span class=cl><span class=s>    HostName gitlab.company.com
</span></span></span><span class=line><span class=cl><span class=s>    User git
</span></span></span><span class=line><span class=cl><span class=s>    Port 2222
</span></span></span><span class=line><span class=cl><span class=s>    IdentityFile ~/.ssh/id_gitlab
</span></span></span><span class=line><span class=cl><span class=s>EOF</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> ~/.ssh/config</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=44-triển-khai-khóa-ssh><span>4.4 Triển khai khóa SSH</span>
<a href=#44-tri%e1%bb%83n-khai-kh%c3%b3a-ssh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># COPY KHÓA LÊN SERVER</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cách 1: ssh-copy-id (đơn giản nhất)</span>
</span></span><span class=line><span class=cl>ssh-copy-id user@server
</span></span><span class=line><span class=cl>ssh-copy-id -i ~/.ssh/id_work.pub user@server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cách 2: Thủ công</span>
</span></span><span class=line><span class=cl>cat ~/.ssh/id_ed25519.pub <span class=p>|</span> ssh user@server <span class=s2>&#34;mkdir -p ~/.ssh &amp;&amp; chmod 700 ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys &amp;&amp; chmod 600 ~/.ssh/authorized_keys&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cách 3: Với pipe</span>
</span></span><span class=line><span class=cl>ssh user@server <span class=s2>&#34;mkdir -p ~/.ssh &amp;&amp; cat &gt;&gt; ~/.ssh/authorized_keys&#34;</span> &lt; ~/.ssh/id_ed25519.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TÙY CHỌN TRONG authorized_keys</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Định dạng: options key-type base64-key comment</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giới hạn lệnh (chỉ chạy được lệnh này)</span>
</span></span><span class=line><span class=cl><span class=nv>command</span><span class=o>=</span><span class=s2>&#34;/usr/bin/backup.sh&#34;</span> ssh-ed25519 AAAA... backup-key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giới hạn IP</span>
</span></span><span class=line><span class=cl><span class=nv>from</span><span class=o>=</span><span class=s2>&#34;192.168.1.*,10.0.0.5&#34;</span> ssh-ed25519 AAAA... limited-key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cấm các tính năng</span>
</span></span><span class=line><span class=cl>no-port-forwarding,no-X11-forwarding,no-agent-forwarding ssh-ed25519 AAAA...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cấm shell</span>
</span></span><span class=line><span class=cl>no-pty ssh-ed25519 AAAA... sftp-only-key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt biến môi trường</span>
</span></span><span class=line><span class=cl><span class=nv>environment</span><span class=o>=</span><span class=s2>&#34;GIT_AUTHOR_NAME=Deploy Bot&#34;</span> ssh-ed25519 AAAA...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kết hợp nhiều tùy chọn</span>
</span></span><span class=line><span class=cl><span class=nv>from</span><span class=o>=</span><span class=s2>&#34;10.0.0.*&#34;</span>,command<span class=o>=</span><span class=s2>&#34;/usr/bin/git-shell&#34;</span>,no-port-forwarding ssh-ed25519 AAAA...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUYỀN FILE SSH</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>chmod <span class=m>700</span> ~/.ssh                     <span class=c1># Thư mục</span>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> ~/.ssh/id_*                <span class=c1># Khóa riêng tư</span>
</span></span><span class=line><span class=cl>chmod <span class=m>644</span> ~/.ssh/*.pub               <span class=c1># Khóa công khai</span>
</span></span><span class=line><span class=cl>chmod <span class=m>644</span> ~/.ssh/known_hosts         <span class=c1># Host đã biết</span>
</span></span><span class=line><span class=cl>chmod <span class=m>644</span> ~/.ssh/authorized_keys     <span class=c1># Khóa được phép</span>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> ~/.ssh/config              <span class=c1># Cấu hình</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra quyền</span>
</span></span><span class=line><span class=cl>ls -la ~/.ssh/</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=45-ssh-certificates-nâng-cao><span>4.5 SSH Certificates (Nâng cao)</span>
<a href=#45-ssh-certificates-n%c3%a2ng-cao class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SSH CERTIFICATES - Thay thế authorized_keys</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Certificate = Khóa + Chữ ký CA + Metadata</span>
</span></span><span class=line><span class=cl><span class=c1># Ưu điểm:</span>
</span></span><span class=line><span class=cl><span class=c1># - Không cần phân phối khóa đến từng server</span>
</span></span><span class=line><span class=cl><span class=c1># - Hết hạn tự động</span>
</span></span><span class=line><span class=cl><span class=c1># - Quản lý tập trung qua CA</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO CA (Certificate Authority)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo CA cho user certificates</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -f ca_user_key -C <span class=s2>&#34;CA cho users&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo CA cho host certificates</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -f ca_host_key -C <span class=s2>&#34;CA cho hosts&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KÝ KHÓA USER</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký khóa công khai của user</span>
</span></span><span class=line><span class=cl>ssh-keygen -s ca_user_key <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -I <span class=s2>&#34;alice-cert&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -n alice,admin <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -V +52w <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    alice_id_ed25519.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tham số:</span>
</span></span><span class=line><span class=cl><span class=c1># -s ca_user_key     CA dùng để ký</span>
</span></span><span class=line><span class=cl><span class=c1># -I &#34;alice-cert&#34;    ID định danh</span>
</span></span><span class=line><span class=cl><span class=c1># -n alice,admin     Principals (users được phép)</span>
</span></span><span class=line><span class=cl><span class=c1># -V +52w            Hợp lệ 52 tuần</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo ra: alice_id_ed25519-cert.pub</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem nội dung certificate</span>
</span></span><span class=line><span class=cl>ssh-keygen -L -f alice_id_ed25519-cert.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KÝ KHÓA HOST</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký khóa host của server</span>
</span></span><span class=line><span class=cl>ssh-keygen -s ca_host_key <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -I <span class=s2>&#34;server1&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -h <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -n server1.example.com,192.168.1.10 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -V +52w <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    /etc/ssh/ssh_host_ed25519_key.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># -h: Đánh dấu là host certificate</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CẤU HÌNH SERVER DÙNG CA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /etc/ssh/sshd_config</span>
</span></span><span class=line><span class=cl><span class=c1># Tin cậy CA cho user certificates</span>
</span></span><span class=line><span class=cl>TrustedUserCAKeys /etc/ssh/ca_user_key.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Dùng host certificate</span>
</span></span><span class=line><span class=cl>HostCertificate /etc/ssh/ssh_host_ed25519_key-cert.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CẤU HÌNH CLIENT TIN CẬY CA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ~/.ssh/known_hosts hoặc /etc/ssh/ssh_known_hosts</span>
</span></span><span class=line><span class=cl>@cert-authority *.example.com ssh-ed25519 AAAA... CA-host-key
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Client sẽ tin tất cả host có certificate ký bởi CA này</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-5-openssl><span>PHẦN 5: OPENSSL</span>
<a href=#ph%e1%ba%a7n-5-openssl class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=51-hash-và-hmac><span>5.1 Hash và HMAC</span>
<a href=#51-hash-v%c3%a0-hmac class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># HASH VỚI OPENSSL</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp chung</span>
</span></span><span class=line><span class=cl>openssl dgst -algorithm file
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Các thuật toán</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 file.txt
</span></span><span class=line><span class=cl>openssl dgst -sha512 file.txt
</span></span><span class=line><span class=cl>openssl dgst -sha3-256 file.txt
</span></span><span class=line><span class=cl>openssl dgst -blake2b512 file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp ngắn</span>
</span></span><span class=line><span class=cl>openssl sha256 file.txt
</span></span><span class=line><span class=cl>openssl sha512 file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Output nhị phân</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 -binary file.txt &gt; hash.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê thuật toán có sẵn</span>
</span></span><span class=line><span class=cl>openssl list -digest-algorithms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># HMAC - Hash-based Message Authentication Code</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HMAC = Hash + Khóa bí mật</span>
</span></span><span class=line><span class=cl><span class=c1># Xác thực cả toàn vẹn VÀ nguồn gốc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>openssl dgst -sha256 -hmac <span class=s2>&#34;khóa_bí_mật&#34;</span> file.txt
</span></span><span class=line><span class=cl><span class=c1># HMAC-SHA256(file.txt)= abc123...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Từ file khóa</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 -hmac <span class=k>$(</span>cat keyfile<span class=k>)</span> file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># HMAC nhị phân</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 -hmac <span class=s2>&#34;key&#34;</span> -binary file.txt</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=52-mã-hóa-đối-xứng><span>5.2 Mã hóa đối xứng</span>
<a href=#52-m%c3%a3-h%c3%b3a-%c4%91%e1%bb%91i-x%e1%bb%a9ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA FILE VỚI MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa AES-256-CBC</span>
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -salt -pbkdf2 -iter <span class=m>100000</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in plaintext.txt -out encrypted.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã</span>
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -d -pbkdf2 -iter <span class=m>100000</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in encrypted.bin -out plaintext.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với base64 (văn bản ASCII)</span>
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -salt -pbkdf2 -a <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in plaintext.txt -out encrypted.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tham số:</span>
</span></span><span class=line><span class=cl><span class=c1># -salt          Thêm salt ngẫu nhiên (LUÔN DÙNG!)</span>
</span></span><span class=line><span class=cl><span class=c1># -pbkdf2        Key derivation tốt hơn (LUÔN DÙNG!)</span>
</span></span><span class=line><span class=cl><span class=c1># -iter 100000   Số vòng lặp PBKDF2</span>
</span></span><span class=line><span class=cl><span class=c1># -a             Base64 encode output</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TRUYỀN MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Từ môi trường (an toàn hơn command line)</span>
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -salt -pbkdf2 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -pass env:MY_PASSWORD <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in plain.txt -out encrypted.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Từ file</span>
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -salt -pbkdf2 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -pass file:/path/to/password.txt <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in plain.txt -out encrypted.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Từ stdin</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;data&#34;</span> <span class=p>|</span> openssl enc -aes-256-cbc -salt -pbkdf2 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -pass pass:mật_khẩu
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># LIỆT KÊ THUẬT TOÁN</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>openssl list -cipher-algorithms
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khuyến nghị:</span>
</span></span><span class=line><span class=cl><span class=c1># aes-256-gcm    - AEAD, có xác thực</span>
</span></span><span class=line><span class=cl><span class=c1># chacha20-poly1305 - AEAD, nhanh trên mobile</span>
</span></span><span class=line><span class=cl><span class=c1># aes-256-cbc    - Cổ điển, cần thêm HMAC</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=53-khóa-rsa-và-ec><span>5.3 Khóa RSA và EC</span>
<a href=#53-kh%c3%b3a-rsa-v%c3%a0-ec class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO KHÓA RSA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa riêng tư (không mã hóa)</span>
</span></span><span class=line><span class=cl>openssl genrsa -out private.pem <span class=m>4096</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa riêng tư (có mật khẩu)</span>
</span></span><span class=line><span class=cl>openssl genrsa -aes256 -out private.pem <span class=m>4096</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trích xuất khóa công khai</span>
</span></span><span class=line><span class=cl>openssl rsa -in private.pem -pubout -out public.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem nội dung khóa</span>
</span></span><span class=line><span class=cl>openssl rsa -in private.pem -text -noout
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO KHÓA EC</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê curves có sẵn</span>
</span></span><span class=line><span class=cl>openssl ecparam -list_curves
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa EC (P-256)</span>
</span></span><span class=line><span class=cl>openssl ecparam -genkey -name prime256v1 -out ec_private.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cách hiện đại (genpkey)</span>
</span></span><span class=line><span class=cl>openssl genpkey -algorithm EC -pkeyopt ec_paramgen_curve:P-256 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -out ec_private.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa Ed25519</span>
</span></span><span class=line><span class=cl>openssl genpkey -algorithm ED25519 -out ed25519_private.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa X25519 (cho key exchange)</span>
</span></span><span class=line><span class=cl>openssl genpkey -algorithm X25519 -out x25519_private.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trích xuất khóa công khai</span>
</span></span><span class=line><span class=cl>openssl ec -in ec_private.pem -pubout -out ec_public.pem
</span></span><span class=line><span class=cl>openssl pkey -in ed25519_private.pem -pubout -out ed25519_public.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA/GIẢI MÃ VỚI RSA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CẢNH BÁO: RSA chỉ mã hóa dữ liệu nhỏ!</span>
</span></span><span class=line><span class=cl><span class=c1># Kích thước tối đa = key_size - padding (thường ~245 bytes cho 2048-bit)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa với khóa công khai</span>
</span></span><span class=line><span class=cl>openssl pkeyutl -encrypt -pubin -inkey public.pem <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in small_data.txt -out encrypted.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã với khóa riêng tư</span>
</span></span><span class=line><span class=cl>openssl pkeyutl -decrypt -inkey private.pem <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -in encrypted.bin -out decrypted.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KÝ/XÁC THỰC VỚI RSA/EC</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký file</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 -sign private.pem -out signature.bin file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực chữ ký</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 -verify public.pem -signature signature.bin file.txt
</span></span><span class=line><span class=cl><span class=c1># Kết quả: &#34;Verified OK&#34; hoặc &#34;Verification Failure&#34;</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=54-chứng-chỉ-x509><span>5.4 Chứng chỉ X.509</span>
<a href=#54-ch%e1%bb%a9ng-ch%e1%bb%89-x509 class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO CHỨNG CHỈ TỰ KÝ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Một lệnh tạo cả khóa và chứng chỉ</span>
</span></span><span class=line><span class=cl>openssl req -x509 -newkey rsa:4096 <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -keyout key.pem -out cert.pem <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -days <span class=m>365</span> -nodes <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=VN/ST=HCM/L=HCM/O=MyOrg/CN=example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tham số:</span>
</span></span><span class=line><span class=cl><span class=c1># -x509          Tạo chứng chỉ tự ký (không phải CSR)</span>
</span></span><span class=line><span class=cl><span class=c1># -newkey rsa:4096  Tạo khóa mới</span>
</span></span><span class=line><span class=cl><span class=c1># -nodes         Không mã hóa khóa riêng tư</span>
</span></span><span class=line><span class=cl><span class=c1># -days 365      Hợp lệ 365 ngày</span>
</span></span><span class=line><span class=cl><span class=c1># -subj          Subject (thông tin chứng chỉ)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với khóa có sẵn</span>
</span></span><span class=line><span class=cl>openssl req -x509 -key private.pem -out cert.pem -days <span class=m>365</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO CSR (Certificate Signing Request)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CSR gửi cho CA để xin chứng chỉ</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo CSR từ khóa có sẵn</span>
</span></span><span class=line><span class=cl>openssl req -new -key private.pem -out request.csr <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    -subj <span class=s2>&#34;/C=VN/ST=HCM/L=HCM/O=MyOrg/CN=example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa mới + CSR</span>
</span></span><span class=line><span class=cl>openssl req -newkey rsa:4096 -keyout private.pem -out request.csr -nodes
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem nội dung CSR</span>
</span></span><span class=line><span class=cl>openssl req -in request.csr -text -noout
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực CSR</span>
</span></span><span class=line><span class=cl>openssl req -in request.csr -verify
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XEM CHỨNG CHỈ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thông tin đầy đủ</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -text -noout
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ subject</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -noout -subject
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ issuer</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -noout -issuer
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ngày hết hạn</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -noout -dates
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Fingerprint</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -noout -fingerprint -sha256
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra hết hạn trong N giây</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -checkend <span class=m>86400</span>
</span></span><span class=line><span class=cl><span class=c1># Exit code 0 = chưa hết hạn, 1 = sắp hết hạn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trích xuất khóa công khai</span>
</span></span><span class=line><span class=cl>openssl x509 -in cert.pem -noout -pubkey
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÁC THỰC CHUỖI CHỨNG CHỈ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực với CA</span>
</span></span><span class=line><span class=cl>openssl verify -CAfile ca.pem cert.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực chuỗi</span>
</span></span><span class=line><span class=cl>openssl verify -CAfile ca.pem -untrusted intermediate.pem cert.pem</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=55-kiểm-tra-tlsssl><span>5.5 Kiểm tra TLS/SSL</span>
<a href=#55-ki%e1%bb%83m-tra-tlsssl class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KẾT NỐI TLS VÀ KIỂM TRA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kết nối cơ bản</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với SNI (Server Name Indication) - BẮT BUỘC cho nhiều server</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -servername example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ hiện chứng chỉ</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=p>|</span> openssl s_client -connect example.com:443 -servername example.com 2&gt;/dev/null <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    openssl x509 -text -noout
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hiện chuỗi chứng chỉ</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -showcerts
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ định phiên bản TLS</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -tls1_2
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -tls1_3
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ định cipher</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -cipher ECDHE-RSA-AES256-GCM-SHA384
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># STARTTLS cho các giao thức khác</span>
</span></span><span class=line><span class=cl>openssl s_client -connect mail.example.com:587 -starttls smtp
</span></span><span class=line><span class=cl>openssl s_client -connect mail.example.com:143 -starttls imap
</span></span><span class=line><span class=cl>openssl s_client -connect ftp.example.com:21 -starttls ftp
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÁC THỰC CHỨNG CHỈ SERVER</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực với CA mặc định</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -verify <span class=m>5</span> -verify_return_error
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực với CA tùy chỉnh</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -CAfile /path/to/ca.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra OCSP stapling</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -status
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># LIỆT KÊ CIPHERS</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tất cả ciphers</span>
</span></span><span class=line><span class=cl>openssl ciphers -v
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ciphers mạnh</span>
</span></span><span class=line><span class=cl>openssl ciphers -v <span class=s1>&#39;HIGH:!aNULL:!MD5&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ciphers TLS 1.3</span>
</span></span><span class=line><span class=cl>openssl ciphers -v -tls1_3</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=56-tạo-số-ngẫu-nhiên><span>5.6 Tạo số ngẫu nhiên</span>
<a href=#56-t%e1%ba%a1o-s%e1%bb%91-ng%e1%ba%abu-nhi%c3%aan class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO SỐ NGẪU NHIÊN AN TOÀN</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 32 bytes nhị phân</span>
</span></span><span class=line><span class=cl>openssl rand <span class=m>32</span> &gt; random.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 32 bytes hex (64 ký tự)</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>32</span>
</span></span><span class=line><span class=cl><span class=c1># a1b2c3d4e5f6...</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 32 bytes base64</span>
</span></span><span class=line><span class=cl>openssl rand -base64 <span class=m>32</span>
</span></span><span class=line><span class=cl><span class=c1># +aBcDeFgHiJkLmNoPqRsTuVwXyZ012==</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ghi ra file</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>32</span> -out key.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># ỨNG DỤNG</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo mật khẩu ngẫu nhiên</span>
</span></span><span class=line><span class=cl>openssl rand -base64 <span class=m>24</span> <span class=p>|</span> tr -d <span class=s1>&#39;=&#39;</span> <span class=p>|</span> head -c <span class=m>20</span>
</span></span><span class=line><span class=cl><span class=c1># kA9xBnZ3mP7yR2sW1qE5</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo khóa AES</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>32</span>    <span class=c1># 256-bit</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>16</span>    <span class=c1># 128-bit</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo IV</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>16</span>    <span class=c1># 128-bit IV</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo token/session ID</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>64</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-6-mã-hóa-file><span>PHẦN 6: MÃ HÓA FILE</span>
<a href=#ph%e1%ba%a7n-6-m%c3%a3-h%c3%b3a-file class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=61-age---công-cụ-mã-hóa-hiện-đại><span>6.1 age - Công cụ mã hóa hiện đại</span>
<a href=#61-age---c%c3%b4ng-c%e1%bb%a5-m%c3%a3-h%c3%b3a-hi%e1%bb%87n-%c4%91%e1%ba%a1i class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># age - Thay thế GPG cho mã hóa file</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cài đặt</span>
</span></span><span class=line><span class=cl>sudo apt install age              <span class=c1># Debian/Ubuntu</span>
</span></span><span class=line><span class=cl>sudo dnf install age              <span class=c1># Fedora</span>
</span></span><span class=line><span class=cl>brew install age                  <span class=c1># macOS</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo cặp khóa</span>
</span></span><span class=line><span class=cl>age-keygen -o key.txt
</span></span><span class=line><span class=cl><span class=c1># Kết quả:</span>
</span></span><span class=line><span class=cl><span class=c1># Khóa công khai: age1ql3z7hjy54pw3hyww5ayyfg7zqgvc7w3j2elw8zmrj2kg5sfn9aqmcac8p</span>
</span></span><span class=line><span class=cl><span class=c1># Khóa riêng tư lưu trong key.txt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem khóa công khai từ khóa riêng tư</span>
</span></span><span class=line><span class=cl>age-keygen -y key.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA VỚI KHÓA CÔNG KHAI</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa cho người nhận</span>
</span></span><span class=line><span class=cl>age -r age1ql3z7hjy... -o file.age file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nhiều người nhận</span>
</span></span><span class=line><span class=cl>age -r age1... -r age1... -o file.age file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Người nhận từ file</span>
</span></span><span class=line><span class=cl>age -R recipients.txt -o file.age file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Armor (ASCII output)</span>
</span></span><span class=line><span class=cl>age -r age1... -a -o file.age.txt file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA VỚI MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>age -p -o file.age file.txt
</span></span><span class=line><span class=cl><span class=c1># Nhập mật khẩu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># GIẢI MÃ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với khóa riêng tư</span>
</span></span><span class=line><span class=cl>age -d -i key.txt -o file.txt file.age
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Với mật khẩu</span>
</span></span><span class=line><span class=cl>age -d -o file.txt file.age
</span></span><span class=line><span class=cl><span class=c1># Nhập mật khẩu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA VỚI KHÓA SSH</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># age có thể dùng khóa SSH ed25519/RSA!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa với khóa SSH công khai</span>
</span></span><span class=line><span class=cl>age -R ~/.ssh/id_ed25519.pub -o file.age file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã với khóa SSH riêng tư</span>
</span></span><span class=line><span class=cl>age -d -i ~/.ssh/id_ed25519 -o file.txt file.age
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA THƯ MỤC</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nén rồi mã hóa</span>
</span></span><span class=line><span class=cl>tar czf - thư_mục/ <span class=p>|</span> age -r age1... -o backup.tar.gz.age
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giải mã và giải nén</span>
</span></span><span class=line><span class=cl>age -d -i key.txt backup.tar.gz.age <span class=p>|</span> tar xzf -</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=62-luks---mã-hóa-ổ-đĩa><span>6.2 LUKS - Mã hóa ổ đĩa</span>
<a href=#62-luks---m%c3%a3-h%c3%b3a-%e1%bb%95-%c4%91%c4%a9a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># LUKS - Linux Unified Key Setup</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa full disk encryption cho Linux</span>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa ở block device level</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO PHÂN VÙNG MÃ HÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># CẢNH BÁO: Xóa toàn bộ dữ liệu trên thiết bị!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo LUKS container</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksFormat /dev/sdb1
</span></span><span class=line><span class=cl><span class=c1># Nhập YES và mật khẩu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mở (unlock) thiết bị</span>
</span></span><span class=line><span class=cl>sudo cryptsetup open /dev/sdb1 mydata
</span></span><span class=line><span class=cl><span class=c1># Tạo /dev/mapper/mydata</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo filesystem</span>
</span></span><span class=line><span class=cl>sudo mkfs.ext4 /dev/mapper/mydata
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount</span>
</span></span><span class=line><span class=cl>sudo mount /dev/mapper/mydata /mnt/secure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># ĐÓNG THIẾT BỊ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Unmount</span>
</span></span><span class=line><span class=cl>sudo umount /mnt/secure
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đóng (lock) thiết bị</span>
</span></span><span class=line><span class=cl>sudo cryptsetup close mydata
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUẢN LÝ KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem thông tin LUKS</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksDump /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm mật khẩu mới (LUKS hỗ trợ 8 slots)</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksAddKey /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa mật khẩu</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksRemoveKey /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi mật khẩu</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksChangeKey /dev/sdb1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># SAO LƯU HEADER (RẤT QUAN TRỌNG!)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nếu header bị hỏng, MẤT DỮ LIỆU VĨNH VIỄN!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Sao lưu header</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksHeaderBackup /dev/sdb1 --header-backup-file luks_header.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khôi phục header</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksHeaderRestore /dev/sdb1 --header-backup-file luks_header.bin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO FILE CONTAINER MÃ HÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo file trống</span>
</span></span><span class=line><span class=cl>dd <span class=k>if</span><span class=o>=</span>/dev/zero <span class=nv>of</span><span class=o>=</span>container.img <span class=nv>bs</span><span class=o>=</span>1M <span class=nv>count</span><span class=o>=</span><span class=m>100</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo LUKS</span>
</span></span><span class=line><span class=cl>sudo cryptsetup luksFormat container.img
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mở</span>
</span></span><span class=line><span class=cl>sudo cryptsetup open container.img mycontainer
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo filesystem</span>
</span></span><span class=line><span class=cl>sudo mkfs.ext4 /dev/mapper/mycontainer
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mount</span>
</span></span><span class=line><span class=cl>sudo mount /dev/mapper/mycontainer /mnt/container</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=63-fscrypt---mã-hóa-thư-mục><span>6.3 fscrypt - Mã hóa thư mục</span>
<a href=#63-fscrypt---m%c3%a3-h%c3%b3a-th%c6%b0-m%e1%bb%a5c class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># fscrypt - Mã hóa thư mục native (ext4, F2FS)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># fscrypt mã hóa từng thư mục riêng biệt</span>
</span></span><span class=line><span class=cl><span class=c1># Nhẹ hơn LUKS, linh hoạt hơn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cài đặt</span>
</span></span><span class=line><span class=cl>sudo apt install fscrypt libpam-fscrypt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># THIẾT LẬP</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kích hoạt trên filesystem</span>
</span></span><span class=line><span class=cl>sudo tune2fs -O encrypt /dev/sda1    <span class=c1># ext4</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thiết lập fscrypt</span>
</span></span><span class=line><span class=cl>sudo fscrypt setup
</span></span><span class=line><span class=cl>sudo fscrypt setup /mnt/data         <span class=c1># Trên mount point</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># MÃ HÓA THƯ MỤC</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo thư mục trống</span>
</span></span><span class=line><span class=cl>mkdir ~/private
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa</span>
</span></span><span class=line><span class=cl>fscrypt encrypt ~/private
</span></span><span class=line><span class=cl><span class=c1># Chọn protector (mật khẩu, PAM, custom key)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KHÓA/MỞ KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khóa thư mục</span>
</span></span><span class=line><span class=cl>fscrypt lock ~/private
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mở khóa</span>
</span></span><span class=line><span class=cl>fscrypt unlock ~/private
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem trạng thái</span>
</span></span><span class=line><span class=cl>fscrypt status ~/private
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># LIỆT KÊ VÀ QUẢN LÝ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê thư mục mã hóa</span>
</span></span><span class=line><span class=cl>fscrypt status /mnt/data
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm protector</span>
</span></span><span class=line><span class=cl>fscrypt metadata add-protector-to-policy --protector<span class=o>=</span>/mnt/data:xxx ~/private</span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-7-quản-lý-mật-khẩu><span>PHẦN 7: QUẢN LÝ MẬT KHẨU</span>
<a href=#ph%e1%ba%a7n-7-qu%e1%ba%a3n-l%c3%bd-m%e1%ba%adt-kh%e1%ba%a9u class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=71-pass---unix-password-manager><span>7.1 pass - Unix Password Manager</span>
<a href=#71-pass---unix-password-manager class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span><span class=lnt>64
</span><span class=lnt>65
</span><span class=lnt>66
</span><span class=lnt>67
</span><span class=lnt>68
</span><span class=lnt>69
</span><span class=lnt>70
</span><span class=lnt>71
</span><span class=lnt>72
</span><span class=lnt>73
</span><span class=lnt>74
</span><span class=lnt>75
</span><span class=lnt>76
</span><span class=lnt>77
</span><span class=lnt>78
</span><span class=lnt>79
</span><span class=lnt>80
</span><span class=lnt>81
</span><span class=lnt>82
</span><span class=lnt>83
</span><span class=lnt>84
</span><span class=lnt>85
</span><span class=lnt>86
</span><span class=lnt>87
</span><span class=lnt>88
</span><span class=lnt>89
</span><span class=lnt>90
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># pass - Quản lý mật khẩu chuẩn Unix</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mật khẩu lưu dạng file GPG, quản lý bằng Git</span>
</span></span><span class=line><span class=cl><span class=c1># Đơn giản, Unix philosophy, có thể script</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cài đặt</span>
</span></span><span class=line><span class=cl>sudo apt install pass
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># THIẾT LẬP</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khởi tạo với GPG key</span>
</span></span><span class=line><span class=cl>pass init GPG_KEY_ID
</span></span><span class=line><span class=cl><span class=c1># Tạo ~/.password-store/</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khởi tạo Git (tùy chọn)</span>
</span></span><span class=line><span class=cl>pass git init
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># THÊM MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm thủ công</span>
</span></span><span class=line><span class=cl>pass insert email/gmail
</span></span><span class=line><span class=cl><span class=c1># Nhập mật khẩu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thêm nhiều dòng</span>
</span></span><span class=line><span class=cl>pass insert -m email/gmail
</span></span><span class=line><span class=cl><span class=c1># Dòng 1: mật khẩu</span>
</span></span><span class=line><span class=cl><span class=c1># Dòng 2: username: myuser</span>
</span></span><span class=line><span class=cl><span class=c1># Dòng 3: url: https://gmail.com</span>
</span></span><span class=line><span class=cl><span class=c1># Ctrl+D để kết thúc</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo mật khẩu ngẫu nhiên</span>
</span></span><span class=line><span class=cl>pass generate email/work <span class=m>20</span>
</span></span><span class=line><span class=cl><span class=c1># Tạo mật khẩu 20 ký tự</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>pass generate -n email/work <span class=m>20</span>     <span class=c1># Không có ký tự đặc biệt</span>
</span></span><span class=line><span class=cl>pass generate -c email/work <span class=m>20</span>     <span class=c1># Copy vào clipboard</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># ĐỌC MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem mật khẩu</span>
</span></span><span class=line><span class=cl>pass email/gmail
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Copy vào clipboard (tự xóa sau 45 giây)</span>
</span></span><span class=line><span class=cl>pass -c email/gmail
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ dòng đầu (mật khẩu)</span>
</span></span><span class=line><span class=cl>pass show email/gmail <span class=p>|</span> head -1
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUẢN LÝ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Liệt kê tất cả</span>
</span></span><span class=line><span class=cl>pass
</span></span><span class=line><span class=cl>pass ls
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉnh sửa</span>
</span></span><span class=line><span class=cl>pass edit email/gmail
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xóa</span>
</span></span><span class=line><span class=cl>pass rm email/gmail
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đổi tên/di chuyển</span>
</span></span><span class=line><span class=cl>pass mv email/gmail email/google
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm kiếm</span>
</span></span><span class=line><span class=cl>pass find gmail
</span></span><span class=line><span class=cl>pass grep <span class=s2>&#34;pattern&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># ĐỒNG BỘ GIT</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Push lên remote</span>
</span></span><span class=line><span class=cl>pass git remote add origin git@github.com:user/passwords.git
</span></span><span class=line><span class=cl>pass git push -u origin master
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Pull về máy khác</span>
</span></span><span class=line><span class=cl>pass git pull
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem lịch sử</span>
</span></span><span class=line><span class=cl>pass git log</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=72-secret-tool---gnome-keyring-cli><span>7.2 secret-tool - GNOME Keyring CLI</span>
<a href=#72-secret-tool---gnome-keyring-cli class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># secret-tool - CLI cho GNOME Keyring / KDE Wallet</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tích hợp với desktop environment</span>
</span></span><span class=line><span class=cl><span class=c1># Tự động unlock khi đăng nhập</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># LƯU MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp: secret-tool store --label=&#34;nhãn&#34; thuộc_tính1 giá_trị1 thuộc_tính2 giá_trị2</span>
</span></span><span class=line><span class=cl>secret-tool store --label<span class=o>=</span><span class=s2>&#34;Gmail&#34;</span> service gmail username myuser
</span></span><span class=line><span class=cl><span class=c1># Nhập mật khẩu</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Nhiều thuộc tính</span>
</span></span><span class=line><span class=cl>secret-tool store --label<span class=o>=</span><span class=s2>&#34;Database&#34;</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    service mysql <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    server db.example.com <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    username admin
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># ĐỌC MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Lookup theo thuộc tính</span>
</span></span><span class=line><span class=cl>secret-tool lookup service gmail username myuser
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tìm kiếm</span>
</span></span><span class=line><span class=cl>secret-tool search --all service gmail
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># XÓA MẬT KHẨU</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>secret-tool clear service gmail username myuser</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=73-tạo-mật-khẩu-mạnh><span>7.3 Tạo mật khẩu mạnh</span>
<a href=#73-t%e1%ba%a1o-m%e1%ba%adt-kh%e1%ba%a9u-m%e1%ba%a1nh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO MẬT KHẨU NGẪU NHIÊN</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># OpenSSL</span>
</span></span><span class=line><span class=cl>openssl rand -base64 <span class=m>24</span>
</span></span><span class=line><span class=cl><span class=c1># kA9xBn+3mP7yR2sW1qE5X2cD</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># /dev/urandom</span>
</span></span><span class=line><span class=cl>head -c <span class=m>32</span> /dev/urandom <span class=p>|</span> base64
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># pwgen</span>
</span></span><span class=line><span class=cl>sudo apt install pwgen
</span></span><span class=line><span class=cl>pwgen -s <span class=m>20</span> <span class=m>1</span>              <span class=c1># 20 ký tự, an toàn</span>
</span></span><span class=line><span class=cl>pwgen -sy <span class=m>20</span> <span class=m>1</span>             <span class=c1># Có ký tự đặc biệt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># GPG</span>
</span></span><span class=line><span class=cl>gpg --gen-random --armor <span class=m>1</span> <span class=m>24</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO PASSPHRASE (Dễ nhớ hơn)</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># xkcdpass - passphrase kiểu &#34;correct horse battery staple&#34;</span>
</span></span><span class=line><span class=cl>sudo apt install xkcdpass
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>xkcdpass -n <span class=m>6</span>
</span></span><span class=line><span class=cl><span class=c1># correct horse battery staple cream piano</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>xkcdpass -n <span class=m>6</span> -d <span class=s2>&#34;-&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># correct-horse-battery-staple-cream-piano</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KIỂM TRA ĐỘ MẠNH</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># cracklib-check</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;mật_khẩu&#34;</span> <span class=p>|</span> cracklib-check
</span></span><span class=line><span class=cl><span class=c1># mật_khẩu: OK</span>
</span></span><span class=line><span class=cl><span class=c1># hoặc</span>
</span></span><span class=line><span class=cl><span class=c1># mật_khẩu: quá ngắn / dựa trên từ điển / v.v.</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-8-xóa-file-an-toàn><span>PHẦN 8: XÓA FILE AN TOÀN</span>
<a href=#ph%e1%ba%a7n-8-x%c3%b3a-file-an-to%c3%a0n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=81-shred---ghi-đè-file><span>8.1 shred - Ghi đè file</span>
<a href=#81-shred---ghi-%c4%91%c3%a8-file class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># shred - Ghi đè file trước khi xóa</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cú pháp cơ bản</span>
</span></span><span class=line><span class=cl>shred file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ghi đè và xóa</span>
</span></span><span class=line><span class=cl>shred -u file.txt
</span></span><span class=line><span class=cl><span class=c1># -u: unlink (xóa) sau khi ghi đè</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ định số lần ghi đè (mặc định 3)</span>
</span></span><span class=line><span class=cl>shred -n <span class=m>7</span> -u file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ghi đè cuối cùng bằng zeros (giấu việc đã shred)</span>
</span></span><span class=line><span class=cl>shred -z -u file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verbose</span>
</span></span><span class=line><span class=cl>shred -v -u file.txt
</span></span><span class=line><span class=cl><span class=c1># shred: file.txt: lần 1/3 (ngẫu nhiên)...</span>
</span></span><span class=line><span class=cl><span class=c1># shred: file.txt: lần 2/3 (ngẫu nhiên)...</span>
</span></span><span class=line><span class=cl><span class=c1># shred: file.txt: lần 3/3 (ngẫu nhiên)...</span>
</span></span><span class=line><span class=cl><span class=c1># shred: file.txt: đang xóa</span>
</span></span><span class=line><span class=cl><span class=c1># shred: file.txt: đã xóa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ép buộc (thay đổi quyền nếu cần)</span>
</span></span><span class=line><span class=cl>shred -f -u readonly_file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># GIỚI HẠN CỦA shred</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># shred KHÔNG HIỆU QUẢ trên:</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ SSD (Solid State Drive)</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Wear leveling di chuyển dữ liệu</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Dữ liệu cũ vẫn còn trong cells khác</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Giải pháp: Mã hóa full disk từ đầu + TRIM</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ Journaling filesystems (ext3, ext4, NTFS, v.v.)</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Journal có thể chứa dữ liệu cũ</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ Copy-on-Write filesystems (Btrfs, ZFS)</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Không bao giờ ghi đè, luôn tạo bản mới</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ RAID</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Dữ liệu có thể còn trên disk khác</span>
</span></span><span class=line><span class=cl><span class=c1>#</span>
</span></span><span class=line><span class=cl><span class=c1># ✗ Snapshot/Backup</span>
</span></span><span class=line><span class=cl><span class=c1>#   - Dữ liệu còn trong snapshot</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># GIẢI PHÁP ĐÚNG:</span>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa full disk từ đầu (LUKS)</span>
</span></span><span class=line><span class=cl><span class=c1># → Chỉ cần xóa khóa, dữ liệu không đọc được</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=82-secure-delete><span>8.2 secure-delete</span>
<a href=#82-secure-delete class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># secure-delete - Bộ công cụ xóa an toàn</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Cài đặt</span>
</span></span><span class=line><span class=cl>sudo apt install secure-delete
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CÁC CÔNG CỤ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># srm - Xóa file an toàn</span>
</span></span><span class=line><span class=cl>srm file.txt
</span></span><span class=line><span class=cl>srm -r thư_mục/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sfill - Ghi đè không gian trống</span>
</span></span><span class=line><span class=cl>sfill /mount_point
</span></span><span class=line><span class=cl><span class=c1># Ghi đè tất cả không gian trống trên phân vùng</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sswap - Ghi đè swap</span>
</span></span><span class=line><span class=cl>sudo sswap /dev/sdaX
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># smem - Ghi đè RAM</span>
</span></span><span class=line><span class=cl>smem
</span></span><span class=line><span class=cl><span class=c1># Ghi đè RAM chưa dùng</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CẢNH BÁO: Cùng giới hạn như shred</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=83-file-tạm-an-toàn><span>8.3 File tạm an toàn</span>
<a href=#83-file-t%e1%ba%a1m-an-to%c3%a0n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># TẠO FILE TẠM AN TOÀN</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># mktemp - Tạo file/thư mục tạm với tên ngẫu nhiên</span>
</span></span><span class=line><span class=cl><span class=nv>TMPFILE</span><span class=o>=</span><span class=k>$(</span>mktemp<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;dữ liệu nhạy cảm&#34;</span> &gt; <span class=s2>&#34;</span><span class=nv>$TMPFILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=c1># ... xử lý ...</span>
</span></span><span class=line><span class=cl>rm <span class=s2>&#34;</span><span class=nv>$TMPFILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trong RAM (không ghi disk)</span>
</span></span><span class=line><span class=cl><span class=nv>TMPFILE</span><span class=o>=</span><span class=k>$(</span>mktemp -p /dev/shm<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo thư mục tạm</span>
</span></span><span class=line><span class=cl><span class=nv>TMPDIR</span><span class=o>=</span><span class=k>$(</span>mktemp -d<span class=k>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tự động dọn dẹp khi script kết thúc</span>
</span></span><span class=line><span class=cl><span class=nb>trap</span> <span class=s2>&#34;rm -f </span><span class=nv>$TMPFILE</span><span class=s2>&#34;</span> EXIT
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUYỀN TRUY CẬP</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo với quyền hạn chế</span>
</span></span><span class=line><span class=cl><span class=nb>umask</span> <span class=m>077</span>
</span></span><span class=line><span class=cl><span class=nv>TMPFILE</span><span class=o>=</span><span class=k>$(</span>mktemp<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=c1># File chỉ owner đọc được</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Hoặc đặt quyền trực tiếp</span>
</span></span><span class=line><span class=cl>chmod <span class=m>600</span> <span class=s2>&#34;</span><span class=nv>$TMPFILE</span><span class=s2>&#34;</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=84-thuộc-tính-file><span>8.4 Thuộc tính file</span>
<a href=#84-thu%e1%bb%99c-t%c3%adnh-file class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># THUỘC TÍNH FILE BẢO VỆ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem thuộc tính</span>
</span></span><span class=line><span class=cl>lsattr file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Đặt thuộc tính bất biến (immutable)</span>
</span></span><span class=line><span class=cl>sudo chattr +i file.txt
</span></span><span class=line><span class=cl><span class=c1># Không thể sửa đổi, xóa, đổi tên - kể cả root!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Bỏ thuộc tính bất biến</span>
</span></span><span class=line><span class=cl>sudo chattr -i file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ cho phép append (log files)</span>
</span></span><span class=line><span class=cl>sudo chattr +a logfile.txt
</span></span><span class=line><span class=cl><span class=c1># Chỉ thêm vào cuối, không sửa đổi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Secure delete flag</span>
</span></span><span class=line><span class=cl>sudo chattr +s file.txt
</span></span><span class=line><span class=cl><span class=c1># Yêu cầu ghi đè khi xóa (filesystem phải hỗ trợ)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># No dump</span>
</span></span><span class=line><span class=cl>sudo chattr +d file.txt
</span></span><span class=line><span class=cl><span class=c1># Bỏ qua khi dump/backup</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-9-bảo-mật-mạng><span>PHẦN 9: BẢO MẬT MẠNG</span>
<a href=#ph%e1%ba%a7n-9-b%e1%ba%a3o-m%e1%ba%adt-m%e1%ba%a1ng class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=91-kiểm-tra-ssltls><span>9.1 Kiểm tra SSL/TLS</span>
<a href=#91-ki%e1%bb%83m-tra-ssltls class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KIỂM TRA CHỨNG CHỈ SERVER</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem chứng chỉ</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=p>|</span> openssl s_client -connect example.com:443 -servername example.com 2&gt;/dev/null <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    openssl x509 -noout -text
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chỉ xem subject và issuer</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=p>|</span> openssl s_client -connect example.com:443 -servername example.com 2&gt;/dev/null <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    openssl x509 -noout -subject -issuer
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem ngày hết hạn</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=p>|</span> openssl s_client -connect example.com:443 -servername example.com 2&gt;/dev/null <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    openssl x509 -noout -dates
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra sắp hết hạn (trong 30 ngày)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=p>|</span> openssl s_client -connect example.com:443 -servername example.com 2&gt;/dev/null <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    openssl x509 -noout -checkend <span class=m>2592000</span>
</span></span><span class=line><span class=cl><span class=c1># Exit code 0 = OK, 1 = sắp hết hạn</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KIỂM TRA NHIỀU SITE</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl><span class=c1># check_ssl.sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>SITES</span><span class=o>=</span><span class=s2>&#34;example.com google.com github.com&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>WARN_DAYS</span><span class=o>=</span><span class=m>30</span>
</span></span><span class=line><span class=cl><span class=nv>WARN_SECONDS</span><span class=o>=</span><span class=k>$((</span>WARN_DAYS <span class=o>*</span> <span class=m>86400</span><span class=k>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>for</span> site in <span class=nv>$SITES</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> -n <span class=s2>&#34;</span><span class=nv>$site</span><span class=s2>: &#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=nb>echo</span> <span class=p>|</span> openssl s_client -connect <span class=s2>&#34;</span><span class=nv>$site</span><span class=s2>:443&#34;</span> -servername <span class=s2>&#34;</span><span class=nv>$site</span><span class=s2>&#34;</span> 2&gt;/dev/null <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>       openssl x509 -noout -checkend <span class=nv>$WARN_SECONDS</span> 2&gt;/dev/null<span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;OK&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;SẮP HẾT HẠN hoặc LỖI&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KIỂM TRA CHUỖI CHỨNG CHỈ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem chuỗi đầy đủ</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -showcerts
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực chuỗi</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -verify_return_error</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=92-ssh-hardening><span>9.2 SSH Hardening</span>
<a href=#92-ssh-hardening class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span><span class=lnt>47
</span><span class=lnt>48
</span><span class=lnt>49
</span><span class=lnt>50
</span><span class=lnt>51
</span><span class=lnt>52
</span><span class=lnt>53
</span><span class=lnt>54
</span><span class=lnt>55
</span><span class=lnt>56
</span><span class=lnt>57
</span><span class=lnt>58
</span><span class=lnt>59
</span><span class=lnt>60
</span><span class=lnt>61
</span><span class=lnt>62
</span><span class=lnt>63
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># CẤU HÌNH SSH SERVER AN TOÀN</span>
</span></span><span class=line><span class=cl><span class=c1># /etc/ssh/sshd_config</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Protocol</span>
</span></span><span class=line><span class=cl>Protocol <span class=m>2</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Authentication</span>
</span></span><span class=line><span class=cl>PermitRootLogin no
</span></span><span class=line><span class=cl>PasswordAuthentication no
</span></span><span class=line><span class=cl>PubkeyAuthentication yes
</span></span><span class=line><span class=cl>AuthenticationMethods publickey
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giới hạn users</span>
</span></span><span class=line><span class=cl>AllowUsers admin deploy
</span></span><span class=line><span class=cl><span class=c1># hoặc</span>
</span></span><span class=line><span class=cl>AllowGroups sshusers
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giới hạn thử đăng nhập</span>
</span></span><span class=line><span class=cl>MaxAuthTries <span class=m>3</span>
</span></span><span class=line><span class=cl>LoginGraceTime <span class=m>30</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tắt các tính năng không cần</span>
</span></span><span class=line><span class=cl>X11Forwarding no
</span></span><span class=line><span class=cl>AllowTcpForwarding no
</span></span><span class=line><span class=cl>AllowAgentForwarding no
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Thuật toán mạnh</span>
</span></span><span class=line><span class=cl>KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256
</span></span><span class=line><span class=cl>Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com
</span></span><span class=line><span class=cl>MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Log</span>
</span></span><span class=line><span class=cl>LogLevel VERBOSE
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># KIỂM TRA ĐỘ MẠNH KHÓA</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra khóa server</span>
</span></span><span class=line><span class=cl>sudo ssh-keygen -l -f /etc/ssh/ssh_host_ed25519_key.pub
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra khóa user</span>
</span></span><span class=line><span class=cl>ssh-keygen -l -f ~/.ssh/id_ed25519
</span></span><span class=line><span class=cl><span class=c1># 256 SHA256:abc... email@example.com (ED25519)</span>
</span></span><span class=line><span class=cl><span class=c1># 256-bit Ed25519 = OK</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ssh-keygen -l -f ~/.ssh/id_rsa
</span></span><span class=line><span class=cl><span class=c1># 4096 SHA256:xyz... email@example.com (RSA)</span>
</span></span><span class=line><span class=cl><span class=c1># 4096-bit RSA = OK</span>
</span></span><span class=line><span class=cl><span class=c1># 2048-bit RSA = Tối thiểu</span>
</span></span><span class=line><span class=cl><span class=c1># 1024-bit RSA = KHÔNG AN TOÀN!</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># DEBUG KẾT NỐI SSH</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Verbose mode</span>
</span></span><span class=line><span class=cl>ssh -vvv user@server
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xem cấu hình sshd đang chạy</span>
</span></span><span class=line><span class=cl>sudo sshd -T</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=93-xác-thực-gpg-cho-download><span>9.3 Xác thực GPG cho download</span>
<a href=#93-x%c3%a1c-th%e1%bb%b1c-gpg-cho-download class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># QUY TRÌNH XÁC THỰC DOWNLOAD ĐẦY ĐỦ</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>#!/bin/bash</span>
</span></span><span class=line><span class=cl><span class=c1># verify_download.sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>URL_BASE</span><span class=o>=</span><span class=s2>&#34;https://example.com/releases&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>FILE</span><span class=o>=</span><span class=s2>&#34;software-1.0.tar.gz&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>KEY_ID</span><span class=o>=</span><span class=s2>&#34;0xABCD1234&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>KEYSERVER</span><span class=o>=</span><span class=s2>&#34;keys.openpgp.org&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Tải file và chữ ký</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[1/5] Đang tải files...&#34;</span>
</span></span><span class=line><span class=cl>wget -q <span class=s2>&#34;</span><span class=nv>$URL_BASE</span><span class=s2>/</span><span class=nv>$FILE</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>wget -q <span class=s2>&#34;</span><span class=nv>$URL_BASE</span><span class=s2>/</span><span class=nv>$FILE</span><span class=s2>.asc&#34;</span>
</span></span><span class=line><span class=cl>wget -q <span class=s2>&#34;</span><span class=nv>$URL_BASE</span><span class=s2>/SHA256SUMS&#34;</span>
</span></span><span class=line><span class=cl>wget -q <span class=s2>&#34;</span><span class=nv>$URL_BASE</span><span class=s2>/SHA256SUMS.asc&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Nhập khóa ký (nếu chưa có)</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[2/5] Đang nhập khóa GPG...&#34;</span>
</span></span><span class=line><span class=cl>gpg --keyserver <span class=s2>&#34;</span><span class=nv>$KEYSERVER</span><span class=s2>&#34;</span> --recv-keys <span class=s2>&#34;</span><span class=nv>$KEY_ID</span><span class=s2>&#34;</span> 2&gt;/dev/null
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Xác thực chữ ký của checksums</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[3/5] Đang xác thực chữ ký checksums...&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> ! gpg --verify SHA256SUMS.asc SHA256SUMS 2&gt;/dev/null<span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;LỖI: Chữ ký checksums không hợp lệ!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;✓ Chữ ký checksums hợp lệ&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Xác thực checksum của file</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[4/5] Đang xác thực checksum file...&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> ! sha256sum -c SHA256SUMS 2&gt;/dev/null <span class=p>|</span> grep -q <span class=s2>&#34;</span><span class=nv>$FILE</span><span class=s2>: OK&#34;</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;LỖI: Checksum không khớp!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;✓ Checksum khớp&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 5. Hoàn tất</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[5/5] Xác thực thành công!&#34;</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;File </span><span class=nv>$FILE</span><span class=s2> đã được xác thực và an toàn để sử dụng.&#34;</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=phần-10-quy-trình-thực-tế><span>PHẦN 10: QUY TRÌNH THỰC TẾ</span>
<a href=#ph%e1%ba%a7n-10-quy-tr%c3%acnh-th%e1%bb%b1c-t%e1%ba%bf class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=101-backup-mã-hóa><span>10.1 Backup mã hóa</span>
<a href=#101-backup-m%c3%a3-h%c3%b3a class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># encrypted_backup.sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>BACKUP_DIR</span><span class=o>=</span><span class=s2>&#34;/data/important&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>DEST</span><span class=o>=</span><span class=s2>&#34;/backup&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>DATE</span><span class=o>=</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span>
</span></span><span class=line><span class=cl><span class=nv>GPG_RECIPIENT</span><span class=o>=</span><span class=s2>&#34;backup@example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo backup mã hóa</span>
</span></span><span class=line><span class=cl>tar czf - <span class=s2>&#34;</span><span class=nv>$BACKUP_DIR</span><span class=s2>&#34;</span> <span class=p>|</span> <span class=se>\
</span></span></span><span class=line><span class=cl><span class=se></span>    gpg -e -r <span class=s2>&#34;</span><span class=nv>$GPG_RECIPIENT</span><span class=s2>&#34;</span> -o <span class=s2>&#34;</span><span class=nv>$DEST</span><span class=s2>/backup_</span><span class=nv>$DATE</span><span class=s2>.tar.gz.gpg&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Tạo checksum</span>
</span></span><span class=line><span class=cl>sha256sum <span class=s2>&#34;</span><span class=nv>$DEST</span><span class=s2>/backup_</span><span class=nv>$DATE</span><span class=s2>.tar.gz.gpg&#34;</span> &gt; <span class=s2>&#34;</span><span class=nv>$DEST</span><span class=s2>/backup_</span><span class=nv>$DATE</span><span class=s2>.sha256&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Xác thực backup (test giải mã)</span>
</span></span><span class=line><span class=cl><span class=k>if</span> gpg -d <span class=s2>&#34;</span><span class=nv>$DEST</span><span class=s2>/backup_</span><span class=nv>$DATE</span><span class=s2>.tar.gz.gpg&#34;</span> 2&gt;/dev/null <span class=p>|</span> tar tzf - &gt;/dev/null 2&gt;<span class=p>&amp;</span>1<span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;✓ Backup </span><span class=nv>$DATE</span><span class=s2> được xác thực&#34;</span>
</span></span><span class=line><span class=cl><span class=k>else</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;✗ LỖI: Backup </span><span class=nv>$DATE</span><span class=s2> không thể giải mã!&#34;</span>
</span></span><span class=line><span class=cl>    <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Giữ lại 7 bản backup gần nhất</span>
</span></span><span class=line><span class=cl>ls -t <span class=s2>&#34;</span><span class=nv>$DEST</span><span class=s2>&#34;</span>/backup_*.tar.gz.gpg <span class=p>|</span> tail -n +8 <span class=p>|</span> xargs rm -f 2&gt;/dev/null</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=102-truyền-file-an-toàn><span>10.2 Truyền file an toàn</span>
<a href=#102-truy%e1%bb%81n-file-an-to%c3%a0n class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># PHƯƠNG PHÁP 1: GPG + SCP</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa</span>
</span></span><span class=line><span class=cl>gpg -c sensitive.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Truyền</span>
</span></span><span class=line><span class=cl>scp sensitive.txt.gpg user@server:/path/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trên server: giải mã</span>
</span></span><span class=line><span class=cl>gpg -d sensitive.txt.gpg &gt; sensitive.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># PHƯƠNG PHÁP 2: age + SSH key</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa với khóa SSH của server</span>
</span></span><span class=line><span class=cl>age -R ~/.ssh/server_ed25519.pub -o sensitive.age sensitive.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Truyền</span>
</span></span><span class=line><span class=cl>scp sensitive.age user@server:/path/
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Trên server: giải mã</span>
</span></span><span class=line><span class=cl>age -d -i ~/.ssh/id_ed25519 -o sensitive.txt sensitive.age
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl><span class=c1># PHƯƠNG PHÁP 3: Streaming qua SSH</span>
</span></span><span class=line><span class=cl><span class=c1># ═══════════════════════════════════════════════════════════</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa và truyền cùng lúc</span>
</span></span><span class=line><span class=cl>gpg -c --passphrase <span class=s2>&#34;mật_khẩu&#34;</span> --batch <span class=p>|</span> ssh user@server <span class=s2>&#34;cat &gt; sensitive.gpg&#34;</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=103-rotate-ssh-keys><span>10.3 Rotate SSH keys</span>
<a href=#103-rotate-ssh-keys class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=c1># rotate_ssh_key.sh</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Script xoay vòng khóa SSH</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nv>OLD_KEY</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$HOME</span><span class=s2>/.ssh/id_ed25519&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>NEW_KEY</span><span class=o>=</span><span class=s2>&#34;</span><span class=nv>$HOME</span><span class=s2>/.ssh/id_ed25519_</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=nv>SERVERS</span><span class=o>=</span><span class=s2>&#34;server1.example.com server2.example.com&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 1. Tạo khóa mới</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[1/4] Đang tạo khóa mới...&#34;</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -f <span class=s2>&#34;</span><span class=nv>$NEW_KEY</span><span class=s2>&#34;</span> -C <span class=s2>&#34;</span><span class=k>$(</span>whoami<span class=k>)</span><span class=s2>@</span><span class=k>$(</span>hostname<span class=k>)</span><span class=s2>-</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 2. Triển khai khóa mới</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[2/4] Đang triển khai khóa mới...&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> server in <span class=nv>$SERVERS</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=nb>echo</span> <span class=s2>&#34;  → </span><span class=nv>$server</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    ssh-copy-id -i <span class=s2>&#34;</span><span class=nv>$NEW_KEY</span><span class=s2>.pub&#34;</span> <span class=s2>&#34;</span><span class=nv>$server</span><span class=s2>&#34;</span> 2&gt;/dev/null
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 3. Kiểm tra kết nối với khóa mới</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[3/4] Đang kiểm tra kết nối...&#34;</span>
</span></span><span class=line><span class=cl><span class=k>for</span> server in <span class=nv>$SERVERS</span><span class=p>;</span> <span class=k>do</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> ssh -i <span class=s2>&#34;</span><span class=nv>$NEW_KEY</span><span class=s2>&#34;</span> -o <span class=nv>BatchMode</span><span class=o>=</span>yes <span class=s2>&#34;</span><span class=nv>$server</span><span class=s2>&#34;</span> <span class=nb>exit</span> 2&gt;/dev/null<span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;  ✓ </span><span class=nv>$server</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span>
</span></span><span class=line><span class=cl>        <span class=nb>echo</span> <span class=s2>&#34;  ✗ </span><span class=nv>$server</span><span class=s2> - LỖI!&#34;</span>
</span></span><span class=line><span class=cl>        <span class=nb>exit</span> <span class=m>1</span>
</span></span><span class=line><span class=cl>    <span class=k>fi</span>
</span></span><span class=line><span class=cl><span class=k>done</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># 4. Backup khóa cũ và thay thế</span>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;[4/4] Đang hoàn tất...&#34;</span>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=o>[</span> -f <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>&#34;</span> <span class=o>]</span><span class=p>;</span> <span class=k>then</span>
</span></span><span class=line><span class=cl>    mv <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>.bak.</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>    mv <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>.pub&#34;</span> <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>.pub.bak.</span><span class=k>$(</span>date +%Y%m%d<span class=k>)</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl><span class=k>fi</span>
</span></span><span class=line><span class=cl>mv <span class=s2>&#34;</span><span class=nv>$NEW_KEY</span><span class=s2>&#34;</span> <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>&#34;</span>
</span></span><span class=line><span class=cl>mv <span class=s2>&#34;</span><span class=nv>$NEW_KEY</span><span class=s2>.pub&#34;</span> <span class=s2>&#34;</span><span class=nv>$OLD_KEY</span><span class=s2>.pub&#34;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nb>echo</span> <span class=s2>&#34;Hoàn tất! Khóa cũ được backup, khóa mới đã active.&#34;</span></span></span></code></pre></td></tr></table></div></div><hr><h2 class=heading-element id=tóm-tắt-nhanh><span>TÓM TẮT NHANH</span>
<a href=#t%c3%b3m-t%e1%ba%aft-nhanh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h2><h3 class=heading-element id=lệnh-hash><span>Lệnh Hash</span>
<a href=#l%e1%bb%87nh-hash class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># MD5 (KHÔNG AN TOÀN cho bảo mật)</span>
</span></span><span class=line><span class=cl>md5sum file.txt
</span></span><span class=line><span class=cl>md5sum -c checksums.md5
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-256 (KHUYẾN NGHỊ)</span>
</span></span><span class=line><span class=cl>sha256sum file.txt
</span></span><span class=line><span class=cl>sha256sum -c SHA256SUMS
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># SHA-512</span>
</span></span><span class=line><span class=cl>sha512sum file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># BLAKE2</span>
</span></span><span class=line><span class=cl>b2sum file.txt</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=lệnh-gpg><span>Lệnh GPG</span>
<a href=#l%e1%bb%87nh-gpg class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Quản lý khóa</span>
</span></span><span class=line><span class=cl>gpg --generate-key              <span class=c1># Tạo khóa</span>
</span></span><span class=line><span class=cl>gpg -k                          <span class=c1># Liệt kê khóa công khai</span>
</span></span><span class=line><span class=cl>gpg -K                          <span class=c1># Liệt kê khóa riêng tư</span>
</span></span><span class=line><span class=cl>gpg --export -a KEY &gt; key.asc   <span class=c1># Xuất khóa công khai</span>
</span></span><span class=line><span class=cl>gpg --import key.asc            <span class=c1># Nhập khóa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa / Giải mã</span>
</span></span><span class=line><span class=cl>gpg -e -r recipient file.txt    <span class=c1># Mã hóa bất đối xứng</span>
</span></span><span class=line><span class=cl>gpg -c file.txt                 <span class=c1># Mã hóa đối xứng (mật khẩu)</span>
</span></span><span class=line><span class=cl>gpg -d file.gpg                 <span class=c1># Giải mã</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Ký / Xác thực</span>
</span></span><span class=line><span class=cl>gpg -b file.txt                 <span class=c1># Ký (detached)</span>
</span></span><span class=line><span class=cl>gpg --verify file.sig file.txt  <span class=c1># Xác thực</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=lệnh-ssh><span>Lệnh SSH</span>
<a href=#l%e1%bb%87nh-ssh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Tạo khóa</span>
</span></span><span class=line><span class=cl>ssh-keygen -t ed25519 -C <span class=s2>&#34;email&#34;</span>
</span></span><span class=line><span class=cl>ssh-keygen -t rsa -b <span class=m>4096</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Quản lý</span>
</span></span><span class=line><span class=cl>ssh-keygen -p -f key            <span class=c1># Đổi mật khẩu</span>
</span></span><span class=line><span class=cl>ssh-keygen -l -f key            <span class=c1># Xem fingerprint</span>
</span></span><span class=line><span class=cl>ssh-keygen -R hostname          <span class=c1># Xóa khỏi known_hosts</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Agent</span>
</span></span><span class=line><span class=cl><span class=nb>eval</span> <span class=k>$(</span>ssh-agent<span class=k>)</span>
</span></span><span class=line><span class=cl>ssh-add key
</span></span><span class=line><span class=cl>ssh-add -l                      <span class=c1># Liệt kê</span>
</span></span><span class=line><span class=cl>ssh-add -D                      <span class=c1># Xóa tất cả</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Triển khai</span>
</span></span><span class=line><span class=cl>ssh-copy-id user@server</span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=lệnh-openssl><span>Lệnh OpenSSL</span>
<a href=#l%e1%bb%87nh-openssl class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=c1># Hash</span>
</span></span><span class=line><span class=cl>openssl dgst -sha256 file.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Mã hóa đối xứng</span>
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -salt -pbkdf2 -in plain.txt -out encrypted.bin
</span></span><span class=line><span class=cl>openssl enc -aes-256-cbc -d -pbkdf2 -in encrypted.bin -out plain.txt
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Khóa</span>
</span></span><span class=line><span class=cl>openssl genrsa -out key.pem <span class=m>4096</span>
</span></span><span class=line><span class=cl>openssl genpkey -algorithm ED25519 -out key.pem
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Chứng chỉ</span>
</span></span><span class=line><span class=cl>openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days <span class=m>365</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Kiểm tra TLS</span>
</span></span><span class=line><span class=cl>openssl s_client -connect example.com:443 -servername example.com
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Số ngẫu nhiên</span>
</span></span><span class=line><span class=cl>openssl rand -hex <span class=m>32</span></span></span></code></pre></td></tr></table></div></div><h3 class=heading-element id=hướng-dẫn-chọn-nhanh><span>Hướng dẫn chọn nhanh</span>
<a href=#h%c6%b0%e1%bb%9bng-d%e1%ba%abn-ch%e1%bb%8dn-nhanh class=heading-mark><svg class="octicon octicon-link" viewBox="0 0 16 16" width="16" height="16" aria-hidden="true"><path d="m7.775 3.275 1.25-1.25a3.5 3.5.0 114.95 4.95l-2.5 2.5a3.5 3.5.0 01-4.95.0.751.751.0 01.018-1.042.751.751.0 011.042-.018 1.998 1.998.0 002.83.0l2.5-2.5a2.002 2.002.0 00-2.83-2.83l-1.25 1.25a.751.751.0 01-1.042-.018.751.751.0 01-.018-1.042zm-4.69 9.64a1.998 1.998.0 002.83.0l1.25-1.25a.751.751.0 011.042.018.751.751.0 01.018 1.042l-1.25 1.25a3.5 3.5.0 11-4.95-4.95l2.5-2.5a3.5 3.5.0 014.95.0.751.751.0 01-.018 1.042.751.751.0 01-1.042.018 1.998 1.998.0 00-2.83.0l-2.5 2.5a1.998 1.998.0 000 2.83z"/></svg></a></h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-gdscript3 data-lang=gdscript3><span class=line><span class=cl><span class=err>┌─────────────────────────────────────────────────────────────┐</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Mục</span> <span class=err>đí</span><span class=n>ch</span>                    <span class=err>│</span> <span class=n>Công</span> <span class=n>cụ</span> <span class=o>/</span> <span class=n>Thuật</span> <span class=n>toán</span>          <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>├─────────────────────────────┼───────────────────────────────┤</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Kiểm</span> <span class=n>tra</span> <span class=n>toàn</span> <span class=n>vẹn</span> <span class=n>file</span>      <span class=err>│</span> <span class=n>sha256sum</span><span class=p>,</span> <span class=n>b2sum</span>              <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Mã</span> <span class=n>hóa</span> <span class=n>file</span> <span class=err>đơ</span><span class=n>n</span> <span class=n>giản</span>        <span class=err>│</span> <span class=n>age</span><span class=p>,</span> <span class=n>gpg</span> <span class=o>-</span><span class=n>c</span>                   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Mã</span> <span class=n>hóa</span> <span class=n>email</span><span class=o>/</span><span class=n>cho</span> <span class=n>người</span> <span class=n>khác</span> <span class=err>│</span> <span class=n>gpg</span> <span class=o>-</span><span class=n>e</span> <span class=o>-</span><span class=n>r</span> <span class=n>recipient</span>           <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Mã</span> <span class=n>hóa</span> <span class=err>ổ</span> <span class=err>đĩ</span><span class=n>a</span>                <span class=err>│</span> <span class=n>LUKS</span> <span class=p>(</span><span class=n>cryptsetup</span><span class=p>)</span>             <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Mã</span> <span class=n>hóa</span> <span class=n>thư</span> <span class=n>mục</span>              <span class=err>│</span> <span class=n>fscrypt</span>                       <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>SSH</span> <span class=n>key</span> <span class=n>mới</span>                 <span class=err>│</span> <span class=n>ssh</span><span class=o>-</span><span class=n>keygen</span> <span class=o>-</span><span class=n>t</span> <span class=n>ed25519</span>         <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Quản</span> <span class=n>lý</span> <span class=n>mật</span> <span class=n>khẩu</span>            <span class=err>│</span> <span class=k>pass</span><span class=p>,</span> <span class=n>secret</span><span class=o>-</span><span class=k>tool</span>             <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Xóa</span> <span class=n>file</span> <span class=n>an</span> <span class=n>toàn</span>            <span class=err>│</span> <span class=n>Mã</span> <span class=n>hóa</span> <span class=n>từ</span> <span class=err>đầ</span><span class=n>u</span> <span class=o>+</span> <span class=n>xóa</span> <span class=n>khóa</span>      <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>│</span> <span class=n>Xác</span> <span class=n>thực</span> <span class=n>download</span>           <span class=err>│</span> <span class=n>gpg</span> <span class=o>--</span><span class=n>verify</span> <span class=o>+</span> <span class=n>sha256sum</span> <span class=o>-</span><span class=n>c</span>   <span class=err>│</span>
</span></span><span class=line><span class=cl><span class=err>└─────────────────────────────┴───────────────────────────────┘</span></span></span></code></pre></td></tr></table></div></div></div><hr class=awesome-hr><h2 id=see-also>Nội dung liên quan</h2><ul><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ title="Linux Package Management - Hướng Dẫn Chuyên Sâu">Linux Package Management - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu">Linux User & Group Management - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/storage/ title="Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu">Disk, Storage & Filesystem - Hướng Dẫn Chuyên Sâu</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/regex-awk-sed/ title="Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer">Awk, Sed & Regex - Hướng Dẫn Chuyên Sâu Cho System Engineer</a></li><li><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/process-service-log/ title="Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu">Process Management, Systemd & Logging - Hướng Dẫn Chuyên Sâu</a></li></ul><div class=collection-card><div class="collection-title text-secondary">Trong <a href=/collections/linux-cli/><i class="fa-solid fa-layer-group fa-fw" aria-hidden=true></i> <span>Bộ sưu tập・Linux Cli</span></span></a> 10</div><div class=collection-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/user-group/ class=collection-nav-item rel=prev title="Linux User & Group Management - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i><span>Linux User & Group Management - Hướng Dẫn Chuyên Sâu</span>
</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ class=collection-nav-item rel=next title="Linux Package Management - Hướng Dẫn Chuyên Sâu"><span>Linux Package Management - Hướng Dẫn Chuyên Sâu</span><i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="Cập nhật ngày 2025-12-11 16:05:24">Cập nhật ngày 2025-12-11&nbsp;</span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc-sa/4.0/ target=_blank>CC BY-NC-SA 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md></div><div class=post-info-share><span><a href=javascript:void(0); title="Chia sẻ trên X" data-sharer=twitter data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ data-title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu" data-hashtags="ai generated post"><i class="fa-brands fa-x-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên Facebook" data-sharer=facebook data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ data-hashtag="ai generated post"><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="Chia sẻ trên 微博" data-sharer=weibo data-url=https://vanvuvuong.github.io/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/ data-title="Linux Cryptography & Security Tools - Hướng Dẫn Chuyên Sâu"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/ai-generated-post/ class=post-tag title="Nhãn - Ai Generated Post">Ai Generated Post</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>Quay lại</a></span>&nbsp;|&nbsp;<span><a href=/>Trang chủ</a></span></section></div><div class=post-nav><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/package-manager/ class=post-nav-item rel=prev title="Linux Package Management - Hướng Dẫn Chuyên Sâu"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Linux Package Management - Hướng Dẫn Chuyên Sâu</a><a href=/bai-viet/khoa-hoc-may-tinh/linux-cli/selinux/ class=post-nav-item rel=next title="Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc">Selinux & Apparmor - Kiểm Soát Truy Cập Bắt Buộc<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div></article><aside class=toc id=toc-auto aria-label="Nội dung"><h2 class=toc-title>Nội dung&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><dialog id=toc-dialog aria-labelledby=toc-dialog-title role=dialog><div class=toc><h2 class=toc-title>Nội dung</h2><div class=toc-content id=toc-content-drawer><nav><ul><li><ul><li><a href=#phần-1-nền-tảng-mật-mã-học>PHẦN 1: NỀN TẢNG MẬT MÃ HỌC</a><ul><li><a href=#11-hàm-băm-hash-functions>1.1 Hàm băm (Hash Functions)</a></li><li><a href=#12-so-sánh-thuật-toán-băm>1.2 So sánh thuật toán băm</a></li><li><a href=#13-mã-hóa-đối-xứng-vs-bất-đối-xứng>1.3 Mã hóa đối xứng vs Bất đối xứng</a></li><li><a href=#14-chữ-ký-số-digital-signatures>1.4 Chữ ký số (Digital Signatures)</a></li><li><a href=#15-độ-mạnh-khóa-tương-đương>1.5 Độ mạnh khóa tương đương</a></li></ul></li><li><a href=#phần-2-checksum--hashing>PHẦN 2: CHECKSUM & HASHING</a><ul><li><a href=#21-cksum---crc-checksum>2.1 cksum - CRC Checksum</a></li><li><a href=#22-md5sum---md5-hash-lỗi-thời>2.2 md5sum - MD5 Hash (Lỗi thời)</a></li><li><a href=#23-sha-family---sha1sum-đến-sha512sum>2.3 SHA Family - sha1sum đến sha512sum</a></li><li><a href=#24-b2sum---blake2-hash>2.4 b2sum - BLAKE2 Hash</a></li><li><a href=#25-quy-trình-thực-tế-với-hash>2.5 Quy trình thực tế với Hash</a></li></ul></li><li><a href=#phần-3-gpg---gnu-privacy-guard>PHẦN 3: GPG - GNU PRIVACY GUARD</a><ul><li><a href=#31-kiến-trúc-gpg>3.1 Kiến trúc GPG</a></li><li><a href=#32-tạo-và-quản-lý-khóa>3.2 Tạo và quản lý khóa</a></li><li><a href=#33-mã-hóa-và-giải-mã>3.3 Mã hóa và Giải mã</a></li><li><a href=#34-ký-và-xác-thực>3.4 Ký và Xác thực</a></li><li><a href=#35-tin-cậy-và-keyserver>3.5 Tin cậy và Keyserver</a></li><li><a href=#36-cấu-hình-gpg>3.6 Cấu hình GPG</a></li></ul></li><li><a href=#phần-4-ssh-key-management>PHẦN 4: SSH KEY MANAGEMENT</a><ul><li><a href=#41-so-sánh-loại-khóa-ssh>4.1 So sánh loại khóa SSH</a></li><li><a href=#42-ssh-keygen---tạo-và-quản-lý-khóa>4.2 ssh-keygen - Tạo và quản lý khóa</a></li><li><a href=#43-ssh-agent>4.3 SSH Agent</a></li><li><a href=#44-triển-khai-khóa-ssh>4.4 Triển khai khóa SSH</a></li><li><a href=#45-ssh-certificates-nâng-cao>4.5 SSH Certificates (Nâng cao)</a></li></ul></li><li><a href=#phần-5-openssl>PHẦN 5: OPENSSL</a><ul><li><a href=#51-hash-và-hmac>5.1 Hash và HMAC</a></li><li><a href=#52-mã-hóa-đối-xứng>5.2 Mã hóa đối xứng</a></li><li><a href=#53-khóa-rsa-và-ec>5.3 Khóa RSA và EC</a></li><li><a href=#54-chứng-chỉ-x509>5.4 Chứng chỉ X.509</a></li><li><a href=#55-kiểm-tra-tlsssl>5.5 Kiểm tra TLS/SSL</a></li><li><a href=#56-tạo-số-ngẫu-nhiên>5.6 Tạo số ngẫu nhiên</a></li></ul></li><li><a href=#phần-6-mã-hóa-file>PHẦN 6: MÃ HÓA FILE</a><ul><li><a href=#61-age---công-cụ-mã-hóa-hiện-đại>6.1 age - Công cụ mã hóa hiện đại</a></li><li><a href=#62-luks---mã-hóa-ổ-đĩa>6.2 LUKS - Mã hóa ổ đĩa</a></li><li><a href=#63-fscrypt---mã-hóa-thư-mục>6.3 fscrypt - Mã hóa thư mục</a></li></ul></li><li><a href=#phần-7-quản-lý-mật-khẩu>PHẦN 7: QUẢN LÝ MẬT KHẨU</a><ul><li><a href=#71-pass---unix-password-manager>7.1 pass - Unix Password Manager</a></li><li><a href=#72-secret-tool---gnome-keyring-cli>7.2 secret-tool - GNOME Keyring CLI</a></li><li><a href=#73-tạo-mật-khẩu-mạnh>7.3 Tạo mật khẩu mạnh</a></li></ul></li><li><a href=#phần-8-xóa-file-an-toàn>PHẦN 8: XÓA FILE AN TOÀN</a><ul><li><a href=#81-shred---ghi-đè-file>8.1 shred - Ghi đè file</a></li><li><a href=#82-secure-delete>8.2 secure-delete</a></li><li><a href=#83-file-tạm-an-toàn>8.3 File tạm an toàn</a></li><li><a href=#84-thuộc-tính-file>8.4 Thuộc tính file</a></li></ul></li><li><a href=#phần-9-bảo-mật-mạng>PHẦN 9: BẢO MẬT MẠNG</a><ul><li><a href=#91-kiểm-tra-ssltls>9.1 Kiểm tra SSL/TLS</a></li><li><a href=#92-ssh-hardening>9.2 SSH Hardening</a></li><li><a href=#93-xác-thực-gpg-cho-download>9.3 Xác thực GPG cho download</a></li></ul></li><li><a href=#phần-10-quy-trình-thực-tế>PHẦN 10: QUY TRÌNH THỰC TẾ</a><ul><li><a href=#101-backup-mã-hóa>10.1 Backup mã hóa</a></li><li><a href=#102-truyền-file-an-toàn>10.2 Truyền file an toàn</a></li><li><a href=#103-rotate-ssh-keys>10.3 Rotate SSH keys</a></li></ul></li><li><a href=#tóm-tắt-nhanh>TÓM TẮT NHANH</a><ul><li><a href=#lệnh-hash>Lệnh Hash</a></li><li><a href=#lệnh-gpg>Lệnh GPG</a></li><li><a href=#lệnh-ssh>Lệnh SSH</a></li><li><a href=#lệnh-openssl>Lệnh OpenSSL</a></li><li><a href=#hướng-dẫn-chọn-nhanh>Hướng dẫn chọn nhanh</a></li></ul></li></ul></li></ul></nav></div></div></dialog></main><footer class=footer><div class=footer-container><div class="footer-line powered">Cung cấp bởi <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.152.0"><img class=hugo-icon src=/images/hugo.min.svg alt="Hugo logo"> Hugo</a> | Chủ đề - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.4.0-alpha.2"><img class=fixit-icon src=/images/fixit.min.svg alt="FixIt logo"> FixIt</a></div><div class="footer-line copyright" itemscope itemtype=http://schema.org/CreativeWork><i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2025</span></div></div></footer></div><div class=widgets><div class=fixed-buttons><div class="fixed-button back-to-top animate__faster" role=button aria-label="Lên trên"><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><svg viewBox="0 0 100 100"><circle class="bg" cx="50" cy="50" r="50"/><circle class="progress" cx="50" cy="50" r="50"/></svg></div><div id=toc-drawer-button class="fixed-button toc-drawer-button" role=button aria-label="Nội dung"><i class="fa-solid fa-bars fa-fw" aria-hidden=true></i></div></div><div id=mask></div><div class=reading-progress-bar style=left:0;top:0;--bg-progress:#000;--bg-progress-dark:#fff></div><noscript><div class=noscript-warning>Trang web này hoạt động tốt nhất khi JavaScript được kích hoạt.</div></noscript></div><link rel=stylesheet href=/lib/cookieconsent/cookieconsent.min.css><link rel=stylesheet href=/lib/pace/themes/blue/pace-theme-minimal.css><script src=/lib/autocomplete/autocomplete.min.js defer></script><script src=/lib/fuse/fuse.min.js defer></script><script src=/lib/instant-page/instantpage.min.js async defer type=module></script><script src=/lib/sharer/sharer.min.js async defer></script><script src=/lib/cookieconsent/cookieconsent.min.js defer></script><script src=/lib/pace/pace.min.js async defer></script><script src=/bai-viet/khoa-hoc-may-tinh/linux-cli/encryption-and-security/config/page.js defer></script><script src=/js/theme.min.js defer></script></body></html>